<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (21) -->
<title>Source code</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="source: package: org.biojava.nbio.core.search.io.blast, class: BlastXMLParser">
<meta name="generator" content="javadoc/SourceToHTMLConverter">
<link rel="stylesheet" type="text/css" href="../../../../../../../../stylesheet.css" title="Style">
</head>
<body class="source-page">
<main role="main">
<div class="source-container">
<pre><span class="source-line-no">001</span><span id="line-1">/*</span>
<span class="source-line-no">002</span><span id="line-2"> *                    BioJava development code</span>
<span class="source-line-no">003</span><span id="line-3"> *</span>
<span class="source-line-no">004</span><span id="line-4"> * This code may be freely distributed and modified under the</span>
<span class="source-line-no">005</span><span id="line-5"> * terms of the GNU Lesser General Public Licence.  This should</span>
<span class="source-line-no">006</span><span id="line-6"> * be distributed with the code.  If you do not have a copy,</span>
<span class="source-line-no">007</span><span id="line-7"> * see:</span>
<span class="source-line-no">008</span><span id="line-8"> *</span>
<span class="source-line-no">009</span><span id="line-9"> *      http://www.gnu.org/copyleft/lesser.html</span>
<span class="source-line-no">010</span><span id="line-10"> *</span>
<span class="source-line-no">011</span><span id="line-11"> * Copyright for this code is held jointly by the individual</span>
<span class="source-line-no">012</span><span id="line-12"> * authors.  These should be listed in @author doc comments.</span>
<span class="source-line-no">013</span><span id="line-13"> *</span>
<span class="source-line-no">014</span><span id="line-14"> * For more information on the BioJava project and its aims,</span>
<span class="source-line-no">015</span><span id="line-15"> * or to join the biojava-l mailing list, visit the home page</span>
<span class="source-line-no">016</span><span id="line-16"> * at:</span>
<span class="source-line-no">017</span><span id="line-17"> *</span>
<span class="source-line-no">018</span><span id="line-18"> *      http://www.biojava.org/</span>
<span class="source-line-no">019</span><span id="line-19"> *</span>
<span class="source-line-no">020</span><span id="line-20"> */</span>
<span class="source-line-no">021</span><span id="line-21">package org.biojava.nbio.core.search.io.blast;</span>
<span class="source-line-no">022</span><span id="line-22"></span>
<span class="source-line-no">023</span><span id="line-23"></span>
<span class="source-line-no">024</span><span id="line-24">import org.biojava.nbio.core.search.io.Hit;</span>
<span class="source-line-no">025</span><span id="line-25">import org.biojava.nbio.core.search.io.Hsp;</span>
<span class="source-line-no">026</span><span id="line-26">import org.biojava.nbio.core.search.io.Result;</span>
<span class="source-line-no">027</span><span id="line-27">import org.biojava.nbio.core.search.io.ResultFactory;</span>
<span class="source-line-no">028</span><span id="line-28">import java.io.File;</span>
<span class="source-line-no">029</span><span id="line-29">import java.io.IOException;</span>
<span class="source-line-no">030</span><span id="line-30">import java.text.ParseException;</span>
<span class="source-line-no">031</span><span id="line-31">import java.util.ArrayList;</span>
<span class="source-line-no">032</span><span id="line-32">import java.util.HashMap;</span>
<span class="source-line-no">033</span><span id="line-33">import java.util.List;</span>
<span class="source-line-no">034</span><span id="line-34">import java.util.Map;</span>
<span class="source-line-no">035</span><span id="line-35">import javax.xml.parsers.ParserConfigurationException;</span>
<span class="source-line-no">036</span><span id="line-36">import javax.xml.xpath.XPathException;</span>
<span class="source-line-no">037</span><span id="line-37">import org.biojava.nbio.core.sequence.template.Sequence;</span>
<span class="source-line-no">038</span><span id="line-38">import org.biojava.nbio.core.util.XMLHelper;</span>
<span class="source-line-no">039</span><span id="line-39">import org.slf4j.LoggerFactory;</span>
<span class="source-line-no">040</span><span id="line-40">import org.w3c.dom.Document;</span>
<span class="source-line-no">041</span><span id="line-41">import org.w3c.dom.Element;</span>
<span class="source-line-no">042</span><span id="line-42">import org.xml.sax.SAXException;</span>
<span class="source-line-no">043</span><span id="line-43"></span>
<span class="source-line-no">044</span><span id="line-44">/**</span>
<span class="source-line-no">045</span><span id="line-45"> * Re-designed by Paolo Pavan on the footprint of:</span>
<span class="source-line-no">046</span><span id="line-46"> * org.biojava.nbio.genome.query.BlastXMLQuery by Scooter Willis </span>
<span class="source-line-no">047</span><span id="line-47"> *</span>
<span class="source-line-no">048</span><span id="line-48"> * You may want to find my contacts on Github and LinkedIn for code info</span>
<span class="source-line-no">049</span><span id="line-49"> * or discuss major changes.</span>
<span class="source-line-no">050</span><span id="line-50"> * https://github.com/paolopavan</span>
<span class="source-line-no">051</span><span id="line-51"> *</span>
<span class="source-line-no">052</span><span id="line-52"> *</span>
<span class="source-line-no">053</span><span id="line-53"> * @author Paolo Pavan</span>
<span class="source-line-no">054</span><span id="line-54"> */</span>
<span class="source-line-no">055</span><span id="line-55">public class BlastXMLParser implements ResultFactory {</span>
<span class="source-line-no">056</span><span id="line-56">        private static final org.slf4j.Logger logger = LoggerFactory.getLogger(Hsp.class);</span>
<span class="source-line-no">057</span><span id="line-57">        Document blastDoc = null;</span>
<span class="source-line-no">058</span><span id="line-58">        private File targetFile;</span>
<span class="source-line-no">059</span><span id="line-59">        private List&lt;Sequence&gt; queryReferences, databaseReferences;</span>
<span class="source-line-no">060</span><span id="line-60">        private Map&lt;String,Sequence&gt; queryReferencesMap, databaseReferencesMap;</span>
<span class="source-line-no">061</span><span id="line-61"></span>
<span class="source-line-no">062</span><span id="line-62">        public BlastXMLParser() {</span>
<span class="source-line-no">063</span><span id="line-63"></span>
<span class="source-line-no">064</span><span id="line-64">        }</span>
<span class="source-line-no">065</span><span id="line-65">        @Override</span>
<span class="source-line-no">066</span><span id="line-66">        public void setFile(File f){</span>
<span class="source-line-no">067</span><span id="line-67">                targetFile = f;</span>
<span class="source-line-no">068</span><span id="line-68">        }</span>
<span class="source-line-no">069</span><span id="line-69"></span>
<span class="source-line-no">070</span><span id="line-70">        private void readFile(String blastFile) throws IOException, ParseException{</span>
<span class="source-line-no">071</span><span id="line-71">                logger.info("Start reading " + blastFile);</span>
<span class="source-line-no">072</span><span id="line-72">                try {</span>
<span class="source-line-no">073</span><span id="line-73">                        blastDoc = XMLHelper.loadXML(blastFile);</span>
<span class="source-line-no">074</span><span id="line-74">                } catch (SAXException ex) {</span>
<span class="source-line-no">075</span><span id="line-75">                        logger.error("A parsing error has occurred while reading XML blast file");</span>
<span class="source-line-no">076</span><span id="line-76">                        throw new ParseException(ex.getMessage(),0);</span>
<span class="source-line-no">077</span><span id="line-77">                } catch (ParserConfigurationException ex) {</span>
<span class="source-line-no">078</span><span id="line-78">                        logger.error("Internal XML parser non properly configured");</span>
<span class="source-line-no">079</span><span id="line-79">                        throw new ParseException(ex.getMessage(),0);</span>
<span class="source-line-no">080</span><span id="line-80">                }</span>
<span class="source-line-no">081</span><span id="line-81">                logger.info("Read finished");</span>
<span class="source-line-no">082</span><span id="line-82">        }</span>
<span class="source-line-no">083</span><span id="line-83"></span>
<span class="source-line-no">084</span><span id="line-84">        @Override</span>
<span class="source-line-no">085</span><span id="line-85">        public List&lt;Result&gt; createObjects(double maxEScore) throws IOException, ParseException {</span>
<span class="source-line-no">086</span><span id="line-86">                if (targetFile == null) throw new IllegalStateException("File to be parsed not specified.");</span>
<span class="source-line-no">087</span><span id="line-87"></span>
<span class="source-line-no">088</span><span id="line-88">                // getAbsolutePath throws SecurityException</span>
<span class="source-line-no">089</span><span id="line-89">                readFile(targetFile.getAbsolutePath());</span>
<span class="source-line-no">090</span><span id="line-90">                // create mappings between sequences and blast id</span>
<span class="source-line-no">091</span><span id="line-91">                mapIds();</span>
<span class="source-line-no">092</span><span id="line-92"></span>
<span class="source-line-no">093</span><span id="line-93">                List&lt;Result&gt; resultsCollection;</span>
<span class="source-line-no">094</span><span id="line-94">                List&lt;Hit&gt; hitsCollection;</span>
<span class="source-line-no">095</span><span id="line-95">                List&lt;Hsp&gt; hspsCollection;</span>
<span class="source-line-no">096</span><span id="line-96"></span>
<span class="source-line-no">097</span><span id="line-97">                try {</span>
<span class="source-line-no">098</span><span id="line-98">                        // select top level elements</span>
<span class="source-line-no">099</span><span id="line-99">                        String program = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),"BlastOutput_program").getTextContent();</span>
<span class="source-line-no">100</span><span id="line-100">                        String version = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),"BlastOutput_version").getTextContent();</span>
<span class="source-line-no">101</span><span id="line-101">                        String reference = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),"BlastOutput_reference").getTextContent();</span>
<span class="source-line-no">102</span><span id="line-102">                        String dbFile = XMLHelper.selectSingleElement(blastDoc.getDocumentElement(),"BlastOutput_db").getTextContent();</span>
<span class="source-line-no">103</span><span id="line-103"></span>
<span class="source-line-no">104</span><span id="line-104">                        logger.info("Query for hits in "+ targetFile);</span>
<span class="source-line-no">105</span><span id="line-105">                        List&lt;Element&gt; IterationsList = XMLHelper.selectElements(blastDoc.getDocumentElement(), "BlastOutput_iterations/Iteration[Iteration_hits]");</span>
<span class="source-line-no">106</span><span id="line-106">                        logger.info(IterationsList.size() + " results");</span>
<span class="source-line-no">107</span><span id="line-107"></span>
<span class="source-line-no">108</span><span id="line-108">                        resultsCollection = new ArrayList&lt;&gt;();</span>
<span class="source-line-no">109</span><span id="line-109">                        for (Element element : IterationsList) {</span>
<span class="source-line-no">110</span><span id="line-110">                                BlastResultBuilder resultBuilder = new BlastResultBuilder();</span>
<span class="source-line-no">111</span><span id="line-111">                                // will add BlastOutput* key sections in the result object</span>
<span class="source-line-no">112</span><span id="line-112">                                resultBuilder</span>
<span class="source-line-no">113</span><span id="line-113">                                        .setProgram(program)</span>
<span class="source-line-no">114</span><span id="line-114">                                        .setVersion(version)</span>
<span class="source-line-no">115</span><span id="line-115">                                        .setReference(reference)</span>
<span class="source-line-no">116</span><span id="line-116">                                        .setDbFile(dbFile);</span>
<span class="source-line-no">117</span><span id="line-117"></span>
<span class="source-line-no">118</span><span id="line-118">                                // Iteration* section keys:</span>
<span class="source-line-no">119</span><span id="line-119">                                resultBuilder</span>
<span class="source-line-no">120</span><span id="line-120">                                        .setIterationNumber(Integer.valueOf(XMLHelper.selectSingleElement(element,"Iteration_iter-num").getTextContent()))</span>
<span class="source-line-no">121</span><span id="line-121">                                        .setQueryID(XMLHelper.selectSingleElement(element,"Iteration_query-ID").getTextContent())</span>
<span class="source-line-no">122</span><span id="line-122">                                        .setQueryDef(XMLHelper.selectSingleElement(element, "Iteration_query-def").getTextContent())</span>
<span class="source-line-no">123</span><span id="line-123">                                        .setQueryLength(Integer.valueOf(XMLHelper.selectSingleElement(element,"Iteration_query-len").getTextContent()));</span>
<span class="source-line-no">124</span><span id="line-124"></span>
<span class="source-line-no">125</span><span id="line-125">                                if (queryReferences != null) resultBuilder.setQuerySequence(queryReferencesMap.get(</span>
<span class="source-line-no">126</span><span id="line-126">                                                XMLHelper.selectSingleElement(element,"Iteration_query-ID").getTextContent()</span>
<span class="source-line-no">127</span><span id="line-127">                                ));</span>
<span class="source-line-no">128</span><span id="line-128"></span>
<span class="source-line-no">129</span><span id="line-129"></span>
<span class="source-line-no">130</span><span id="line-130"></span>
<span class="source-line-no">131</span><span id="line-131">                                Element iterationHitsElement = XMLHelper.selectSingleElement(element, "Iteration_hits");</span>
<span class="source-line-no">132</span><span id="line-132">                                List&lt;Element&gt; hitList = XMLHelper.selectElements(iterationHitsElement, "Hit");</span>
<span class="source-line-no">133</span><span id="line-133"></span>
<span class="source-line-no">134</span><span id="line-134">                                hitsCollection = new ArrayList&lt;&gt;();</span>
<span class="source-line-no">135</span><span id="line-135">                                for (Element hitElement : hitList) {</span>
<span class="source-line-no">136</span><span id="line-136">                                        BlastHitBuilder blastHitBuilder = new BlastHitBuilder();</span>
<span class="source-line-no">137</span><span id="line-137">                                        blastHitBuilder</span>
<span class="source-line-no">138</span><span id="line-138">                                                .setHitNum(Integer.valueOf(XMLHelper.selectSingleElement(hitElement, "Hit_num").getTextContent()))</span>
<span class="source-line-no">139</span><span id="line-139">                                                .setHitId(XMLHelper.selectSingleElement(hitElement, "Hit_id").getTextContent())</span>
<span class="source-line-no">140</span><span id="line-140">                                                .setHitDef(XMLHelper.selectSingleElement(hitElement, "Hit_def").getTextContent())</span>
<span class="source-line-no">141</span><span id="line-141">                                                .setHitAccession(XMLHelper.selectSingleElement(hitElement, "Hit_accession").getTextContent())</span>
<span class="source-line-no">142</span><span id="line-142">                                                .setHitLen(Integer.valueOf(XMLHelper.selectSingleElement(hitElement, "Hit_len").getTextContent()));</span>
<span class="source-line-no">143</span><span id="line-143"></span>
<span class="source-line-no">144</span><span id="line-144">                                        if (databaseReferences != null) blastHitBuilder.setHitSequence(databaseReferencesMap.get(</span>
<span class="source-line-no">145</span><span id="line-145">                                                XMLHelper.selectSingleElement(hitElement, "Hit_id").getTextContent()</span>
<span class="source-line-no">146</span><span id="line-146">                                        ));</span>
<span class="source-line-no">147</span><span id="line-147"></span>
<span class="source-line-no">148</span><span id="line-148">                                        Element hithspsElement = XMLHelper.selectSingleElement(hitElement, "Hit_hsps");</span>
<span class="source-line-no">149</span><span id="line-149">                                        List&lt;Element&gt; hspList = XMLHelper.selectElements(hithspsElement, "Hsp");</span>
<span class="source-line-no">150</span><span id="line-150"></span>
<span class="source-line-no">151</span><span id="line-151">                                        hspsCollection = new ArrayList&lt;&gt;();</span>
<span class="source-line-no">152</span><span id="line-152">                                        for (Element hspElement : hspList) {</span>
<span class="source-line-no">153</span><span id="line-153">                                                Double evalue = Double.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_evalue").getTextContent());</span>
<span class="source-line-no">154</span><span id="line-154"></span>
<span class="source-line-no">155</span><span id="line-155">                                                // add the new hsp only if it pass the specified threshold. It can save lot of memory and some parsing time</span>
<span class="source-line-no">156</span><span id="line-156">                                                if (evalue &lt;= maxEScore) {</span>
<span class="source-line-no">157</span><span id="line-157">                                                        BlastHspBuilder blastHspBuilder = new BlastHspBuilder();</span>
<span class="source-line-no">158</span><span id="line-158">                                                        blastHspBuilder</span>
<span class="source-line-no">159</span><span id="line-159">                                                                .setHspNum(Integer.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_num").getTextContent()))</span>
<span class="source-line-no">160</span><span id="line-160">                                                                .setHspBitScore(Double.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_bit-score").getTextContent()))</span>
<span class="source-line-no">161</span><span id="line-161">                                                                .setHspScore(Integer.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_score").getTextContent()))</span>
<span class="source-line-no">162</span><span id="line-162">                                                                .setHspEvalue(evalue)</span>
<span class="source-line-no">163</span><span id="line-163">                                                                .setHspQueryFrom(Integer.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_query-from").getTextContent()))</span>
<span class="source-line-no">164</span><span id="line-164">                                                                .setHspQueryTo(Integer.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_query-to").getTextContent()))</span>
<span class="source-line-no">165</span><span id="line-165">                                                                .setHspHitFrom(Integer.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_hit-from").getTextContent()))</span>
<span class="source-line-no">166</span><span id="line-166">                                                                .setHspHitTo(Integer.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_hit-to").getTextContent()))</span>
<span class="source-line-no">167</span><span id="line-167">                                                                .setHspQueryFrame(Integer.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_query-frame").getTextContent()))</span>
<span class="source-line-no">168</span><span id="line-168">                                                                .setHspHitFrame(Integer.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_hit-frame").getTextContent()))</span>
<span class="source-line-no">169</span><span id="line-169">                                                                .setHspIdentity(Integer.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_identity").getTextContent()))</span>
<span class="source-line-no">170</span><span id="line-170">                                                                .setHspPositive(Integer.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_positive").getTextContent()))</span>
<span class="source-line-no">171</span><span id="line-171">                                                                .setHspGaps(Integer.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_gaps").getTextContent()))</span>
<span class="source-line-no">172</span><span id="line-172">                                                                .setHspAlignLen(Integer.valueOf(XMLHelper.selectSingleElement(hspElement, "Hsp_align-len").getTextContent()))</span>
<span class="source-line-no">173</span><span id="line-173">                                                                .setHspQseq(XMLHelper.selectSingleElement(hspElement, "Hsp_qseq").getTextContent())</span>
<span class="source-line-no">174</span><span id="line-174">                                                                .setHspHseq(XMLHelper.selectSingleElement(hspElement, "Hsp_hseq").getTextContent())</span>
<span class="source-line-no">175</span><span id="line-175">                                                                .setHspIdentityString(XMLHelper.selectSingleElement(hspElement, "Hsp_midline").getTextContent());</span>
<span class="source-line-no">176</span><span id="line-176"></span>
<span class="source-line-no">177</span><span id="line-177">                                                        hspsCollection.add(blastHspBuilder.createBlastHsp());</span>
<span class="source-line-no">178</span><span id="line-178">                                                }</span>
<span class="source-line-no">179</span><span id="line-179">                                        }</span>
<span class="source-line-no">180</span><span id="line-180">                                        // finally set the computed hsp collection and create Hit object</span>
<span class="source-line-no">181</span><span id="line-181">                                        blastHitBuilder.setHsps(hspsCollection);</span>
<span class="source-line-no">182</span><span id="line-182">                                        hitsCollection.add(blastHitBuilder.createBlastHit());</span>
<span class="source-line-no">183</span><span id="line-183">                                }</span>
<span class="source-line-no">184</span><span id="line-184">                                // finally set the computed Hit collection to the result</span>
<span class="source-line-no">185</span><span id="line-185">                                resultBuilder.setHits(hitsCollection);</span>
<span class="source-line-no">186</span><span id="line-186">                                resultsCollection.add(resultBuilder.createBlastResult());</span>
<span class="source-line-no">187</span><span id="line-187">                        }</span>
<span class="source-line-no">188</span><span id="line-188">                } catch (XPathException e) {</span>
<span class="source-line-no">189</span><span id="line-189">                        throw new ParseException(e.getMessage(),0);</span>
<span class="source-line-no">190</span><span id="line-190">                }</span>
<span class="source-line-no">191</span><span id="line-191">                logger.info("Parsing of "+targetFile+" finished.");</span>
<span class="source-line-no">192</span><span id="line-192"></span>
<span class="source-line-no">193</span><span id="line-193">                return resultsCollection;</span>
<span class="source-line-no">194</span><span id="line-194">        }</span>
<span class="source-line-no">195</span><span id="line-195"></span>
<span class="source-line-no">196</span><span id="line-196">        @Override</span>
<span class="source-line-no">197</span><span id="line-197">        public List&lt;String&gt; getFileExtensions(){</span>
<span class="source-line-no">198</span><span id="line-198">                List&lt;String&gt; extensions = new ArrayList&lt;&gt;(1);</span>
<span class="source-line-no">199</span><span id="line-199">                extensions.add("blastxml");</span>
<span class="source-line-no">200</span><span id="line-200">                return extensions;</span>
<span class="source-line-no">201</span><span id="line-201">        }</span>
<span class="source-line-no">202</span><span id="line-202"></span>
<span class="source-line-no">203</span><span id="line-203">        @Override</span>
<span class="source-line-no">204</span><span id="line-204">        public void setQueryReferences(List&lt;Sequence&gt; sequences) {</span>
<span class="source-line-no">205</span><span id="line-205">                queryReferences = sequences;</span>
<span class="source-line-no">206</span><span id="line-206">        }</span>
<span class="source-line-no">207</span><span id="line-207"></span>
<span class="source-line-no">208</span><span id="line-208">        @Override</span>
<span class="source-line-no">209</span><span id="line-209">        public void setDatabaseReferences(List&lt;Sequence&gt; sequences) {</span>
<span class="source-line-no">210</span><span id="line-210">                databaseReferences = sequences;</span>
<span class="source-line-no">211</span><span id="line-211">        }</span>
<span class="source-line-no">212</span><span id="line-212"></span>
<span class="source-line-no">213</span><span id="line-213">        /**</span>
<span class="source-line-no">214</span><span id="line-214">         * fill the map association between sequences an a unique id</span>
<span class="source-line-no">215</span><span id="line-215">         */</span>
<span class="source-line-no">216</span><span id="line-216">        private void mapIds() {</span>
<span class="source-line-no">217</span><span id="line-217">                if (queryReferences != null) {</span>
<span class="source-line-no">218</span><span id="line-218">                        queryReferencesMap = new HashMap&lt;&gt;(queryReferences.size());</span>
<span class="source-line-no">219</span><span id="line-219">                        for (int counter=0; counter &lt; queryReferences.size() ; counter ++){</span>
<span class="source-line-no">220</span><span id="line-220">                                String id = "Query_"+(counter+1);</span>
<span class="source-line-no">221</span><span id="line-221">                                queryReferencesMap.put(id, queryReferences.get(counter));</span>
<span class="source-line-no">222</span><span id="line-222">                        }</span>
<span class="source-line-no">223</span><span id="line-223">                }</span>
<span class="source-line-no">224</span><span id="line-224"></span>
<span class="source-line-no">225</span><span id="line-225">                if (databaseReferences != null) {</span>
<span class="source-line-no">226</span><span id="line-226">                        databaseReferencesMap = new HashMap&lt;&gt;(databaseReferences.size());</span>
<span class="source-line-no">227</span><span id="line-227">                        for (int counter=0; counter &lt; databaseReferences.size() ; counter ++){</span>
<span class="source-line-no">228</span><span id="line-228">                                // this is strange: while Query_id are 1 based, Hit (database) id are 0 based</span>
<span class="source-line-no">229</span><span id="line-229">                                String id = "gnl|BL_ORD_ID|"+(counter);</span>
<span class="source-line-no">230</span><span id="line-230">                                databaseReferencesMap.put(id, databaseReferences.get(counter));</span>
<span class="source-line-no">231</span><span id="line-231">                        }</span>
<span class="source-line-no">232</span><span id="line-232">                }</span>
<span class="source-line-no">233</span><span id="line-233">        }</span>
<span class="source-line-no">234</span><span id="line-234"></span>
<span class="source-line-no">235</span><span id="line-235">        @Override</span>
<span class="source-line-no">236</span><span id="line-236">        public void storeObjects(List&lt;Result&gt; results) throws IOException, ParseException {</span>
<span class="source-line-no">237</span><span id="line-237">                throw new UnsupportedOperationException("This parser does not support writing yet.");</span>
<span class="source-line-no">238</span><span id="line-238">        }</span>
<span class="source-line-no">239</span><span id="line-239">}</span>
<span class="source-line-no">240</span><span id="line-240"></span>
<span class="source-line-no">241</span><span id="line-241"></span>
<span class="source-line-no">242</span><span id="line-242">class BlastHsp extends org.biojava.nbio.core.search.io.Hsp {</span>
<span class="source-line-no">243</span><span id="line-243">        public BlastHsp(int hspNum, double hspBitScore, int hspScore, double hspEvalue, int hspQueryFrom, int hspQueryTo, int hspHitFrom, int hspHitTo, int hspQueryFrame, int hspHitFrame, int hspIdentity, int hspPositive, int hspGaps, int hspAlignLen, String hspQseq, String hspHseq, String hspIdentityString, Double percentageIdentity, Integer mismatchCount) {</span>
<span class="source-line-no">244</span><span id="line-244">                super(hspNum, hspBitScore, hspScore, hspEvalue, hspQueryFrom, hspQueryTo, hspHitFrom, hspHitTo, hspQueryFrame, hspHitFrame, hspIdentity, hspPositive, hspGaps, hspAlignLen, hspQseq, hspHseq, hspIdentityString, percentageIdentity, mismatchCount);</span>
<span class="source-line-no">245</span><span id="line-245">        }</span>
<span class="source-line-no">246</span><span id="line-246"></span>
<span class="source-line-no">247</span><span id="line-247">}</span>
<span class="source-line-no">248</span><span id="line-248"></span>
<span class="source-line-no">249</span><span id="line-249">class BlastHit extends org.biojava.nbio.core.search.io.Hit {</span>
<span class="source-line-no">250</span><span id="line-250">        public BlastHit(int hitNum, String hitId, String hitDef, String hitAccession, int hitLen, List&lt;Hsp&gt; hitHsps, Sequence hitSequence) {</span>
<span class="source-line-no">251</span><span id="line-251">                super(hitNum, hitId, hitDef, hitAccession, hitLen, hitHsps, hitSequence);</span>
<span class="source-line-no">252</span><span id="line-252">        }</span>
<span class="source-line-no">253</span><span id="line-253"></span>
<span class="source-line-no">254</span><span id="line-254">}</span>




























































</pre>
</div>
</main>
</body>
</html>
