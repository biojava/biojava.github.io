<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (21) -->
<title>Source code</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="source: package: org.biojava.nbio.alignment.io, class: StockholmFileParser">
<meta name="generator" content="javadoc/SourceToHTMLConverter">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body class="source-page">
<main role="main">
<div class="source-container">
<pre><span class="source-line-no">001</span><span id="line-1">/*</span>
<span class="source-line-no">002</span><span id="line-2"> * BioJava development code</span>
<span class="source-line-no">003</span><span id="line-3"> *</span>
<span class="source-line-no">004</span><span id="line-4"> * This code may be freely distributed and modified under the terms of the GNU Lesser General Public Licence. This</span>
<span class="source-line-no">005</span><span id="line-5"> * should be distributed with the code. If you do not have a copy, see:</span>
<span class="source-line-no">006</span><span id="line-6"> *</span>
<span class="source-line-no">007</span><span id="line-7"> * http://www.gnu.org/copyleft/lesser.html</span>
<span class="source-line-no">008</span><span id="line-8"> *</span>
<span class="source-line-no">009</span><span id="line-9"> * Copyright for this code is held jointly by the individual authors. These should be listed in @author doc comments.</span>
<span class="source-line-no">010</span><span id="line-10"> *</span>
<span class="source-line-no">011</span><span id="line-11"> * For more information on the BioJava project and its aims, or to join the biojava-l mailing list, visit the home page</span>
<span class="source-line-no">012</span><span id="line-12"> * at:</span>
<span class="source-line-no">013</span><span id="line-13"> *</span>
<span class="source-line-no">014</span><span id="line-14"> * http://www.biojava.org/</span>
<span class="source-line-no">015</span><span id="line-15"> *</span>
<span class="source-line-no">016</span><span id="line-16"> * Created on August 13, 2010 Author: Mark Chapman</span>
<span class="source-line-no">017</span><span id="line-17"> */</span>
<span class="source-line-no">018</span><span id="line-18"></span>
<span class="source-line-no">019</span><span id="line-19">package org.biojava.nbio.alignment.io;</span>
<span class="source-line-no">020</span><span id="line-20"></span>
<span class="source-line-no">021</span><span id="line-21">import org.biojava.nbio.alignment.io.StockholmFileAnnotation.StockholmFileAnnotationReference;</span>
<span class="source-line-no">022</span><span id="line-22">import org.biojava.nbio.core.exceptions.ParserException;</span>
<span class="source-line-no">023</span><span id="line-23">import org.biojava.nbio.core.util.InputStreamProvider;</span>
<span class="source-line-no">024</span><span id="line-24">import org.slf4j.Logger;</span>
<span class="source-line-no">025</span><span id="line-25">import org.slf4j.LoggerFactory;</span>
<span class="source-line-no">026</span><span id="line-26"></span>
<span class="source-line-no">027</span><span id="line-27">import java.io.IOException;</span>
<span class="source-line-no">028</span><span id="line-28">import java.io.InputStream;</span>
<span class="source-line-no">029</span><span id="line-29">import java.util.ArrayList;</span>
<span class="source-line-no">030</span><span id="line-30">import java.util.List;</span>
<span class="source-line-no">031</span><span id="line-31">import java.util.Map;</span>
<span class="source-line-no">032</span><span id="line-32">import java.util.Scanner;</span>
<span class="source-line-no">033</span><span id="line-33"></span>
<span class="source-line-no">034</span><span id="line-34">/**</span>
<span class="source-line-no">035</span><span id="line-35"> * Stockholm file parser.&lt;br&gt;</span>
<span class="source-line-no">036</span><span id="line-36"> * for more information about the format refer to</span>
<span class="source-line-no">037</span><span id="line-37"> * &lt;ul&gt;</span>
<span class="source-line-no">038</span><span id="line-38"> * &lt;li&gt;&lt;a</span>
<span class="source-line-no">039</span><span id="line-39"> * href="ftp://ftp.sanger.ac.uk/pub/databases/Pfam/current_release/userman.txt"&gt;ftp://ftp.sanger.ac.uk/pub/databases</span>
<span class="source-line-no">040</span><span id="line-40"> * /Pfam/current_release/userman.txt&lt;/a&gt;.&lt;/li&gt;</span>
<span class="source-line-no">041</span><span id="line-41"> * &lt;li&gt;&lt;a</span>
<span class="source-line-no">042</span><span id="line-42"> * href="ftp://ftp.sanger.ac.uk/pub/databases/Rfam/CURRENT/USERMAN"&gt;ftp://ftp.sanger.ac.uk/pub/databases/Rfam/CURRENT</span>
<span class="source-line-no">043</span><span id="line-43"> * /USERMAN&lt;/a&gt;.&lt;/li&gt;</span>
<span class="source-line-no">044</span><span id="line-44"> * &lt;li&gt;&lt;a href="http://sonnhammer.sbc.su.se/Stockholm.html"&gt;http://sonnhammer.sbc.su.se/Stockholm.html&lt;/a&gt;.&lt;/li&gt;</span>
<span class="source-line-no">045</span><span id="line-45"> * &lt;/ul&gt;</span>
<span class="source-line-no">046</span><span id="line-46"> *</span>
<span class="source-line-no">047</span><span id="line-47"> * &lt;pre&gt;</span>
<span class="source-line-no">048</span><span id="line-48"> * Pfam DESCRIPTION OF FIELDS</span>
<span class="source-line-no">049</span><span id="line-49"> *</span>
<span class="source-line-no">050</span><span id="line-50"> *    Compulsory fields:</span>
<span class="source-line-no">051</span><span id="line-51"> *    ------------------</span>
<span class="source-line-no">052</span><span id="line-52"> *</span>
<span class="source-line-no">053</span><span id="line-53"> *    AC   Accession number:           Accession number in form PFxxxxx.version or PBxxxxxx.</span>
<span class="source-line-no">054</span><span id="line-54"> *    ID   Identification:             One word name for family.</span>
<span class="source-line-no">055</span><span id="line-55"> *    DE   Definition:                 Short description of family.</span>
<span class="source-line-no">056</span><span id="line-56"> *    AU   Author:                     Authors of the entry.</span>
<span class="source-line-no">057</span><span id="line-57"> *    SE   Source of seed:             The source suggesting the seed members belong to one family.</span>
<span class="source-line-no">058</span><span id="line-58"> *    GA   Gathering method:           Search threshold to build the full alignment.</span>
<span class="source-line-no">059</span><span id="line-59"> *    TC   Trusted Cutoff:             Lowest sequence score and domain score of match in the full alignment.</span>
<span class="source-line-no">060</span><span id="line-60"> *    NC   Noise Cutoff:               Highest sequence score and domain score of match not in full alignment.</span>
<span class="source-line-no">061</span><span id="line-61"> *    TP   Type:                       Type of family -- presently Family, Domain, Motif or Repeat.</span>
<span class="source-line-no">062</span><span id="line-62"> *    SQ   Sequence:                   Number of sequences in alignment.</span>
<span class="source-line-no">063</span><span id="line-63"> *    //                               End of alignment.</span>
<span class="source-line-no">064</span><span id="line-64"> *</span>
<span class="source-line-no">065</span><span id="line-65"> *    Optional fields:</span>
<span class="source-line-no">066</span><span id="line-66"> *    ----------------</span>
<span class="source-line-no">067</span><span id="line-67"> *</span>
<span class="source-line-no">068</span><span id="line-68"> *    DC   Database Comment:           Comment about database reference.</span>
<span class="source-line-no">069</span><span id="line-69"> *    DR   Database Reference:         Reference to external database.</span>
<span class="source-line-no">070</span><span id="line-70"> *    RC   Reference Comment:          Comment about literature reference.</span>
<span class="source-line-no">071</span><span id="line-71"> *    RN   Reference Number:           Reference Number.</span>
<span class="source-line-no">072</span><span id="line-72"> *    RM   Reference Medline:          Eight digit medline UI number.</span>
<span class="source-line-no">073</span><span id="line-73"> *    RT   Reference Title:            Reference Title.</span>
<span class="source-line-no">074</span><span id="line-74"> *    RA   Reference Author:           Reference Author</span>
<span class="source-line-no">075</span><span id="line-75"> *    RL   Reference Location:         Journal location.</span>
<span class="source-line-no">076</span><span id="line-76"> *    PI   Previous identifier:        Record of all previous ID lines.</span>
<span class="source-line-no">077</span><span id="line-77"> *    KW   Keywords:                   Keywords.</span>
<span class="source-line-no">078</span><span id="line-78"> *    CC   Comment:                    Comments.</span>
<span class="source-line-no">079</span><span id="line-79"> *    NE   Pfam accession:             Indicates a nested domain.</span>
<span class="source-line-no">080</span><span id="line-80"> *    NL   Location:                   Location of nested domains - sequence ID, start and end of insert.</span>
<span class="source-line-no">081</span><span id="line-81"> *    WK   Wikipedia Reference:        Reference to wikipedia.</span>
<span class="source-line-no">082</span><span id="line-82"> *</span>
<span class="source-line-no">083</span><span id="line-83"> *    Obsolete fields:</span>
<span class="source-line-no">084</span><span id="line-84"> *    -----------</span>
<span class="source-line-no">085</span><span id="line-85"> *    AL   Alignment method of seed:   The method used to align the seed members.</span>
<span class="source-line-no">086</span><span id="line-86"> *    AM   Alignment Method:        The order ls and fs hits are aligned to the model to build the full align.</span>
<span class="source-line-no">087</span><span id="line-87"> *</span>
<span class="source-line-no">088</span><span id="line-88"> * &lt;/pre&gt;</span>
<span class="source-line-no">089</span><span id="line-89"> *</span>
<span class="source-line-no">090</span><span id="line-90"> * @since 3.0.5</span>
<span class="source-line-no">091</span><span id="line-91"> * @author Amr ALHOSSARY</span>
<span class="source-line-no">092</span><span id="line-92"> * @author Marko Vaz</span>
<span class="source-line-no">093</span><span id="line-93"> *</span>
<span class="source-line-no">094</span><span id="line-94"> */</span>
<span class="source-line-no">095</span><span id="line-95">public class StockholmFileParser {</span>
<span class="source-line-no">096</span><span id="line-96"></span>
<span class="source-line-no">097</span><span id="line-97">        private final static Logger logger = LoggerFactory.getLogger(StockholmFileParser.class);</span>
<span class="source-line-no">098</span><span id="line-98"></span>
<span class="source-line-no">099</span><span id="line-99">        /** indicates reading as much as possible, without limits */</span>
<span class="source-line-no">100</span><span id="line-100">        public static final int INFINITY = -1;</span>
<span class="source-line-no">101</span><span id="line-101">        /** #=GF &amp;lt;feature&amp;gt; &amp;lt;Generic per-File annotation, free text&amp;gt; */</span>
<span class="source-line-no">102</span><span id="line-102">        private static final String GENERIC_PER_FILE_ANNOTATION = "GF";</span>
<span class="source-line-no">103</span><span id="line-103">        /** #=GC &amp;lt;feature&amp;gt; &amp;lt;Generic per-Column annotation, exactly 1 char per column&amp;gt; */</span>
<span class="source-line-no">104</span><span id="line-104">        private static final String GENERIC_PER_CONSENSUS_ANNOTATION = "GC";</span>
<span class="source-line-no">105</span><span id="line-105">        /** #=GS &amp;lt;seqname&amp;gt; &amp;lt;feature&amp;gt; &amp;lt;Generic per-Sequence annotation, free text&amp;gt; */</span>
<span class="source-line-no">106</span><span id="line-106">        private static final String GENERIC_PER_SEQUENCE_ANNOTATION = "GS";</span>
<span class="source-line-no">107</span><span id="line-107">        /** #=GR &amp;lt;seqname&amp;gt; &amp;lt;feature&amp;gt; &amp;lt;Generic per-Residue annotation, exactly 1 char per residue&amp;gt; */</span>
<span class="source-line-no">108</span><span id="line-108">        private static final String GENERIC_PER_RESIDUE_ANNOTATION = "GR";</span>
<span class="source-line-no">109</span><span id="line-109"></span>
<span class="source-line-no">110</span><span id="line-110">        // COMPULSORY FIELDS</span>
<span class="source-line-no">111</span><span id="line-111">        /** Accession number in form PFxxxxx (Pfam) or RFxxxxx (Rfam). */</span>
<span class="source-line-no">112</span><span id="line-112">        private static final String GF_ACCESSION_NUMBER = "AC";</span>
<span class="source-line-no">113</span><span id="line-113">        /** One word name for family. */</span>
<span class="source-line-no">114</span><span id="line-114">        private static final String GF_IDENTIFICATION = "ID";</span>
<span class="source-line-no">115</span><span id="line-115">        /** Short description of family. */</span>
<span class="source-line-no">116</span><span id="line-116">        private static final String GF_DEFINITION = "DE";</span>
<span class="source-line-no">117</span><span id="line-117">        /** Authors of the entry. */</span>
<span class="source-line-no">118</span><span id="line-118">        private static final String GF_AUTHOR = "AU";</span>
<span class="source-line-no">119</span><span id="line-119">        /**</span>
<span class="source-line-no">120</span><span id="line-120">         * Indicates the order that ls and fs matches are aligned to the model to give the full alignment. (OBSOLETE IN</span>
<span class="source-line-no">121</span><span id="line-121">         * HMMER3)</span>
<span class="source-line-no">122</span><span id="line-122">         */</span>
<span class="source-line-no">123</span><span id="line-123">        private static final String GF_ALIGNMENT_METHOD = "AM";</span>
<span class="source-line-no">124</span><span id="line-124">        /** Command line used to generate the model */</span>
<span class="source-line-no">125</span><span id="line-125">        private static final String GF_BUILD_METHOD = "BM";</span>
<span class="source-line-no">126</span><span id="line-126">        /** Command line used to perform the search */</span>
<span class="source-line-no">127</span><span id="line-127">        private static final String GF_SEARCH_METHOD = "SM";</span>
<span class="source-line-no">128</span><span id="line-128">        /** The source suggesting the seed members belong to one family. */</span>
<span class="source-line-no">129</span><span id="line-129">        private static final String GF_SOURCE_SEED = "SE";</span>
<span class="source-line-no">130</span><span id="line-130">        /** The source (prediction or publication) of the consensus RNA secondary structure used by Rfam. */</span>
<span class="source-line-no">131</span><span id="line-131">        private static final String GF_SOURCE_STRUCTURE = "SS";</span>
<span class="source-line-no">132</span><span id="line-132">        /** Search threshold to build the full alignment. */</span>
<span class="source-line-no">133</span><span id="line-133">        private static final String GF_GATHERING_THRESHOLD = "GA";</span>
<span class="source-line-no">134</span><span id="line-134">        /** Lowest sequence score (and domain score for Pfam) of match in the full alignment. */</span>
<span class="source-line-no">135</span><span id="line-135">        private static final String GF_TRUSTED_CUTOFF = "TC";</span>
<span class="source-line-no">136</span><span id="line-136">        /** Highest sequence score (and domain score for Pfam) of match not in full alignment. */</span>
<span class="source-line-no">137</span><span id="line-137">        private static final String GF_NOISE_CUTOFF = "NC";</span>
<span class="source-line-no">138</span><span id="line-138">        /**</span>
<span class="source-line-no">139</span><span id="line-139">         * Type of family -- presently Family, Domain, Motif or Repeat for Pfam. -- a tree with roots Gene, Intron or</span>
<span class="source-line-no">140</span><span id="line-140">         * Cis-reg for Rfam.</span>
<span class="source-line-no">141</span><span id="line-141">         */</span>
<span class="source-line-no">142</span><span id="line-142">        private static final String GF_TYPE_FIELD = "TP";</span>
<span class="source-line-no">143</span><span id="line-143">        /** Number of sequences in alignment, and start of MSA. */</span>
<span class="source-line-no">144</span><span id="line-144">        private static final String GF_SEQUENCE = "SQ";</span>
<span class="source-line-no">145</span><span id="line-145"></span>
<span class="source-line-no">146</span><span id="line-146">        // OPTIONAL FIELDS</span>
<span class="source-line-no">147</span><span id="line-147"></span>
<span class="source-line-no">148</span><span id="line-148">        /** Comment about database reference. */</span>
<span class="source-line-no">149</span><span id="line-149">        private static final String GF_DB_COMMENT = "DC";</span>
<span class="source-line-no">150</span><span id="line-150">        /** Reference to external database. */</span>
<span class="source-line-no">151</span><span id="line-151">        private static final String GF_DB_REFERENCE = "DR";</span>
<span class="source-line-no">152</span><span id="line-152">        /** Comment about literature reference. */</span>
<span class="source-line-no">153</span><span id="line-153">        private static final String GF_REFERENCE_COMMENT = "RC";</span>
<span class="source-line-no">154</span><span id="line-154">        /** Reference Number. */</span>
<span class="source-line-no">155</span><span id="line-155">        private static final String GF_REFERENCE_NUMBER = "RN";</span>
<span class="source-line-no">156</span><span id="line-156">        /** Eight digit medline UI number. */</span>
<span class="source-line-no">157</span><span id="line-157">        private static final String GF_REFERENCE_MEDLINE = "RM";</span>
<span class="source-line-no">158</span><span id="line-158">        /** Reference Title. */</span>
<span class="source-line-no">159</span><span id="line-159">        private static final String GF_REFERENCE_TITLE = "RT";</span>
<span class="source-line-no">160</span><span id="line-160">        /** Reference Author. */</span>
<span class="source-line-no">161</span><span id="line-161">        private static final String GF_REFERENCE_AUTHOR = "RA";</span>
<span class="source-line-no">162</span><span id="line-162">        /** Journal Location. */</span>
<span class="source-line-no">163</span><span id="line-163">        private static final String GF_REFERENCE_LOCALTION = "RL";</span>
<span class="source-line-no">164</span><span id="line-164">        /** Record of all previous ID lines. */</span>
<span class="source-line-no">165</span><span id="line-165">        private static final String GF_PREVIOUS_IDS = "PI";</span>
<span class="source-line-no">166</span><span id="line-166">        /** Keywords */</span>
<span class="source-line-no">167</span><span id="line-167">        private static final String GF_KEYWORDS = "KW";</span>
<span class="source-line-no">168</span><span id="line-168">        /** Comments */</span>
<span class="source-line-no">169</span><span id="line-169">        private static final String GF_COMMENT = "CC";</span>
<span class="source-line-no">170</span><span id="line-170">        /** Indicates a nested domain */</span>
<span class="source-line-no">171</span><span id="line-171">        private static final String GF_PFAM_ACCESSION = "NE";</span>
<span class="source-line-no">172</span><span id="line-172">        /** Location of nested domains - sequence ID, start and end of insert. */</span>
<span class="source-line-no">173</span><span id="line-173">        private static final String GF_LOCATION = "NL";</span>
<span class="source-line-no">174</span><span id="line-174">        /** Wikipedia page */</span>
<span class="source-line-no">175</span><span id="line-175">        private static final String GF_WIKIPEDIA_LINK = "WK";</span>
<span class="source-line-no">176</span><span id="line-176">        /** Clan accession */</span>
<span class="source-line-no">177</span><span id="line-177">        private static final String GF_CLAN = "CL";</span>
<span class="source-line-no">178</span><span id="line-178">        /** Used for listing Clan membership */</span>
<span class="source-line-no">179</span><span id="line-179">        private static final String GF_MEMBERSHIP = "MB";</span>
<span class="source-line-no">180</span><span id="line-180"></span>
<span class="source-line-no">181</span><span id="line-181">        /** FOR EMBEDDING TREES **/</span>
<span class="source-line-no">182</span><span id="line-182"></span>
<span class="source-line-no">183</span><span id="line-183">        /** A tree in New Hampshire eXtended format. */</span>
<span class="source-line-no">184</span><span id="line-184">        private static final String GF_NEW_HAMPSHIRE = "NH";</span>
<span class="source-line-no">185</span><span id="line-185">        /** A unique identifier for the next tree. */</span>
<span class="source-line-no">186</span><span id="line-186">        private static final String GF_TREE_ID = "TN";</span>
<span class="source-line-no">187</span><span id="line-187"></span>
<span class="source-line-no">188</span><span id="line-188">        // OTHER</span>
<span class="source-line-no">189</span><span id="line-189"></span>
<span class="source-line-no">190</span><span id="line-190">        /**</span>
<span class="source-line-no">191</span><span id="line-191">         * A method used to set the bit score threshold based on the ratio of expected false positives to true positives.</span>
<span class="source-line-no">192</span><span id="line-192">         * Floating point number between 0 and 1.</span>
<span class="source-line-no">193</span><span id="line-193">         */</span>
<span class="source-line-no">194</span><span id="line-194">        private static final String GF_FALSE_DISCOVERY_RATE = "FR";</span>
<span class="source-line-no">195</span><span id="line-195"></span>
<span class="source-line-no">196</span><span id="line-196">        // #=GS &lt;seqname&gt; &lt;feature&gt; &lt;Generic per-Sequence annotation, free text&gt;</span>
<span class="source-line-no">197</span><span id="line-197"></span>
<span class="source-line-no">198</span><span id="line-198">        private static final String GS_ACCESSION_NUMBER = "AC";</span>
<span class="source-line-no">199</span><span id="line-199">        private static final String GS_DESCRIPTION = "DE";</span>
<span class="source-line-no">200</span><span id="line-200">        private static final String GS_DATABASE_REFERENCE = "DR";</span>
<span class="source-line-no">201</span><span id="line-201">        private static final String GS_ORGANISM_SPECIES = "OS";</span>
<span class="source-line-no">202</span><span id="line-202">        private static final String GS_ORGANISM_CLASSIFICATION = "OC";</span>
<span class="source-line-no">203</span><span id="line-203">        private static final String GS_LOOK = "LO";</span>
<span class="source-line-no">204</span><span id="line-204"></span>
<span class="source-line-no">205</span><span id="line-205">        // #=GR &lt;seqname&gt; &lt;feature&gt; &lt;Generic per-Residue annotation, exactly 1 char per residue&gt;</span>
<span class="source-line-no">206</span><span id="line-206"></span>
<span class="source-line-no">207</span><span id="line-207">        /**</span>
<span class="source-line-no">208</span><span id="line-208">         * For RNA [.,;&lt;&gt;(){}[]AaBb...],&lt;br&gt;</span>
<span class="source-line-no">209</span><span id="line-209">         * For protein [HGIEBTSCX]</span>
<span class="source-line-no">210</span><span id="line-210">         */</span>
<span class="source-line-no">211</span><span id="line-211">        private static final String GR_SECONDARY_STRUCTURE = "SS";</span>
<span class="source-line-no">212</span><span id="line-212">        /**</span>
<span class="source-line-no">213</span><span id="line-213">         * [0-9X]&lt;br&gt;</span>
<span class="source-line-no">214</span><span id="line-214">         * (0=0%-10%; ...; 9=90%-100%)</span>
<span class="source-line-no">215</span><span id="line-215">         */</span>
<span class="source-line-no">216</span><span id="line-216">        private static final String GR_SURFACE_ACCESSIBILITY = "SA";</span>
<span class="source-line-no">217</span><span id="line-217"></span>
<span class="source-line-no">218</span><span id="line-218">        /** [Mio] */</span>
<span class="source-line-no">219</span><span id="line-219">        private static final String GR_TRANS_MEMBRANE = "TM";</span>
<span class="source-line-no">220</span><span id="line-220">        /**</span>
<span class="source-line-no">221</span><span id="line-221">         * [0-9*]&lt;br&gt;</span>
<span class="source-line-no">222</span><span id="line-222">         * (0=0.00-0.05; 1=0.05-0.15; *=0.95-1.00)</span>
<span class="source-line-no">223</span><span id="line-223">         */</span>
<span class="source-line-no">224</span><span id="line-224">        private static final String GR_POSTERIOR_PROBABILITY = "PP";</span>
<span class="source-line-no">225</span><span id="line-225">        /** [*] */</span>
<span class="source-line-no">226</span><span id="line-226">        private static final String GR_LIGAND_BINDING = "LI";</span>
<span class="source-line-no">227</span><span id="line-227">        /** [*] */</span>
<span class="source-line-no">228</span><span id="line-228">        private static final String GR_ACTIVE_SITE = "AS";</span>
<span class="source-line-no">229</span><span id="line-229">        /** [*] */</span>
<span class="source-line-no">230</span><span id="line-230">        private static final String GR_AS_PFAM_PREDICTED = "pAS";</span>
<span class="source-line-no">231</span><span id="line-231">        /** [*] */</span>
<span class="source-line-no">232</span><span id="line-232">        private static final String GR_AS_SWISSPROT = "sAS";</span>
<span class="source-line-no">233</span><span id="line-233">        /** [0-2] */</span>
<span class="source-line-no">234</span><span id="line-234">        private static final String GR_INTRON = "IN";</span>
<span class="source-line-no">235</span><span id="line-235"></span>
<span class="source-line-no">236</span><span id="line-236">        // #=GC &lt;feature&gt; &lt;Generic per-Column annotation, exactly 1 char per column&gt;</span>
<span class="source-line-no">237</span><span id="line-237"></span>
<span class="source-line-no">238</span><span id="line-238">        private static final String GC_SEQUENSE_CONSENSUS = "seq_cons";</span>
<span class="source-line-no">239</span><span id="line-239">        private static final String GC_SECONDARY_STRUCTURE = "SS_cons";</span>
<span class="source-line-no">240</span><span id="line-240">        private static final String GC_SURFACE_ACCESSIBILITY = "SA_cons";</span>
<span class="source-line-no">241</span><span id="line-241">        private static final String GC_TRANS_MEMBRANE = "TM_cons";</span>
<span class="source-line-no">242</span><span id="line-242">        private static final String GC_POSTERIOR_PROBABILITY = "PP_cons";</span>
<span class="source-line-no">243</span><span id="line-243">        private static final String GC_LIGAND_BINDING = "LI_cons";</span>
<span class="source-line-no">244</span><span id="line-244">        private static final String GC_ACTIVE_SITE = "AS_cons";</span>
<span class="source-line-no">245</span><span id="line-245">        private static final String GC_AS_PFAM_PREDICTED = "pAS_cons";</span>
<span class="source-line-no">246</span><span id="line-246">        private static final String GC_AS_SWISSPROT = "sAS_cons";</span>
<span class="source-line-no">247</span><span id="line-247">        private static final String GC_INTRON = "IN_cons";</span>
<span class="source-line-no">248</span><span id="line-248">        /**</span>
<span class="source-line-no">249</span><span id="line-249">         * Often the consensus RNA or protein sequence is used as a reference Any non-gap character (eg. x's) can indicate</span>
<span class="source-line-no">250</span><span id="line-250">         * consensus/conserved/match columns .'s or -'s indicate insert columns ~'s indicate unaligned insertions Upper and</span>
<span class="source-line-no">251</span><span id="line-251">         * lower case can be used to discriminate strong and weakly conserved residues respectively</span>
<span class="source-line-no">252</span><span id="line-252">         */</span>
<span class="source-line-no">253</span><span id="line-253">        private static final String GC_REFERENCE_ANNOTATION = "RF";</span>
<span class="source-line-no">254</span><span id="line-254">        /**</span>
<span class="source-line-no">255</span><span id="line-255">         * Indicates which columns in an alignment should be masked, such that the emission probabilities for match states</span>
<span class="source-line-no">256</span><span id="line-256">         * corresponding to those columns will be the background distribution.</span>
<span class="source-line-no">257</span><span id="line-257">         */</span>
<span class="source-line-no">258</span><span id="line-258">        private static final String GC_MODEL_MASK = "MM";</span>
<span class="source-line-no">259</span><span id="line-259"></span>
<span class="source-line-no">260</span><span id="line-260">        private StockholmStructure stockholmStructure;</span>
<span class="source-line-no">261</span><span id="line-261">        // private boolean endFile = false;</span>
<span class="source-line-no">262</span><span id="line-262"></span>
<span class="source-line-no">263</span><span id="line-263">        // private static final int STATUS_OUTSIDE_FILE = 0;</span>
<span class="source-line-no">264</span><span id="line-264">        // private static final int STATUS_INSIDE_FILE = 10;</span>
<span class="source-line-no">265</span><span id="line-265">        // private static final int STATUS_IN_SEQUENCE = 20;</span>
<span class="source-line-no">266</span><span id="line-266">        //</span>
<span class="source-line-no">267</span><span id="line-267">        // private int status=STATUS_OUTSIDE_FILE;</span>
<span class="source-line-no">268</span><span id="line-268"></span>
<span class="source-line-no">269</span><span id="line-269">        Scanner internalScanner = null;</span>
<span class="source-line-no">270</span><span id="line-270">        private InputStream cashedInputStream;</span>
<span class="source-line-no">271</span><span id="line-271"></span>
<span class="source-line-no">272</span><span id="line-272">        /**</span>
<span class="source-line-no">273</span><span id="line-273">         * Parses a Stockholm file and returns a {@link StockholmStructure} object with its content.&lt;br&gt;</span>
<span class="source-line-no">274</span><span id="line-274">         * This function is meant to be used for single access to specific file and it closes the file after doing its</span>
<span class="source-line-no">275</span><span id="line-275">         * assigned job. Any subsequent call to {@link #parseNext(int)} will throw an exception or will function with</span>
<span class="source-line-no">276</span><span id="line-276">         * unpredicted behavior.</span>
<span class="source-line-no">277</span><span id="line-277">         *</span>
<span class="source-line-no">278</span><span id="line-278">         * @param filename</span>
<span class="source-line-no">279</span><span id="line-279">         *            complete(?) path to the file from where to read the content</span>
<span class="source-line-no">280</span><span id="line-280">         * @return stockholm file content</span>
<span class="source-line-no">281</span><span id="line-281">         * @throws IOException</span>
<span class="source-line-no">282</span><span id="line-282">         *             when an exception occurred while opening/reading/closing the file+</span>
<span class="source-line-no">283</span><span id="line-283">         * @throws ParserException</span>
<span class="source-line-no">284</span><span id="line-284">         *             if unexpected format is encountered</span>
<span class="source-line-no">285</span><span id="line-285">         */</span>
<span class="source-line-no">286</span><span id="line-286">        public StockholmStructure parse(String filename) throws IOException {</span>
<span class="source-line-no">287</span><span id="line-287">                InputStream inStream = new InputStreamProvider().getInputStream(filename);</span>
<span class="source-line-no">288</span><span id="line-288">                StockholmStructure structure = parse(inStream);</span>
<span class="source-line-no">289</span><span id="line-289">                inStream.close();</span>
<span class="source-line-no">290</span><span id="line-290">                return structure;</span>
<span class="source-line-no">291</span><span id="line-291">        }</span>
<span class="source-line-no">292</span><span id="line-292"></span>
<span class="source-line-no">293</span><span id="line-293">        /**</span>
<span class="source-line-no">294</span><span id="line-294">         * Parses a Stockholm file and returns a {@link StockholmStructure} object with its content.&lt;br&gt;</span>
<span class="source-line-no">295</span><span id="line-295">         * This function doesn't close the file after doing its assigned job; to allow for further calls of</span>
<span class="source-line-no">296</span><span id="line-296">         * {@link #parseNext(int)}.</span>
<span class="source-line-no">297</span><span id="line-297">         *</span>
<span class="source-line-no">298</span><span id="line-298">         * @see #parseNext(int)</span>
<span class="source-line-no">299</span><span id="line-299">         *</span>
<span class="source-line-no">300</span><span id="line-300">         * @param filename</span>
<span class="source-line-no">301</span><span id="line-301">         *            file from where to read the content. see {@link InputStreamProvider} for more details.</span>
<span class="source-line-no">302</span><span id="line-302">         * @param max</span>
<span class="source-line-no">303</span><span id="line-303">         *            maximum number of files to read, {@link #INFINITY} for all.</span>
<span class="source-line-no">304</span><span id="line-304">         * @return a vector of {@link StockholmStructure} containing parsed structures.</span>
<span class="source-line-no">305</span><span id="line-305">         * @throws IOException</span>
<span class="source-line-no">306</span><span id="line-306">         *             when an exception occurred while opening/reading/closing the file.</span>
<span class="source-line-no">307</span><span id="line-307">         * @throws ParserException</span>
<span class="source-line-no">308</span><span id="line-308">         *             if unexpected format is encountered</span>
<span class="source-line-no">309</span><span id="line-309">         */</span>
<span class="source-line-no">310</span><span id="line-310">        public List&lt;StockholmStructure&gt; parse(String filename, int max) throws IOException {</span>
<span class="source-line-no">311</span><span id="line-311">                InputStreamProvider isp = new InputStreamProvider();</span>
<span class="source-line-no">312</span><span id="line-312">                InputStream inStream = isp.getInputStream(filename);</span>
<span class="source-line-no">313</span><span id="line-313">                return parse(inStream, max);</span>
<span class="source-line-no">314</span><span id="line-314">        }</span>
<span class="source-line-no">315</span><span id="line-315"></span>
<span class="source-line-no">316</span><span id="line-316">        /**</span>
<span class="source-line-no">317</span><span id="line-317">         * parses {@link InputStream} and returns a the first contained alignment in a {@link StockholmStructure} object.</span>
<span class="source-line-no">318</span><span id="line-318">         * Used mainly for multiple files within the same input stream, (e.g. when reading from Pfam flat files. &lt;br&gt;</span>
<span class="source-line-no">319</span><span id="line-319">         * This method leaves the stream open for further calls of {@link #parseNext(int)}.</span>
<span class="source-line-no">320</span><span id="line-320">         *</span>
<span class="source-line-no">321</span><span id="line-321">         * @see #parseNext(int)</span>
<span class="source-line-no">322</span><span id="line-322">         * @param inStream</span>
<span class="source-line-no">323</span><span id="line-323">         *            the {@link InputStream} containing the file to read.</span>
<span class="source-line-no">324</span><span id="line-324">         * @return a {@link StockholmStructure} object representing file contents.</span>
<span class="source-line-no">325</span><span id="line-325">         * @throws IOException</span>
<span class="source-line-no">326</span><span id="line-326">         * @throws ParserException</span>
<span class="source-line-no">327</span><span id="line-327">         */</span>
<span class="source-line-no">328</span><span id="line-328">        public StockholmStructure parse(InputStream inStream) throws IOException {</span>
<span class="source-line-no">329</span><span id="line-329">                return parse(inStream, 1).get(0);</span>
<span class="source-line-no">330</span><span id="line-330">        }</span>
<span class="source-line-no">331</span><span id="line-331"></span>
<span class="source-line-no">332</span><span id="line-332">        /**</span>
<span class="source-line-no">333</span><span id="line-333">         * parses an {@link InputStream} and returns at maximum &lt;code&gt;max&lt;/code&gt; objects contained in that file.&lt;br&gt;</span>
<span class="source-line-no">334</span><span id="line-334">         * This method leaves the stream open for further calls of {@link #parse(InputStream, int)} (same function) or</span>
<span class="source-line-no">335</span><span id="line-335">         * {@link #parseNext(int)}.</span>
<span class="source-line-no">336</span><span id="line-336">         *</span>
<span class="source-line-no">337</span><span id="line-337">         * @see #parseNext(int)</span>
<span class="source-line-no">338</span><span id="line-338">         * @param inStream</span>
<span class="source-line-no">339</span><span id="line-339">         *            the stream to parse</span>
<span class="source-line-no">340</span><span id="line-340">         * @param max</span>
<span class="source-line-no">341</span><span id="line-341">         *            maximum number of structures to try to parse, {@link #INFINITY} to try to obtain as much as possible.</span>
<span class="source-line-no">342</span><span id="line-342">         * @return a {@link List} of {@link StockholmStructure} objects. If there are no more structures, an empty list is</span>
<span class="source-line-no">343</span><span id="line-343">         *         returned.</span>
<span class="source-line-no">344</span><span id="line-344">         * @throws IOException</span>
<span class="source-line-no">345</span><span id="line-345">         *             in case an I/O Exception occurred.</span>
<span class="source-line-no">346</span><span id="line-346">         */</span>
<span class="source-line-no">347</span><span id="line-347">        public List&lt;StockholmStructure&gt; parse(InputStream inStream, int max) throws IOException {</span>
<span class="source-line-no">348</span><span id="line-348">                if (max &lt; INFINITY) {</span>
<span class="source-line-no">349</span><span id="line-349">                        throw new IllegalArgumentException("max can't be -ve value " + max);</span>
<span class="source-line-no">350</span><span id="line-350">                }</span>
<span class="source-line-no">351</span><span id="line-351">                if (inStream != this.cashedInputStream) {</span>
<span class="source-line-no">352</span><span id="line-352">                        this.cashedInputStream = inStream;</span>
<span class="source-line-no">353</span><span id="line-353">                        this.internalScanner = null;</span>
<span class="source-line-no">354</span><span id="line-354">                }</span>
<span class="source-line-no">355</span><span id="line-355"></span>
<span class="source-line-no">356</span><span id="line-356">                if (internalScanner == null) {</span>
<span class="source-line-no">357</span><span id="line-357">                        internalScanner = new Scanner(inStream);</span>
<span class="source-line-no">358</span><span id="line-358">                }</span>
<span class="source-line-no">359</span><span id="line-359">                ArrayList&lt;StockholmStructure&gt; structures = new ArrayList&lt;&gt;();</span>
<span class="source-line-no">360</span><span id="line-360">                while (max != INFINITY &amp;&amp; max-- &gt; 0) {</span>
<span class="source-line-no">361</span><span id="line-361">                        StockholmStructure structure = parse(internalScanner);</span>
<span class="source-line-no">362</span><span id="line-362">                        if (structure != null) {</span>
<span class="source-line-no">363</span><span id="line-363">                                structures.add(structure);</span>
<span class="source-line-no">364</span><span id="line-364">                        } else {</span>
<span class="source-line-no">365</span><span id="line-365">                                break;</span>
<span class="source-line-no">366</span><span id="line-366">                        }</span>
<span class="source-line-no">367</span><span id="line-367">                }</span>
<span class="source-line-no">368</span><span id="line-368">                return structures;</span>
<span class="source-line-no">369</span><span id="line-369">        }</span>
<span class="source-line-no">370</span><span id="line-370"></span>
<span class="source-line-no">371</span><span id="line-371">        /**</span>
<span class="source-line-no">372</span><span id="line-372">         * Tries to parse and return as maximum as &lt;code&gt;max&lt;/code&gt; structures in the last used file or input stream.&lt;br&gt;</span>
<span class="source-line-no">373</span><span id="line-373">         * Please consider calling either {@link #parse(InputStream)}, {@link #parse(InputStream, int)}, or</span>
<span class="source-line-no">374</span><span id="line-374">         * {@link #parse(String, int)} before calling this function.</span>
<span class="source-line-no">375</span><span id="line-375">         *</span>
<span class="source-line-no">376</span><span id="line-376">         * @param max</span>
<span class="source-line-no">377</span><span id="line-377">         * @return</span>
<span class="source-line-no">378</span><span id="line-378">         * @throws IOException</span>
<span class="source-line-no">379</span><span id="line-379">         */</span>
<span class="source-line-no">380</span><span id="line-380">        public List&lt;StockholmStructure&gt; parseNext(int max) throws IOException {</span>
<span class="source-line-no">381</span><span id="line-381">                return parse(this.cashedInputStream, max);</span>
<span class="source-line-no">382</span><span id="line-382">        }</span>
<span class="source-line-no">383</span><span id="line-383"></span>
<span class="source-line-no">384</span><span id="line-384">        /**</span>
<span class="source-line-no">385</span><span id="line-385">         * Parses a Stockholm file and returns a {@link StockholmStructure} object with its content. This method returns</span>
<span class="source-line-no">386</span><span id="line-386">         * just after reaching the end of structure delimiter line ("//"), leaving any remaining empty lines unconsumed.</span>
<span class="source-line-no">387</span><span id="line-387">         *</span>
<span class="source-line-no">388</span><span id="line-388">         * @param scanner</span>
<span class="source-line-no">389</span><span id="line-389">         *            from where to read the file content</span>
<span class="source-line-no">390</span><span id="line-390">         * @return Stockholm file content, &lt;code&gt;null&lt;/code&gt; if couldn't or no more structures.</span>
<span class="source-line-no">391</span><span id="line-391">         * @throws IOException</span>
<span class="source-line-no">392</span><span id="line-392">         * @throws Exception</span>
<span class="source-line-no">393</span><span id="line-393">         */</span>
<span class="source-line-no">394</span><span id="line-394">        StockholmStructure parse(Scanner scanner) throws IOException {</span>
<span class="source-line-no">395</span><span id="line-395">                if (scanner == null) {</span>
<span class="source-line-no">396</span><span id="line-396">                        if (internalScanner != null) {</span>
<span class="source-line-no">397</span><span id="line-397">                                scanner = internalScanner;</span>
<span class="source-line-no">398</span><span id="line-398">                        } else {</span>
<span class="source-line-no">399</span><span id="line-399">                                throw new IllegalArgumentException("No Scanner defined");</span>
<span class="source-line-no">400</span><span id="line-400">                        }</span>
<span class="source-line-no">401</span><span id="line-401">                }</span>
<span class="source-line-no">402</span><span id="line-402">                String line = null;</span>
<span class="source-line-no">403</span><span id="line-403">                int linesCount = 0;</span>
<span class="source-line-no">404</span><span id="line-404">                try {</span>
<span class="source-line-no">405</span><span id="line-405">                        while (scanner.hasNextLine()) {</span>
<span class="source-line-no">406</span><span id="line-406">                                line = scanner.nextLine();</span>
<span class="source-line-no">407</span><span id="line-407">                                // if the file is empty</span>
<span class="source-line-no">408</span><span id="line-408">                                // this condition will not happen, just left in case we decided to go for buffereedReader again for</span>
<span class="source-line-no">409</span><span id="line-409">                                // performance purpose.</span>
<span class="source-line-no">410</span><span id="line-410">                                if (linesCount == 0 &amp;&amp; line == null) {</span>
<span class="source-line-no">411</span><span id="line-411">                                        throw new IOException("Could not parse Stockholm file, BufferedReader returns null!");</span>
<span class="source-line-no">412</span><span id="line-412">                                }</span>
<span class="source-line-no">413</span><span id="line-413"></span>
<span class="source-line-no">414</span><span id="line-414">                                // ignore empty lines</span>
<span class="source-line-no">415</span><span id="line-415">                                if ((/* status==STATUS_INSIDE_FILE &amp;&amp; */line == null) || line.trim().length() == 0) {</span>
<span class="source-line-no">416</span><span id="line-416">                                        continue;</span>
<span class="source-line-no">417</span><span id="line-417">                                }</span>
<span class="source-line-no">418</span><span id="line-418"></span>
<span class="source-line-no">419</span><span id="line-419">                                if (line.startsWith("#=G")) {</span>
<span class="source-line-no">420</span><span id="line-420">                                        // // comment line or metadata</span>
<span class="source-line-no">421</span><span id="line-421">                                        // line = line.substring(1).trim();</span>
<span class="source-line-no">422</span><span id="line-422">                                        // line = line.substring(1).trim();</span>
<span class="source-line-no">423</span><span id="line-423">                                        if (line.startsWith(GENERIC_PER_FILE_ANNOTATION, 2)) {</span>
<span class="source-line-no">424</span><span id="line-424">                                                // #=GF &lt;featurename&gt; &lt;generic per-file annotation, free text&gt;</span>
<span class="source-line-no">425</span><span id="line-425">                                                int firstSpaceIndex = line.indexOf(' ', 5);</span>
<span class="source-line-no">426</span><span id="line-426">                                                String featureName = line.substring(5, firstSpaceIndex);</span>
<span class="source-line-no">427</span><span id="line-427">                                                String value = line.substring(firstSpaceIndex).trim();</span>
<span class="source-line-no">428</span><span id="line-428">                                                handleFileAnnotation(featureName, value);</span>
<span class="source-line-no">429</span><span id="line-429">                                        } else if (line.startsWith(GENERIC_PER_CONSENSUS_ANNOTATION, 2)) {</span>
<span class="source-line-no">430</span><span id="line-430">                                                // Being in a consensus means we are no longer in a sequence.</span>
<span class="source-line-no">431</span><span id="line-431">                                                // this.status = STATUS_INSIDE_FILE;</span>
<span class="source-line-no">432</span><span id="line-432">                                                // #=GC &lt;featurename&gt; &lt;generic per-column annotation, exactly 1 char per column&gt;</span>
<span class="source-line-no">433</span><span id="line-433">                                                int firstSpaceIndex = line.indexOf(' ', 5);</span>
<span class="source-line-no">434</span><span id="line-434">                                                String featureName = line.substring(5, firstSpaceIndex);</span>
<span class="source-line-no">435</span><span id="line-435">                                                String value = line.substring(firstSpaceIndex).trim();</span>
<span class="source-line-no">436</span><span id="line-436">                                                handleConsensusAnnotation(featureName, value);</span>
<span class="source-line-no">437</span><span id="line-437">                                        } else if (line.startsWith(GENERIC_PER_SEQUENCE_ANNOTATION, 2)) {</span>
<span class="source-line-no">438</span><span id="line-438">                                                // #=GS &lt;seqname&gt; &lt;featurename&gt; &lt;generic per-sequence annotation, free text&gt;</span>
<span class="source-line-no">439</span><span id="line-439">                                                int index1 = line.indexOf(' ', 5);</span>
<span class="source-line-no">440</span><span id="line-440">                                                String seqName = line.substring(5, index1);</span>
<span class="source-line-no">441</span><span id="line-441">                                                while (line.charAt(++index1) &lt;= ' ')</span>
<span class="source-line-no">442</span><span id="line-442">                                                        // i.e. white space</span>
<span class="source-line-no">443</span><span id="line-443">                                                        ;// keep advancing</span>
<span class="source-line-no">444</span><span id="line-444">                                                int index2 = line.indexOf(' ', index1);</span>
<span class="source-line-no">445</span><span id="line-445">                                                String featureName = line.substring(index1, index2);</span>
<span class="source-line-no">446</span><span id="line-446">                                                String value = line.substring(index2).trim();</span>
<span class="source-line-no">447</span><span id="line-447">                                                handleSequenceAnnotation(seqName, featureName, value);</span>
<span class="source-line-no">448</span><span id="line-448">                                        } else if (line.startsWith(GENERIC_PER_RESIDUE_ANNOTATION, 2)) {</span>
<span class="source-line-no">449</span><span id="line-449">                                                // #=GR &lt;seqname&gt; &lt;featurename&gt; &lt;generic per-sequence AND per-column mark-up, exactly 1</span>
<span class="source-line-no">450</span><span id="line-450">                                                // character per column&gt;</span>
<span class="source-line-no">451</span><span id="line-451">                                                int index1 = line.indexOf(' ', 5);</span>
<span class="source-line-no">452</span><span id="line-452">                                                String seqName = line.substring(5, index1);</span>
<span class="source-line-no">453</span><span id="line-453">                                                while (line.charAt(++index1) == ' ')</span>
<span class="source-line-no">454</span><span id="line-454">                                                        ;// keep advancing</span>
<span class="source-line-no">455</span><span id="line-455">                                                int index2 = line.indexOf(' ', index1);</span>
<span class="source-line-no">456</span><span id="line-456">                                                String featureName = line.substring(index1, index2);</span>
<span class="source-line-no">457</span><span id="line-457">                                                String value = line.substring(index2).trim();</span>
<span class="source-line-no">458</span><span id="line-458">                                                handleResidueAnnotation(seqName, featureName, value);</span>
<span class="source-line-no">459</span><span id="line-459">                                        }</span>
<span class="source-line-no">460</span><span id="line-460">                                } else if (line.startsWith("# STOCKHOLM")) { // it is the header line</span>
<span class="source-line-no">461</span><span id="line-461">                                        // if (status == STATUS_OUTSIDE_FILE) {</span>
<span class="source-line-no">462</span><span id="line-462">                                        // status = STATUS_INSIDE_FILE;</span>
<span class="source-line-no">463</span><span id="line-463">                                        // String[] header = line.split("\\s+");</span>
<span class="source-line-no">464</span><span id="line-464">                                        // this.stockholmStructure = new StockholmStructure();</span>
<span class="source-line-no">465</span><span id="line-465">                                        // this.stockholmStructure.getFileAnnotation().setFormat(header[1]);</span>
<span class="source-line-no">466</span><span id="line-466">                                        // this.stockholmStructure.getFileAnnotation().setVersion(header[2]);</span>
<span class="source-line-no">467</span><span id="line-467">                                        // } else {</span>
<span class="source-line-no">468</span><span id="line-468">                                        // throw new ParserException("Uexpected Format line: [" + line + "]");</span>
<span class="source-line-no">469</span><span id="line-469">                                        // }</span>
<span class="source-line-no">470</span><span id="line-470">                                        String[] header = line.split("\\s+");</span>
<span class="source-line-no">471</span><span id="line-471">                                        this.stockholmStructure = new StockholmStructure();</span>
<span class="source-line-no">472</span><span id="line-472">                                        this.stockholmStructure.getFileAnnotation().setFormat(header[1]);</span>
<span class="source-line-no">473</span><span id="line-473">                                        this.stockholmStructure.getFileAnnotation().setVersion(header[2]);</span>
<span class="source-line-no">474</span><span id="line-474">                                } else if ("//".equals(line.trim())) {</span>
<span class="source-line-no">475</span><span id="line-475">                                        // status = STATUS_OUTSIDE_FILE;</span>
<span class="source-line-no">476</span><span id="line-476">                                        break;// should we just break immediately or jump next empty lines?</span>
<span class="source-line-no">477</span><span id="line-477">                                } else /* if (!line.startsWith("#")) */{</span>
<span class="source-line-no">478</span><span id="line-478">                                        // most probably This line corresponds to a sequence. Something like:</span>
<span class="source-line-no">479</span><span id="line-479">                                        // O83071/192-246 MTCRAQLIAVPRASSLAEAIACAQKMRVSRVPVYERS</span>
<span class="source-line-no">480</span><span id="line-480">                                        // N.B. as long as we don't check the status now, it is somehow error prone</span>
<span class="source-line-no">481</span><span id="line-481">                                        handleSequenceLine(line);</span>
<span class="source-line-no">482</span><span id="line-482">                                        // //============removed status==========================</span>
<span class="source-line-no">483</span><span id="line-483">                                        // if (status == STATUS_IN_SEQUENCE) {</span>
<span class="source-line-no">484</span><span id="line-484">                                        // // This line corresponds to a sequence. Something like:</span>
<span class="source-line-no">485</span><span id="line-485">                                        // // O83071/192-246 MTCRAQLIAVPRASSLAEAIACAQKMRVSRVPVYERS</span>
<span class="source-line-no">486</span><span id="line-486">                                        // handleSequenceLine(line);</span>
<span class="source-line-no">487</span><span id="line-487">                                        // // }else if (status==STATUS_OUTSIDE_FILE) {</span>
<span class="source-line-no">488</span><span id="line-488">                                        // // throw new</span>
<span class="source-line-no">489</span><span id="line-489">                                        // //</span>
<span class="source-line-no">490</span><span id="line-490">                                        // ParserException("The end of file character was allready reached but there are still sequence lines");</span>
<span class="source-line-no">491</span><span id="line-491">                                        // } else {</span>
<span class="source-line-no">492</span><span id="line-492">                                        // System.err.println("Error: Unknown or unexpected line [" + line</span>
<span class="source-line-no">493</span><span id="line-493">                                        // + "].\nPlease contact the Biojava team.");</span>
<span class="source-line-no">494</span><span id="line-494">                                        // throw new ParserException("Error: Unknown or unexpected line [" + line + "].");</span>
<span class="source-line-no">495</span><span id="line-495">                                        // }</span>
<span class="source-line-no">496</span><span id="line-496">                                        // //============removed status==========================</span>
<span class="source-line-no">497</span><span id="line-497">                                }</span>
<span class="source-line-no">498</span><span id="line-498">                                linesCount++;</span>
<span class="source-line-no">499</span><span id="line-499">                        }</span>
<span class="source-line-no">500</span><span id="line-500">                } catch (IOException e) {</span>
<span class="source-line-no">501</span><span id="line-501">                        // TODO: Best practice is to catch or throw Exception, never both</span>
<span class="source-line-no">502</span><span id="line-502">                        logger.error("IOException: ", e);</span>
<span class="source-line-no">503</span><span id="line-503">                        throw new IOException("Error parsing Stockholm file");</span>
<span class="source-line-no">504</span><span id="line-504">                }</span>
<span class="source-line-no">505</span><span id="line-505">                StockholmStructure structure = this.stockholmStructure;</span>
<span class="source-line-no">506</span><span id="line-506">                this.stockholmStructure = null;</span>
<span class="source-line-no">507</span><span id="line-507">                if (structure != null) {</span>
<span class="source-line-no">508</span><span id="line-508">                        int length = -1;</span>
<span class="source-line-no">509</span><span id="line-509">                        Map&lt;String, StringBuffer&gt; sequences = structure.getSequences();</span>
<span class="source-line-no">510</span><span id="line-510">                        for (String sequencename : sequences.keySet()) {</span>
<span class="source-line-no">511</span><span id="line-511">                                StringBuffer sequence = sequences.get(sequencename);</span>
<span class="source-line-no">512</span><span id="line-512">                                if (length == -1) {</span>
<span class="source-line-no">513</span><span id="line-513">                                        length = sequence.length();</span>
<span class="source-line-no">514</span><span id="line-514">                                } else if (length != sequence.length()) {</span>
<span class="source-line-no">515</span><span id="line-515">                                        throw new RuntimeException("Sequences have different lengths");</span>
<span class="source-line-no">516</span><span id="line-516">                                }</span>
<span class="source-line-no">517</span><span id="line-517">                        }</span>
<span class="source-line-no">518</span><span id="line-518">                }</span>
<span class="source-line-no">519</span><span id="line-519">                return structure;</span>
<span class="source-line-no">520</span><span id="line-520">        }</span>
<span class="source-line-no">521</span><span id="line-521"></span>
<span class="source-line-no">522</span><span id="line-522">        /**</span>
<span class="source-line-no">523</span><span id="line-523">         * Handles a line that corresponds to a sequence. &lt;br&gt;</span>
<span class="source-line-no">524</span><span id="line-524">         * e.g.: COATB_BPIKE/30-81 AEPNAATNYATEAMDSLKTQAIDLISQTWPVVTTVVVAGLVIRLFKKFSSKA&lt;br&gt;</span>
<span class="source-line-no">525</span><span id="line-525">         * N.B.: This function can't tolerate sequences with intrinsic white space.</span>
<span class="source-line-no">526</span><span id="line-526">         *</span>
<span class="source-line-no">527</span><span id="line-527">         * @param line</span>
<span class="source-line-no">528</span><span id="line-528">         *            the line to be parsed</span>
<span class="source-line-no">529</span><span id="line-529">         * @throws Exception</span>
<span class="source-line-no">530</span><span id="line-530">         */</span>
<span class="source-line-no">531</span><span id="line-531">        private void handleSequenceLine(String line) {</span>
<span class="source-line-no">532</span><span id="line-532">                String[] lineContent = line.split("\\s+");</span>
<span class="source-line-no">533</span><span id="line-533">                if (lineContent.length != 2) {</span>
<span class="source-line-no">534</span><span id="line-534">                        throw new ParserException("Could not split sequence line into sequence name and sequence:\n" + line);</span>
<span class="source-line-no">535</span><span id="line-535">                }</span>
<span class="source-line-no">536</span><span id="line-536">                stockholmStructure.appendToSequence(lineContent[0], lineContent[1]);</span>
<span class="source-line-no">537</span><span id="line-537">        }</span>
<span class="source-line-no">538</span><span id="line-538"></span>
<span class="source-line-no">539</span><span id="line-539">        /**</span>
<span class="source-line-no">540</span><span id="line-540">         * #=GF &amp;lt;feature&amp;gt; &amp;lt;Generic per-File annotation, free text&amp;gt;</span>
<span class="source-line-no">541</span><span id="line-541">         *</span>
<span class="source-line-no">542</span><span id="line-542">         * @param featureName</span>
<span class="source-line-no">543</span><span id="line-543">         * @param value</span>
<span class="source-line-no">544</span><span id="line-544">         *            the line to be parsed</span>
<span class="source-line-no">545</span><span id="line-545">         */</span>
<span class="source-line-no">546</span><span id="line-546">        private void handleFileAnnotation(String featureName, String value) {</span>
<span class="source-line-no">547</span><span id="line-547">                if (featureName.equals(GF_ACCESSION_NUMBER)) {</span>
<span class="source-line-no">548</span><span id="line-548">                        stockholmStructure.getFileAnnotation().setGFAccessionNumber(value);</span>
<span class="source-line-no">549</span><span id="line-549">                } else if (featureName.equals(GF_IDENTIFICATION)) {</span>
<span class="source-line-no">550</span><span id="line-550">                        stockholmStructure.getFileAnnotation().setGFIdentification(value);</span>
<span class="source-line-no">551</span><span id="line-551">                } else if (featureName.equals(GF_DB_REFERENCE)) {</span>
<span class="source-line-no">552</span><span id="line-552">                        stockholmStructure.getFileAnnotation().addDBReference(value);</span>
<span class="source-line-no">553</span><span id="line-553">                } else if (featureName.equals(GF_DEFINITION)) {</span>
<span class="source-line-no">554</span><span id="line-554">                        stockholmStructure.getFileAnnotation().setGFDefinition(value);</span>
<span class="source-line-no">555</span><span id="line-555">                } else if (featureName.equals(GF_AUTHOR)) {</span>
<span class="source-line-no">556</span><span id="line-556">                        stockholmStructure.getFileAnnotation().setGFAuthors(value);</span>
<span class="source-line-no">557</span><span id="line-557">                } else if (featureName.equals(GF_ALIGNMENT_METHOD)) {</span>
<span class="source-line-no">558</span><span id="line-558">                        stockholmStructure.getFileAnnotation().setAlignmentMethod(value);</span>
<span class="source-line-no">559</span><span id="line-559">                } else if (featureName.equals(GF_BUILD_METHOD)) {</span>
<span class="source-line-no">560</span><span id="line-560">                        stockholmStructure.getFileAnnotation().addGFBuildMethod(value);</span>
<span class="source-line-no">561</span><span id="line-561">                } else if (featureName.equals(GF_SEARCH_METHOD)) {</span>
<span class="source-line-no">562</span><span id="line-562">                        stockholmStructure.getFileAnnotation().setGFSearchMethod(value);</span>
<span class="source-line-no">563</span><span id="line-563">                } else if (featureName.equals(GF_SOURCE_SEED)) {</span>
<span class="source-line-no">564</span><span id="line-564">                        stockholmStructure.getFileAnnotation().setGFSourceSeed(value);</span>
<span class="source-line-no">565</span><span id="line-565">                } else if (featureName.equals(GF_SOURCE_STRUCTURE)) {</span>
<span class="source-line-no">566</span><span id="line-566">                        stockholmStructure.getFileAnnotation().setGFSourceStructure(value);</span>
<span class="source-line-no">567</span><span id="line-567">                } else if (featureName.equals(GF_GATHERING_THRESHOLD)) {</span>
<span class="source-line-no">568</span><span id="line-568">                        stockholmStructure.getFileAnnotation().setGFGatheringThreshs(value);</span>
<span class="source-line-no">569</span><span id="line-569">                } else if (featureName.equals(GF_TRUSTED_CUTOFF)) {</span>
<span class="source-line-no">570</span><span id="line-570">                        stockholmStructure.getFileAnnotation().setGFTrustedCutoffs(value);</span>
<span class="source-line-no">571</span><span id="line-571">                } else if (featureName.equals(GF_NOISE_CUTOFF)) {</span>
<span class="source-line-no">572</span><span id="line-572">                        stockholmStructure.getFileAnnotation().setGFNoiseCutoffs(value);</span>
<span class="source-line-no">573</span><span id="line-573">                } else if (featureName.equals(GF_TYPE_FIELD)) {</span>
<span class="source-line-no">574</span><span id="line-574">                        stockholmStructure.getFileAnnotation().setGFTypeField(value);</span>
<span class="source-line-no">575</span><span id="line-575">                } else if (featureName.equals(GF_PREVIOUS_IDS)) {</span>
<span class="source-line-no">576</span><span id="line-576">                        stockholmStructure.getFileAnnotation().setGFPreviousIDs(value);</span>
<span class="source-line-no">577</span><span id="line-577">                } else if (featureName.equals(GF_SEQUENCE)) {</span>
<span class="source-line-no">578</span><span id="line-578">                        // status = STATUS_IN_SEQUENCE;</span>
<span class="source-line-no">579</span><span id="line-579">                        stockholmStructure.getFileAnnotation().setGFNumSequences(value);</span>
<span class="source-line-no">580</span><span id="line-580">                } else if (featureName.equals(GF_DB_COMMENT)) {</span>
<span class="source-line-no">581</span><span id="line-581">                        stockholmStructure.getFileAnnotation().setGFDBComment(value);</span>
<span class="source-line-no">582</span><span id="line-582">                        // } else if (featureName.equals(GF_DB_REFERENCE)) {</span>
<span class="source-line-no">583</span><span id="line-583">                        // stockholmStructure.getFileAnnotation().addDBReference(value);</span>
<span class="source-line-no">584</span><span id="line-584">                } else if (featureName.equals(GF_REFERENCE_COMMENT)) {</span>
<span class="source-line-no">585</span><span id="line-585">                        stockholmStructure.getFileAnnotation().setGFRefComment(value);</span>
<span class="source-line-no">586</span><span id="line-586">                } else if (featureName.equals(GF_REFERENCE_NUMBER)) {</span>
<span class="source-line-no">587</span><span id="line-587">                        StockholmFileAnnotationReference reference = new StockholmFileAnnotationReference();</span>
<span class="source-line-no">588</span><span id="line-588">                        stockholmStructure.getFileAnnotation().getReferences().add(reference);</span>
<span class="source-line-no">589</span><span id="line-589">                } else if (featureName.equals(GF_REFERENCE_MEDLINE)) {</span>
<span class="source-line-no">590</span><span id="line-590">                        stockholmStructure.getFileAnnotation().getReferences().lastElement().setRefMedline(value);</span>
<span class="source-line-no">591</span><span id="line-591">                } else if (featureName.equals(GF_REFERENCE_TITLE)) {</span>
<span class="source-line-no">592</span><span id="line-592">                        stockholmStructure.getFileAnnotation().getReferences().lastElement().addToRefTitle(value);</span>
<span class="source-line-no">593</span><span id="line-593">                } else if (featureName.equals(GF_REFERENCE_AUTHOR)) {</span>
<span class="source-line-no">594</span><span id="line-594">                        stockholmStructure.getFileAnnotation().getReferences().lastElement().addToRefAuthor(value);</span>
<span class="source-line-no">595</span><span id="line-595">                } else if (featureName.equals(GF_REFERENCE_LOCALTION)) {</span>
<span class="source-line-no">596</span><span id="line-596">                        stockholmStructure.getFileAnnotation().getReferences().lastElement().setRefLocation(value);</span>
<span class="source-line-no">597</span><span id="line-597">                } else if (featureName.equals(GF_KEYWORDS)) {</span>
<span class="source-line-no">598</span><span id="line-598">                        stockholmStructure.getFileAnnotation().setGFKeywords(value);</span>
<span class="source-line-no">599</span><span id="line-599">                } else if (featureName.equals(GF_COMMENT)) {</span>
<span class="source-line-no">600</span><span id="line-600">                        stockholmStructure.getFileAnnotation().addToGFComment(value);</span>
<span class="source-line-no">601</span><span id="line-601">                } else if (featureName.equals(GF_PFAM_ACCESSION)) {</span>
<span class="source-line-no">602</span><span id="line-602">                        stockholmStructure.getFileAnnotation().setGFPfamAccession(value);</span>
<span class="source-line-no">603</span><span id="line-603">                } else if (featureName.equals(GF_LOCATION)) {</span>
<span class="source-line-no">604</span><span id="line-604">                        stockholmStructure.getFileAnnotation().setGFLocation(value);</span>
<span class="source-line-no">605</span><span id="line-605">                } else if (featureName.equals(GF_WIKIPEDIA_LINK)) {</span>
<span class="source-line-no">606</span><span id="line-606">                        stockholmStructure.getFileAnnotation().setGFWikipediaLink(value);</span>
<span class="source-line-no">607</span><span id="line-607">                } else if (featureName.equals(GF_CLAN)) {</span>
<span class="source-line-no">608</span><span id="line-608">                        stockholmStructure.getFileAnnotation().setGFClan(value);</span>
<span class="source-line-no">609</span><span id="line-609">                } else if (featureName.equals(GF_MEMBERSHIP)) {</span>
<span class="source-line-no">610</span><span id="line-610">                        stockholmStructure.getFileAnnotation().setGFMembership(value);</span>
<span class="source-line-no">611</span><span id="line-611">                } else if (featureName.equals(GF_NEW_HAMPSHIRE)) {</span>
<span class="source-line-no">612</span><span id="line-612">                        stockholmStructure.getFileAnnotation().addGFNewHampshire(value);</span>
<span class="source-line-no">613</span><span id="line-613">                } else if (featureName.equals(GF_TREE_ID)) {</span>
<span class="source-line-no">614</span><span id="line-614">                        stockholmStructure.getFileAnnotation().addGFTreeID(value);</span>
<span class="source-line-no">615</span><span id="line-615">                } else if (featureName.equals(GF_FALSE_DISCOVERY_RATE)) {</span>
<span class="source-line-no">616</span><span id="line-616">                        stockholmStructure.getFileAnnotation().addGFFalseDiscoveryRate(value);</span>
<span class="source-line-no">617</span><span id="line-617">                } else {</span>
<span class="source-line-no">618</span><span id="line-618">                        // unknown feature</span>
<span class="source-line-no">619</span><span id="line-619">                        logger.warn("Unknown File Feature [{}].\nPlease contact the Biojava team.", featureName);</span>
<span class="source-line-no">620</span><span id="line-620">                }</span>
<span class="source-line-no">621</span><span id="line-621">        }</span>
<span class="source-line-no">622</span><span id="line-622"></span>
<span class="source-line-no">623</span><span id="line-623">        /**</span>
<span class="source-line-no">624</span><span id="line-624">         * usually a single line of:&lt;br&gt;</span>
<span class="source-line-no">625</span><span id="line-625">         * #=GC &amp;lt;feature&amp;gt; &amp;lt;Generic per-Column annotation, exactly 1 char per column&amp;gt;</span>
<span class="source-line-no">626</span><span id="line-626">         *</span>
<span class="source-line-no">627</span><span id="line-627">         * @param featureName</span>
<span class="source-line-no">628</span><span id="line-628">         *            the feature name :)</span>
<span class="source-line-no">629</span><span id="line-629">         * @param value</span>
<span class="source-line-no">630</span><span id="line-630">         *            the line to be parsed.</span>
<span class="source-line-no">631</span><span id="line-631">         */</span>
<span class="source-line-no">632</span><span id="line-632">        private void handleConsensusAnnotation(String featureName, String value) {</span>
<span class="source-line-no">633</span><span id="line-633">                if (featureName.equals(GC_SECONDARY_STRUCTURE)) {</span>
<span class="source-line-no">634</span><span id="line-634">                        stockholmStructure.getConsAnnotation().setSecondaryStructure(value);</span>
<span class="source-line-no">635</span><span id="line-635">                } else if (featureName.equals(GC_SEQUENSE_CONSENSUS)) {</span>
<span class="source-line-no">636</span><span id="line-636">                        stockholmStructure.getConsAnnotation().setSequenceConsensus(value);</span>
<span class="source-line-no">637</span><span id="line-637">                } else if (featureName.equals(GC_SURFACE_ACCESSIBILITY)) {</span>
<span class="source-line-no">638</span><span id="line-638">                        stockholmStructure.getConsAnnotation().setSurfaceAccessibility(value);</span>
<span class="source-line-no">639</span><span id="line-639">                } else if (featureName.equals(GC_TRANS_MEMBRANE)) {</span>
<span class="source-line-no">640</span><span id="line-640">                        stockholmStructure.getConsAnnotation().setTransMembrane(value);</span>
<span class="source-line-no">641</span><span id="line-641">                } else if (featureName.equals(GC_POSTERIOR_PROBABILITY)) {</span>
<span class="source-line-no">642</span><span id="line-642">                        stockholmStructure.getConsAnnotation().setPosteriorProbability(value);</span>
<span class="source-line-no">643</span><span id="line-643">                } else if (featureName.equals(GC_LIGAND_BINDING)) {</span>
<span class="source-line-no">644</span><span id="line-644">                        stockholmStructure.getConsAnnotation().setLigandBinding(value);</span>
<span class="source-line-no">645</span><span id="line-645">                } else if (featureName.equals(GC_ACTIVE_SITE)) {</span>
<span class="source-line-no">646</span><span id="line-646">                        stockholmStructure.getConsAnnotation().setActiveSite(value);</span>
<span class="source-line-no">647</span><span id="line-647">                } else if (featureName.equals(GC_AS_PFAM_PREDICTED)) {</span>
<span class="source-line-no">648</span><span id="line-648">                        stockholmStructure.getConsAnnotation().setAsPFamPredicted(value);</span>
<span class="source-line-no">649</span><span id="line-649">                } else if (featureName.equals(GC_AS_SWISSPROT)) {</span>
<span class="source-line-no">650</span><span id="line-650">                        stockholmStructure.getConsAnnotation().setAsSwissProt(value);</span>
<span class="source-line-no">651</span><span id="line-651">                } else if (featureName.equals(GC_INTRON)) {</span>
<span class="source-line-no">652</span><span id="line-652">                        stockholmStructure.getConsAnnotation().setIntron(value);</span>
<span class="source-line-no">653</span><span id="line-653">                } else if (featureName.equals(GC_REFERENCE_ANNOTATION)) {</span>
<span class="source-line-no">654</span><span id="line-654">                        stockholmStructure.getConsAnnotation().setReferenceAnnotation(value);</span>
<span class="source-line-no">655</span><span id="line-655">                } else if (featureName.equals(GC_MODEL_MASK)) {</span>
<span class="source-line-no">656</span><span id="line-656">                        stockholmStructure.getConsAnnotation().setModelMask(value);</span>
<span class="source-line-no">657</span><span id="line-657">                } else {</span>
<span class="source-line-no">658</span><span id="line-658">                        // unknown feature</span>
<span class="source-line-no">659</span><span id="line-659">                        logger.warn("Unknown Consensus Feature [{}].\nPlease contact the Biojava team.", featureName);</span>
<span class="source-line-no">660</span><span id="line-660">                }</span>
<span class="source-line-no">661</span><span id="line-661">        }</span>
<span class="source-line-no">662</span><span id="line-662"></span>
<span class="source-line-no">663</span><span id="line-663">        /**</span>
<span class="source-line-no">664</span><span id="line-664">         * #=GS &amp;lt;seqname&amp;gt; &amp;lt;feature&amp;gt; &amp;lt;Generic per-Sequence annotation, free text&amp;gt;</span>
<span class="source-line-no">665</span><span id="line-665">         *</span>
<span class="source-line-no">666</span><span id="line-666">         * @param line</span>
<span class="source-line-no">667</span><span id="line-667">         *            the line to be parsed</span>
<span class="source-line-no">668</span><span id="line-668">         */</span>
<span class="source-line-no">669</span><span id="line-669">        private void handleSequenceAnnotation(String seqName, String featureName, String value) {</span>
<span class="source-line-no">670</span><span id="line-670">                if (featureName.equals(GS_ACCESSION_NUMBER)) {</span>
<span class="source-line-no">671</span><span id="line-671">                        stockholmStructure.addGSAccessionNumber(seqName, value);</span>
<span class="source-line-no">672</span><span id="line-672">                } else if (featureName.equals(GS_DESCRIPTION)) {</span>
<span class="source-line-no">673</span><span id="line-673">                        stockholmStructure.addGSDescription(seqName, value);</span>
<span class="source-line-no">674</span><span id="line-674">                } else if (featureName.equals(GS_DATABASE_REFERENCE)) {</span>
<span class="source-line-no">675</span><span id="line-675">                        stockholmStructure.addGSdbReference(seqName, value);</span>
<span class="source-line-no">676</span><span id="line-676">                } else if (featureName.equals(GS_ORGANISM_SPECIES)) {</span>
<span class="source-line-no">677</span><span id="line-677">                        stockholmStructure.addGSOrganismSpecies(seqName, value);</span>
<span class="source-line-no">678</span><span id="line-678">                } else if (featureName.equals(GS_ORGANISM_CLASSIFICATION)) {</span>
<span class="source-line-no">679</span><span id="line-679">                        stockholmStructure.addGSOrganismClassification(seqName, value);</span>
<span class="source-line-no">680</span><span id="line-680">                } else if (featureName.equals(GS_LOOK)) {</span>
<span class="source-line-no">681</span><span id="line-681">                        stockholmStructure.addGSLook(seqName, value);</span>
<span class="source-line-no">682</span><span id="line-682">                } else {</span>
<span class="source-line-no">683</span><span id="line-683">                        // unknown feature</span>
<span class="source-line-no">684</span><span id="line-684">                        logger.warn("Unknown Sequence Feature [{}].\nPlease contact the Biojava team.", featureName);</span>
<span class="source-line-no">685</span><span id="line-685">                }</span>
<span class="source-line-no">686</span><span id="line-686">        }</span>
<span class="source-line-no">687</span><span id="line-687"></span>
<span class="source-line-no">688</span><span id="line-688">        /**</span>
<span class="source-line-no">689</span><span id="line-689">         * #=GR &amp;lt;seqname&amp;gt; &amp;lt;feature&amp;gt; &amp;lt;Generic per-Residue annotation, exactly 1 char per residue&amp;gt;</span>
<span class="source-line-no">690</span><span id="line-690">         *</span>
<span class="source-line-no">691</span><span id="line-691">         * @param line</span>
<span class="source-line-no">692</span><span id="line-692">         *            the line to be parsed</span>
<span class="source-line-no">693</span><span id="line-693">         */</span>
<span class="source-line-no">694</span><span id="line-694">        private void handleResidueAnnotation(String seqName, String featureName, String value) {</span>
<span class="source-line-no">695</span><span id="line-695"></span>
<span class="source-line-no">696</span><span id="line-696">                if (featureName.equals(GR_SURFACE_ACCESSIBILITY)) {</span>
<span class="source-line-no">697</span><span id="line-697">                        stockholmStructure.addSurfaceAccessibility(seqName, value);</span>
<span class="source-line-no">698</span><span id="line-698">                } else if (featureName.equals(GR_TRANS_MEMBRANE)) {</span>
<span class="source-line-no">699</span><span id="line-699">                        stockholmStructure.addTransMembrane(seqName, value);</span>
<span class="source-line-no">700</span><span id="line-700">                } else if (featureName.equals(GR_POSTERIOR_PROBABILITY)) {</span>
<span class="source-line-no">701</span><span id="line-701">                        stockholmStructure.addPosteriorProbability(seqName, value);</span>
<span class="source-line-no">702</span><span id="line-702">                } else if (featureName.equals(GR_LIGAND_BINDING)) {</span>
<span class="source-line-no">703</span><span id="line-703">                        stockholmStructure.addLigandBinding(seqName, value);</span>
<span class="source-line-no">704</span><span id="line-704">                } else if (featureName.equals(GR_ACTIVE_SITE)) {</span>
<span class="source-line-no">705</span><span id="line-705">                        stockholmStructure.addActiveSite(seqName, value);</span>
<span class="source-line-no">706</span><span id="line-706">                } else if (featureName.equals(GR_AS_PFAM_PREDICTED)) {</span>
<span class="source-line-no">707</span><span id="line-707">                        stockholmStructure.addASPFamPredicted(seqName, value);</span>
<span class="source-line-no">708</span><span id="line-708">                } else if (featureName.equals(GR_AS_SWISSPROT)) {</span>
<span class="source-line-no">709</span><span id="line-709">                        stockholmStructure.addASSwissProt(seqName, value);</span>
<span class="source-line-no">710</span><span id="line-710">                } else if (featureName.equals(GR_INTRON)) {</span>
<span class="source-line-no">711</span><span id="line-711">                        stockholmStructure.addIntron(seqName, value);</span>
<span class="source-line-no">712</span><span id="line-712">                } else if (featureName.equals(GR_SECONDARY_STRUCTURE)) {</span>
<span class="source-line-no">713</span><span id="line-713">                        stockholmStructure.addSecondaryStructure(seqName, value);</span>
<span class="source-line-no">714</span><span id="line-714">                } else {</span>
<span class="source-line-no">715</span><span id="line-715">                        // unknown feature</span>
<span class="source-line-no">716</span><span id="line-716">                        logger.warn("Unknown Residue Feature [{}].\nPlease contact the Biojava team.", featureName);</span>
<span class="source-line-no">717</span><span id="line-717">                }</span>
<span class="source-line-no">718</span><span id="line-718">        }</span>
<span class="source-line-no">719</span><span id="line-719">}</span>




























































</pre>
</div>
</main>
</body>
</html>
