<!DOCTYPE HTML>
<html lang>
<head>
<!-- Generated by javadoc (21) -->
<title>Source code</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="source: package: org.biojava.nbio.structure.align.ce, class: CeParameters, enum: ScoringStrategy">
<meta name="generator" content="javadoc/SourceToHTMLConverter">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
</head>
<body class="source-page">
<main role="main">
<div class="source-container">
<pre><span class="source-line-no">001</span><span id="line-1">/*</span>
<span class="source-line-no">002</span><span id="line-2"> *                    BioJava development code</span>
<span class="source-line-no">003</span><span id="line-3"> *</span>
<span class="source-line-no">004</span><span id="line-4"> * This code may be freely distributed and modified under the</span>
<span class="source-line-no">005</span><span id="line-5"> * terms of the GNU Lesser General Public Licence.  This should</span>
<span class="source-line-no">006</span><span id="line-6"> * be distributed with the code.  If you do not have a copy,</span>
<span class="source-line-no">007</span><span id="line-7"> * see:</span>
<span class="source-line-no">008</span><span id="line-8"> *</span>
<span class="source-line-no">009</span><span id="line-9"> *      http://www.gnu.org/copyleft/lesser.html</span>
<span class="source-line-no">010</span><span id="line-10"> *</span>
<span class="source-line-no">011</span><span id="line-11"> * Copyright for this code is held jointly by the individual</span>
<span class="source-line-no">012</span><span id="line-12"> * authors.  These should be listed in @author doc comments.</span>
<span class="source-line-no">013</span><span id="line-13"> *</span>
<span class="source-line-no">014</span><span id="line-14"> * For more information on the BioJava project and its aims,</span>
<span class="source-line-no">015</span><span id="line-15"> * or to join the biojava-l mailing list, visit the home page</span>
<span class="source-line-no">016</span><span id="line-16"> * at:</span>
<span class="source-line-no">017</span><span id="line-17"> *</span>
<span class="source-line-no">018</span><span id="line-18"> *      http://www.biojava.org/</span>
<span class="source-line-no">019</span><span id="line-19"> *</span>
<span class="source-line-no">020</span><span id="line-20"> * Created on Sep 15, 2009</span>
<span class="source-line-no">021</span><span id="line-21"> * Author: Andreas Prlic</span>
<span class="source-line-no">022</span><span id="line-22"> *</span>
<span class="source-line-no">023</span><span id="line-23"> */</span>
<span class="source-line-no">024</span><span id="line-24"></span>
<span class="source-line-no">025</span><span id="line-25">package org.biojava.nbio.structure.align.ce;</span>
<span class="source-line-no">026</span><span id="line-26"></span>
<span class="source-line-no">027</span><span id="line-27">import org.biojava.nbio.core.alignment.matrices.SubstitutionMatrixHelper;</span>
<span class="source-line-no">028</span><span id="line-28">import org.biojava.nbio.core.alignment.template.SubstitutionMatrix;</span>
<span class="source-line-no">029</span><span id="line-29">import org.biojava.nbio.structure.align.util.CliTools;</span>
<span class="source-line-no">030</span><span id="line-30">import org.biojava.nbio.core.sequence.compound.AminoAcidCompound;</span>
<span class="source-line-no">031</span><span id="line-31"></span>
<span class="source-line-no">032</span><span id="line-32">import java.util.ArrayList;</span>
<span class="source-line-no">033</span><span id="line-33">import java.util.List;</span>
<span class="source-line-no">034</span><span id="line-34"></span>
<span class="source-line-no">035</span><span id="line-35"></span>
<span class="source-line-no">036</span><span id="line-36">/**</span>
<span class="source-line-no">037</span><span id="line-37"> * Contains the parameters that can be sent to CE</span>
<span class="source-line-no">038</span><span id="line-38"> *</span>
<span class="source-line-no">039</span><span id="line-39"> * @author Andreas Prlic</span>
<span class="source-line-no">040</span><span id="line-40"> *</span>
<span class="source-line-no">041</span><span id="line-41"> */</span>
<span class="source-line-no">042</span><span id="line-42">public class CeParameters implements ConfigStrucAligParams  {</span>
<span class="source-line-no">043</span><span id="line-43"></span>
<span class="source-line-no">044</span><span id="line-44">        protected int winSize;</span>
<span class="source-line-no">045</span><span id="line-45">        protected double rmsdThr;</span>
<span class="source-line-no">046</span><span id="line-46">        protected double rmsdThrJoin;</span>
<span class="source-line-no">047</span><span id="line-47">        protected double maxOptRMSD;</span>
<span class="source-line-no">048</span><span id="line-48"></span>
<span class="source-line-no">049</span><span id="line-49">        public static enum ScoringStrategy {</span>
<span class="source-line-no">050</span><span id="line-50">                CA_SCORING("CA only"),</span>
<span class="source-line-no">051</span><span id="line-51">                SIDE_CHAIN_SCORING("Sidechain orientation"),</span>
<span class="source-line-no">052</span><span id="line-52">                SIDE_CHAIN_ANGLE_SCORING("Angle between sidechains"),</span>
<span class="source-line-no">053</span><span id="line-53">                CA_AND_SIDE_CHAIN_ANGLE_SCORING("CA distance+Angle between sidechains"),</span>
<span class="source-line-no">054</span><span id="line-54">                SEQUENCE_CONSERVATION("Sequence Conservation");</span>
<span class="source-line-no">055</span><span id="line-55">                public static ScoringStrategy DEFAULT_SCORING_STRATEGY = CA_SCORING;</span>
<span class="source-line-no">056</span><span id="line-56"></span>
<span class="source-line-no">057</span><span id="line-57">                private String name;</span>
<span class="source-line-no">058</span><span id="line-58">                private ScoringStrategy(String name) {</span>
<span class="source-line-no">059</span><span id="line-59">                        this.name = name;</span>
<span class="source-line-no">060</span><span id="line-60">                }</span>
<span class="source-line-no">061</span><span id="line-61">                @Override</span>
<span class="source-line-no">062</span><span id="line-62">                public String toString() {</span>
<span class="source-line-no">063</span><span id="line-63">                        return name;</span>
<span class="source-line-no">064</span><span id="line-64">                }</span>
<span class="source-line-no">065</span><span id="line-65">        }</span>
<span class="source-line-no">066</span><span id="line-66"></span>
<span class="source-line-no">067</span><span id="line-67">        protected ScoringStrategy scoringStrategy;</span>
<span class="source-line-no">068</span><span id="line-68">        //String[] alignmentAtoms;</span>
<span class="source-line-no">069</span><span id="line-69">        protected int maxGapSize;</span>
<span class="source-line-no">070</span><span id="line-70"></span>
<span class="source-line-no">071</span><span id="line-71">        protected boolean showAFPRanges;</span>
<span class="source-line-no">072</span><span id="line-72">        protected int  sideChainScoringType;</span>
<span class="source-line-no">073</span><span id="line-73"></span>
<span class="source-line-no">074</span><span id="line-74">        /**</span>
<span class="source-line-no">075</span><span id="line-75">         * Whether the CE algorithm should extend the best found trace with dynamic programming,</span>
<span class="source-line-no">076</span><span id="line-76">         * while keeping RMSD at about the same level. (Shindyalov and Bourne, 1998)</span>
<span class="source-line-no">077</span><span id="line-77">         * This is useful for edge cases with remote homology, but can be slow for large structures.</span>
<span class="source-line-no">078</span><span id="line-78">         */</span>
<span class="source-line-no">079</span><span id="line-79">        private boolean optimizeAlignment;</span>
<span class="source-line-no">080</span><span id="line-80"></span>
<span class="source-line-no">081</span><span id="line-81">        protected static final double DEFAULT_GAP_OPEN = 5.0;</span>
<span class="source-line-no">082</span><span id="line-82">        protected static final double DEFAULT_GAP_EXTENSION = 0.5;</span>
<span class="source-line-no">083</span><span id="line-83">        protected static final double DISTANCE_INCREMENT = 0.5;</span>
<span class="source-line-no">084</span><span id="line-84">        protected static final double DEFAULT_oRmsdThr = 2.0;</span>
<span class="source-line-no">085</span><span id="line-85">        protected static final String DEFAULT_SUBSTITUTION_MATRIX = "PRLA000101";</span>
<span class="source-line-no">086</span><span id="line-86"></span>
<span class="source-line-no">087</span><span id="line-87">        protected double gapOpen;</span>
<span class="source-line-no">088</span><span id="line-88">        protected double gapExtension;</span>
<span class="source-line-no">089</span><span id="line-89">        protected double distanceIncrement;</span>
<span class="source-line-no">090</span><span id="line-90">        protected double oRmsdThr;</span>
<span class="source-line-no">091</span><span id="line-91"></span>
<span class="source-line-no">092</span><span id="line-92">        protected int maxNrIterationsForOptimization;</span>
<span class="source-line-no">093</span><span id="line-93"></span>
<span class="source-line-no">094</span><span id="line-94">        protected SubstitutionMatrix&lt;AminoAcidCompound&gt; substitutionMatrix;</span>
<span class="source-line-no">095</span><span id="line-95">        protected double seqWeight;</span>
<span class="source-line-no">096</span><span id="line-96"></span>
<span class="source-line-no">097</span><span id="line-97">        public CeParameters(){</span>
<span class="source-line-no">098</span><span id="line-98">                reset();</span>
<span class="source-line-no">099</span><span id="line-99">        }</span>
<span class="source-line-no">100</span><span id="line-100"></span>
<span class="source-line-no">101</span><span id="line-101">        @Override</span>
<span class="source-line-no">102</span><span id="line-102">        public String toString() {</span>
<span class="source-line-no">103</span><span id="line-103">                return "CeParameters [scoringStrategy=" + scoringStrategy</span>
<span class="source-line-no">104</span><span id="line-104">                + ", maxGapSize=" + maxGapSize</span>
<span class="source-line-no">105</span><span id="line-105">                + ", rmsdThr=" + rmsdThr</span>
<span class="source-line-no">106</span><span id="line-106">                + ", rmsdThrJoin="+ rmsdThrJoin</span>
<span class="source-line-no">107</span><span id="line-107">                + ", winSize=" + winSize</span>
<span class="source-line-no">108</span><span id="line-108">                + ", showAFPRanges=" + showAFPRanges</span>
<span class="source-line-no">109</span><span id="line-109">                + ", maxOptRMSD=" + maxOptRMSD</span>
<span class="source-line-no">110</span><span id="line-110">                + ", seqWeight=" + seqWeight</span>
<span class="source-line-no">111</span><span id="line-111">                + "]";</span>
<span class="source-line-no">112</span><span id="line-112">        }</span>
<span class="source-line-no">113</span><span id="line-113"></span>
<span class="source-line-no">114</span><span id="line-114"></span>
<span class="source-line-no">115</span><span id="line-115">        @Override</span>
<span class="source-line-no">116</span><span id="line-116">        public void reset(){</span>
<span class="source-line-no">117</span><span id="line-117">                winSize = 8;</span>
<span class="source-line-no">118</span><span id="line-118">                rmsdThr = 3.0;</span>
<span class="source-line-no">119</span><span id="line-119">                rmsdThrJoin = 4.0;</span>
<span class="source-line-no">120</span><span id="line-120">                scoringStrategy = ScoringStrategy.DEFAULT_SCORING_STRATEGY;</span>
<span class="source-line-no">121</span><span id="line-121">                maxGapSize = 30;</span>
<span class="source-line-no">122</span><span id="line-122">                showAFPRanges = false;</span>
<span class="source-line-no">123</span><span id="line-123">                maxOptRMSD = 99;</span>
<span class="source-line-no">124</span><span id="line-124"></span>
<span class="source-line-no">125</span><span id="line-125">                gapOpen = DEFAULT_GAP_OPEN;</span>
<span class="source-line-no">126</span><span id="line-126">                gapExtension = DEFAULT_GAP_EXTENSION;</span>
<span class="source-line-no">127</span><span id="line-127">                distanceIncrement = DISTANCE_INCREMENT;</span>
<span class="source-line-no">128</span><span id="line-128">                oRmsdThr = DEFAULT_oRmsdThr;</span>
<span class="source-line-no">129</span><span id="line-129"></span>
<span class="source-line-no">130</span><span id="line-130">                maxNrIterationsForOptimization = Integer.MAX_VALUE;</span>
<span class="source-line-no">131</span><span id="line-131">                seqWeight = 0;</span>
<span class="source-line-no">132</span><span id="line-132">                optimizeAlignment = true;</span>
<span class="source-line-no">133</span><span id="line-133">        }</span>
<span class="source-line-no">134</span><span id="line-134"></span>
<span class="source-line-no">135</span><span id="line-135">        /** The window size to look at</span>
<span class="source-line-no">136</span><span id="line-136">         *</span>
<span class="source-line-no">137</span><span id="line-137">         * @return window size</span>
<span class="source-line-no">138</span><span id="line-138">         */</span>
<span class="source-line-no">139</span><span id="line-139">        public Integer getWinSize() {</span>
<span class="source-line-no">140</span><span id="line-140">                return winSize;</span>
<span class="source-line-no">141</span><span id="line-141">        }</span>
<span class="source-line-no">142</span><span id="line-142">        public void setWinSize(Integer winSize) {</span>
<span class="source-line-no">143</span><span id="line-143">                this.winSize = winSize;</span>
<span class="source-line-no">144</span><span id="line-144">        }</span>
<span class="source-line-no">145</span><span id="line-145"></span>
<span class="source-line-no">146</span><span id="line-146">        /** RMSD Threshold</span>
<span class="source-line-no">147</span><span id="line-147">         *</span>
<span class="source-line-no">148</span><span id="line-148">         * @return RMSD threshold</span>
<span class="source-line-no">149</span><span id="line-149">         */</span>
<span class="source-line-no">150</span><span id="line-150">        public Double getRmsdThr() {</span>
<span class="source-line-no">151</span><span id="line-151">                return rmsdThr;</span>
<span class="source-line-no">152</span><span id="line-152">        }</span>
<span class="source-line-no">153</span><span id="line-153">        public void setRmsdThr(Double rmsdThr) {</span>
<span class="source-line-no">154</span><span id="line-154">                this.rmsdThr = rmsdThr;</span>
<span class="source-line-no">155</span><span id="line-155">        }</span>
<span class="source-line-no">156</span><span id="line-156"></span>
<span class="source-line-no">157</span><span id="line-157">        /** RMSD threshold for joining of AFPs</span>
<span class="source-line-no">158</span><span id="line-158">         *</span>
<span class="source-line-no">159</span><span id="line-159">         * @return rmsd threshold</span>
<span class="source-line-no">160</span><span id="line-160">         */</span>
<span class="source-line-no">161</span><span id="line-161">        public Double getRmsdThrJoin() {</span>
<span class="source-line-no">162</span><span id="line-162">                return rmsdThrJoin;</span>
<span class="source-line-no">163</span><span id="line-163">        }</span>
<span class="source-line-no">164</span><span id="line-164">        public void setRmsdThrJoin(Double rmsdThrJoin) {</span>
<span class="source-line-no">165</span><span id="line-165">                this.rmsdThrJoin = rmsdThrJoin;</span>
<span class="source-line-no">166</span><span id="line-166">        }</span>
<span class="source-line-no">167</span><span id="line-167"></span>
<span class="source-line-no">168</span><span id="line-168">        public ScoringStrategy getScoringStrategy()</span>
<span class="source-line-no">169</span><span id="line-169">        {</span>
<span class="source-line-no">170</span><span id="line-170">                return scoringStrategy;</span>
<span class="source-line-no">171</span><span id="line-171">        }</span>
<span class="source-line-no">172</span><span id="line-172"></span>
<span class="source-line-no">173</span><span id="line-173"></span>
<span class="source-line-no">174</span><span id="line-174">        /** Set the scoring strategy to use. 0 is default CE scoring scheme. 1 uses</span>
<span class="source-line-no">175</span><span id="line-175">         * Side chain orientation.</span>
<span class="source-line-no">176</span><span id="line-176">         *</span>
<span class="source-line-no">177</span><span id="line-177">         * @param scoringStrategy</span>
<span class="source-line-no">178</span><span id="line-178">         */</span>
<span class="source-line-no">179</span><span id="line-179">        public void setScoringStrategy(ScoringStrategy scoringStrategy)</span>
<span class="source-line-no">180</span><span id="line-180">        {</span>
<span class="source-line-no">181</span><span id="line-181">                this.scoringStrategy = scoringStrategy;</span>
<span class="source-line-no">182</span><span id="line-182">        }</span>
<span class="source-line-no">183</span><span id="line-183"></span>
<span class="source-line-no">184</span><span id="line-184"></span>
<span class="source-line-no">185</span><span id="line-185"></span>
<span class="source-line-no">186</span><span id="line-186">        /** Set the Max gap size parameter. Default 30. For unlimited gaps set to -1</span>
<span class="source-line-no">187</span><span id="line-187">         *</span>
<span class="source-line-no">188</span><span id="line-188">         * @param maxGapSize</span>
<span class="source-line-no">189</span><span id="line-189">         */</span>
<span class="source-line-no">190</span><span id="line-190">        public void setMaxGapSize(Integer maxGapSize){</span>
<span class="source-line-no">191</span><span id="line-191">                this.maxGapSize = maxGapSize;</span>
<span class="source-line-no">192</span><span id="line-192">        }</span>
<span class="source-line-no">193</span><span id="line-193"></span>
<span class="source-line-no">194</span><span id="line-194">        /** the Max gap size parameter G . default is 30, which was</span>
<span class="source-line-no">195</span><span id="line-195">         * described to obtained empirically in the CE paper.</span>
<span class="source-line-no">196</span><span id="line-196">         * the larger the max gap size, the longer the compute time,</span>
<span class="source-line-no">197</span><span id="line-197">         * but in same cases drastically improved results. Set to -1 for unlimited gap size.</span>
<span class="source-line-no">198</span><span id="line-198">         *</span>
<span class="source-line-no">199</span><span id="line-199">         * @return max gap size parameter</span>
<span class="source-line-no">200</span><span id="line-200">         */</span>
<span class="source-line-no">201</span><span id="line-201">        public Integer getMaxGapSize() {</span>
<span class="source-line-no">202</span><span id="line-202">                return maxGapSize;</span>
<span class="source-line-no">203</span><span id="line-203">        }</span>
<span class="source-line-no">204</span><span id="line-204"></span>
<span class="source-line-no">205</span><span id="line-205"></span>
<span class="source-line-no">206</span><span id="line-206">        @Override</span>
<span class="source-line-no">207</span><span id="line-207">        public List&lt;String&gt; getUserConfigHelp() {</span>
<span class="source-line-no">208</span><span id="line-208">                List&lt;String&gt; params =new ArrayList&lt;&gt;();</span>
<span class="source-line-no">209</span><span id="line-209">                String helpMaxGap = "This parameter configures the maximum gap size G, that is applied during the AFP extension. The larger the value, the longer the calculation time can become, Default value is 30. Set to 0 for no limit. " ;</span>
<span class="source-line-no">210</span><span id="line-210">                //String helpRmsdThr = "This configures the RMSD threshold applied during the trace of the fragment matrix.";</span>
<span class="source-line-no">211</span><span id="line-211">                String helpWinSize = "This configures the fragment size m of Aligned Fragment Pairs (AFPs).";</span>
<span class="source-line-no">212</span><span id="line-212"></span>
<span class="source-line-no">213</span><span id="line-213">                params.add(helpMaxGap);</span>
<span class="source-line-no">214</span><span id="line-214">                //params.add(helpRmsdThr);</span>
<span class="source-line-no">215</span><span id="line-215">                params.add(helpWinSize);</span>
<span class="source-line-no">216</span><span id="line-216">                params.add("Which scoring function to use: "+CliTools.getEnumValuesAsString(ScoringStrategy.class) );</span>
<span class="source-line-no">217</span><span id="line-217">                params.add("The maximum RMSD at which to stop alignment optimization. (default: unlimited=99)");</span>
<span class="source-line-no">218</span><span id="line-218">                params.add("Gap opening penalty during alignment optimization [default: "+DEFAULT_GAP_OPEN+"].");</span>
<span class="source-line-no">219</span><span id="line-219">                params.add("Gap extension penalty during alignment optimization [default: "+DEFAULT_GAP_EXTENSION+"].");</span>
<span class="source-line-no">220</span><span id="line-220">                return params;</span>
<span class="source-line-no">221</span><span id="line-221">        }</span>
<span class="source-line-no">222</span><span id="line-222"></span>
<span class="source-line-no">223</span><span id="line-223">        @Override</span>
<span class="source-line-no">224</span><span id="line-224">        public List&lt;String&gt; getUserConfigParameters() {</span>
<span class="source-line-no">225</span><span id="line-225">                List&lt;String&gt; params = new ArrayList&lt;&gt;();</span>
<span class="source-line-no">226</span><span id="line-226">                params.add("MaxGapSize");</span>
<span class="source-line-no">227</span><span id="line-227">                //params.add("RmsdThr");</span>
<span class="source-line-no">228</span><span id="line-228">                params.add("WinSize");</span>
<span class="source-line-no">229</span><span id="line-229">                params.add("ScoringStrategy");</span>
<span class="source-line-no">230</span><span id="line-230">                params.add("MaxOptRMSD");</span>
<span class="source-line-no">231</span><span id="line-231">                params.add("GapOpen");</span>
<span class="source-line-no">232</span><span id="line-232">                params.add("GapExtension");</span>
<span class="source-line-no">233</span><span id="line-233"></span>
<span class="source-line-no">234</span><span id="line-234">                return params;</span>
<span class="source-line-no">235</span><span id="line-235">        }</span>
<span class="source-line-no">236</span><span id="line-236"></span>
<span class="source-line-no">237</span><span id="line-237">        @Override</span>
<span class="source-line-no">238</span><span id="line-238">        public List&lt;String&gt; getUserConfigParameterNames(){</span>
<span class="source-line-no">239</span><span id="line-239">                List&lt;String&gt; params = new ArrayList&lt;&gt;();</span>
<span class="source-line-no">240</span><span id="line-240">                params.add("max. gap size G (during AFP extension).");</span>
<span class="source-line-no">241</span><span id="line-241">                //params.add("RMSD threshold during trace of the fragment matrix.");</span>
<span class="source-line-no">242</span><span id="line-242">                params.add("fragment size m");</span>
<span class="source-line-no">243</span><span id="line-243">                params.add("Which scoring function to use");</span>
<span class="source-line-no">244</span><span id="line-244">                params.add("RMSD threshold for alignment.");</span>
<span class="source-line-no">245</span><span id="line-245">                params.add("Gap open");</span>
<span class="source-line-no">246</span><span id="line-246">                params.add("Gap extension");</span>
<span class="source-line-no">247</span><span id="line-247">                return params;</span>
<span class="source-line-no">248</span><span id="line-248">        }</span>
<span class="source-line-no">249</span><span id="line-249"></span>
<span class="source-line-no">250</span><span id="line-250">        @Override</span>
<span class="source-line-no">251</span><span id="line-251">        @SuppressWarnings("rawtypes")</span>
<span class="source-line-no">252</span><span id="line-252">        public List&lt;Class&gt; getUserConfigTypes() {</span>
<span class="source-line-no">253</span><span id="line-253">                List&lt;Class&gt; params = new ArrayList&lt;&gt;();</span>
<span class="source-line-no">254</span><span id="line-254">                params.add(Integer.class);</span>
<span class="source-line-no">255</span><span id="line-255">                //params.add(Double.class);</span>
<span class="source-line-no">256</span><span id="line-256">                params.add(Integer.class);</span>
<span class="source-line-no">257</span><span id="line-257">                params.add(ScoringStrategy.class);</span>
<span class="source-line-no">258</span><span id="line-258">                params.add(Double.class);</span>
<span class="source-line-no">259</span><span id="line-259">                params.add(Double.class);</span>
<span class="source-line-no">260</span><span id="line-260">                params.add(Double.class);</span>
<span class="source-line-no">261</span><span id="line-261">                return params;</span>
<span class="source-line-no">262</span><span id="line-262">        }</span>
<span class="source-line-no">263</span><span id="line-263"></span>
<span class="source-line-no">264</span><span id="line-264"></span>
<span class="source-line-no">265</span><span id="line-265"></span>
<span class="source-line-no">266</span><span id="line-266">        /**</span>
<span class="source-line-no">267</span><span id="line-267">         * @return whether information about AFPs should be printed</span>
<span class="source-line-no">268</span><span id="line-268">         */</span>
<span class="source-line-no">269</span><span id="line-269">        public boolean isShowAFPRanges()</span>
<span class="source-line-no">270</span><span id="line-270">        {</span>
<span class="source-line-no">271</span><span id="line-271">                return showAFPRanges;</span>
<span class="source-line-no">272</span><span id="line-272">        }</span>
<span class="source-line-no">273</span><span id="line-273">        public void setShowAFPRanges(boolean showAFPRanges)</span>
<span class="source-line-no">274</span><span id="line-274">        {</span>
<span class="source-line-no">275</span><span id="line-275">                this.showAFPRanges = showAFPRanges;</span>
<span class="source-line-no">276</span><span id="line-276">        }</span>
<span class="source-line-no">277</span><span id="line-277"></span>
<span class="source-line-no">278</span><span id="line-278"></span>
<span class="source-line-no">279</span><span id="line-279"></span>
<span class="source-line-no">280</span><span id="line-280"></span>
<span class="source-line-no">281</span><span id="line-281"></span>
<span class="source-line-no">282</span><span id="line-282">        /** set the maximum RMSD cutoff to be applied during alignment optimization. (default: 99 = unlimited)</span>
<span class="source-line-no">283</span><span id="line-283">         *</span>
<span class="source-line-no">284</span><span id="line-284">         * @param param maxOptRMSD</span>
<span class="source-line-no">285</span><span id="line-285">         */</span>
<span class="source-line-no">286</span><span id="line-286">        public void setMaxOptRMSD(Double param){</span>
<span class="source-line-no">287</span><span id="line-287">                if ( param == null)</span>
<span class="source-line-no">288</span><span id="line-288">                        param = 99d;</span>
<span class="source-line-no">289</span><span id="line-289">                maxOptRMSD = param;</span>
<span class="source-line-no">290</span><span id="line-290">        }</span>
<span class="source-line-no">291</span><span id="line-291"></span>
<span class="source-line-no">292</span><span id="line-292">        /** Returns the maximum RMSD cutoff to be applied during alignment optimization (default: 99 = unlimited)</span>
<span class="source-line-no">293</span><span id="line-293">         *</span>
<span class="source-line-no">294</span><span id="line-294">         * @return maxOptRMSD</span>
<span class="source-line-no">295</span><span id="line-295">         */</span>
<span class="source-line-no">296</span><span id="line-296">        public Double getMaxOptRMSD()</span>
<span class="source-line-no">297</span><span id="line-297">        {</span>
<span class="source-line-no">298</span><span id="line-298">                return maxOptRMSD;</span>
<span class="source-line-no">299</span><span id="line-299">        }</span>
<span class="source-line-no">300</span><span id="line-300"></span>
<span class="source-line-no">301</span><span id="line-301"></span>
<span class="source-line-no">302</span><span id="line-302"></span>
<span class="source-line-no">303</span><span id="line-303">        public Double getGapOpen()</span>
<span class="source-line-no">304</span><span id="line-304">        {</span>
<span class="source-line-no">305</span><span id="line-305">                return gapOpen;</span>
<span class="source-line-no">306</span><span id="line-306">        }</span>
<span class="source-line-no">307</span><span id="line-307"></span>
<span class="source-line-no">308</span><span id="line-308"></span>
<span class="source-line-no">309</span><span id="line-309"></span>
<span class="source-line-no">310</span><span id="line-310">        public void setGapOpen(Double gapOpen)</span>
<span class="source-line-no">311</span><span id="line-311">        {</span>
<span class="source-line-no">312</span><span id="line-312">                this.gapOpen = gapOpen;</span>
<span class="source-line-no">313</span><span id="line-313">        }</span>
<span class="source-line-no">314</span><span id="line-314"></span>
<span class="source-line-no">315</span><span id="line-315"></span>
<span class="source-line-no">316</span><span id="line-316"></span>
<span class="source-line-no">317</span><span id="line-317">        public Double getGapExtension()</span>
<span class="source-line-no">318</span><span id="line-318">        {</span>
<span class="source-line-no">319</span><span id="line-319">                return gapExtension;</span>
<span class="source-line-no">320</span><span id="line-320">        }</span>
<span class="source-line-no">321</span><span id="line-321"></span>
<span class="source-line-no">322</span><span id="line-322"></span>
<span class="source-line-no">323</span><span id="line-323"></span>
<span class="source-line-no">324</span><span id="line-324">        public void setGapExtension(Double gapExtension)</span>
<span class="source-line-no">325</span><span id="line-325">        {</span>
<span class="source-line-no">326</span><span id="line-326">                this.gapExtension = gapExtension;</span>
<span class="source-line-no">327</span><span id="line-327">        }</span>
<span class="source-line-no">328</span><span id="line-328"></span>
<span class="source-line-no">329</span><span id="line-329"></span>
<span class="source-line-no">330</span><span id="line-330"></span>
<span class="source-line-no">331</span><span id="line-331">        public Double getDistanceIncrement()</span>
<span class="source-line-no">332</span><span id="line-332">        {</span>
<span class="source-line-no">333</span><span id="line-333">                return distanceIncrement;</span>
<span class="source-line-no">334</span><span id="line-334">        }</span>
<span class="source-line-no">335</span><span id="line-335"></span>
<span class="source-line-no">336</span><span id="line-336"></span>
<span class="source-line-no">337</span><span id="line-337"></span>
<span class="source-line-no">338</span><span id="line-338">        public void setDistanceIncrement(Double distanceIncrement)</span>
<span class="source-line-no">339</span><span id="line-339">        {</span>
<span class="source-line-no">340</span><span id="line-340">                this.distanceIncrement = distanceIncrement;</span>
<span class="source-line-no">341</span><span id="line-341">        }</span>
<span class="source-line-no">342</span><span id="line-342"></span>
<span class="source-line-no">343</span><span id="line-343"></span>
<span class="source-line-no">344</span><span id="line-344"></span>
<span class="source-line-no">345</span><span id="line-345">        /**</span>
<span class="source-line-no">346</span><span id="line-346">         * Get the Original RMSD threshold from which the alignment optimization is started</span>
<span class="source-line-no">347</span><span id="line-347">         *</span>
<span class="source-line-no">348</span><span id="line-348">         * @return oRMSDThreshold</span>
<span class="source-line-no">349</span><span id="line-349">         */</span>
<span class="source-line-no">350</span><span id="line-350">        public Double getORmsdThr()</span>
<span class="source-line-no">351</span><span id="line-351">        {</span>
<span class="source-line-no">352</span><span id="line-352">                return oRmsdThr;</span>
<span class="source-line-no">353</span><span id="line-353">        }</span>
<span class="source-line-no">354</span><span id="line-354"></span>
<span class="source-line-no">355</span><span id="line-355"></span>
<span class="source-line-no">356</span><span id="line-356"></span>
<span class="source-line-no">357</span><span id="line-357">        /**</span>
<span class="source-line-no">358</span><span id="line-358">         * Set the Original RMSD threshold from which the alignment optimization is started</span>
<span class="source-line-no">359</span><span id="line-359">         *</span>
<span class="source-line-no">360</span><span id="line-360">         * @param oRmsdThr the threshold</span>
<span class="source-line-no">361</span><span id="line-361">         */</span>
<span class="source-line-no">362</span><span id="line-362">        public void setORmsdThr(Double oRmsdThr)</span>
<span class="source-line-no">363</span><span id="line-363">        {</span>
<span class="source-line-no">364</span><span id="line-364">                this.oRmsdThr = oRmsdThr;</span>
<span class="source-line-no">365</span><span id="line-365">        }</span>
<span class="source-line-no">366</span><span id="line-366"></span>
<span class="source-line-no">367</span><span id="line-367"></span>
<span class="source-line-no">368</span><span id="line-368">        /**</span>
<span class="source-line-no">369</span><span id="line-369">         * Get the maximum nr of times the (slow) optimiziation of alignment should iterate. Default: unlimited</span>
<span class="source-line-no">370</span><span id="line-370">         *</span>
<span class="source-line-no">371</span><span id="line-371">         */</span>
<span class="source-line-no">372</span><span id="line-372">        public int getMaxNrIterationsForOptimization() {</span>
<span class="source-line-no">373</span><span id="line-373">                return maxNrIterationsForOptimization;</span>
<span class="source-line-no">374</span><span id="line-374">        }</span>
<span class="source-line-no">375</span><span id="line-375"></span>
<span class="source-line-no">376</span><span id="line-376"></span>
<span class="source-line-no">377</span><span id="line-377">        /**</span>
<span class="source-line-no">378</span><span id="line-378">         * Set the maximum nr of times the (slow) optimiziation of alignment should iterate. Default: unlimited</span>
<span class="source-line-no">379</span><span id="line-379">         *</span>
<span class="source-line-no">380</span><span id="line-380">         * @param maxNrIterationsForOptimization</span>
<span class="source-line-no">381</span><span id="line-381">         */</span>
<span class="source-line-no">382</span><span id="line-382">        public void setMaxNrIterationsForOptimization(int maxNrIterationsForOptimization) {</span>
<span class="source-line-no">383</span><span id="line-383">                this.maxNrIterationsForOptimization = maxNrIterationsForOptimization;</span>
<span class="source-line-no">384</span><span id="line-384">        }</span>
<span class="source-line-no">385</span><span id="line-385"></span>
<span class="source-line-no">386</span><span id="line-386"></span>
<span class="source-line-no">387</span><span id="line-387">        /**</span>
<span class="source-line-no">388</span><span id="line-388">         * Should sequence conservation be considered as part of the alignment? If yes, this weight factor allows to determine how much.</span>
<span class="source-line-no">389</span><span id="line-389">         *  By default this is set to 0, meaning no contribution of the sequence alignment score.</span>
<span class="source-line-no">390</span><span id="line-390">         *</span>
<span class="source-line-no">391</span><span id="line-391">         * @return seqWeight the weight factor (default 0)</span>
<span class="source-line-no">392</span><span id="line-392">         */</span>
<span class="source-line-no">393</span><span id="line-393"></span>
<span class="source-line-no">394</span><span id="line-394">        public double getSeqWeight() {</span>
<span class="source-line-no">395</span><span id="line-395">                return seqWeight;</span>
<span class="source-line-no">396</span><span id="line-396">        }</span>
<span class="source-line-no">397</span><span id="line-397"></span>
<span class="source-line-no">398</span><span id="line-398"></span>
<span class="source-line-no">399</span><span id="line-399">        /**</span>
<span class="source-line-no">400</span><span id="line-400">         * Should sequence conservation be considered as part of the alignment? If yes, this weight factor allows to determine how much.</span>
<span class="source-line-no">401</span><span id="line-401">         *  By default this is set to 0, meaning no contribution of the sequence alignment score.</span>
<span class="source-line-no">402</span><span id="line-402">         *</span>
<span class="source-line-no">403</span><span id="line-403">         * @param seqWeight the weight factor (default 0)</span>
<span class="source-line-no">404</span><span id="line-404">         */</span>
<span class="source-line-no">405</span><span id="line-405">        public void setSeqWeight(double seqWeight) {</span>
<span class="source-line-no">406</span><span id="line-406">                this.seqWeight = seqWeight;</span>
<span class="source-line-no">407</span><span id="line-407">        }</span>
<span class="source-line-no">408</span><span id="line-408"></span>
<span class="source-line-no">409</span><span id="line-409"></span>
<span class="source-line-no">410</span><span id="line-410">        /** Sets the  substitution matrix to be used for influencing the alignment with sequence conservation information.</span>
<span class="source-line-no">411</span><span id="line-411">         * Default: SDM matrix (Prlic et al 2000)</span>
<span class="source-line-no">412</span><span id="line-412">         * @return substitutionMatrix</span>
<span class="source-line-no">413</span><span id="line-413">         */</span>
<span class="source-line-no">414</span><span id="line-414">        public SubstitutionMatrix&lt;AminoAcidCompound&gt; getSubstitutionMatrix() {</span>
<span class="source-line-no">415</span><span id="line-415">                if ( substitutionMatrix == null){</span>
<span class="source-line-no">416</span><span id="line-416">                        substitutionMatrix = SubstitutionMatrixHelper.getMatrixFromAAINDEX(DEFAULT_SUBSTITUTION_MATRIX);</span>
<span class="source-line-no">417</span><span id="line-417"></span>
<span class="source-line-no">418</span><span id="line-418">                }</span>
<span class="source-line-no">419</span><span id="line-419">                return substitutionMatrix;</span>
<span class="source-line-no">420</span><span id="line-420">        }</span>
<span class="source-line-no">421</span><span id="line-421"></span>
<span class="source-line-no">422</span><span id="line-422"></span>
<span class="source-line-no">423</span><span id="line-423">        /** Sets the  substitution matrix to be used for influencing the alignment with sequence conservation information.</span>
<span class="source-line-no">424</span><span id="line-424">         * Default: SDM matrix (Prlic et al 2000)</span>
<span class="source-line-no">425</span><span id="line-425">         * @param substitutionMatrix</span>
<span class="source-line-no">426</span><span id="line-426">         */</span>
<span class="source-line-no">427</span><span id="line-427">        public void setSubstitutionMatrix(</span>
<span class="source-line-no">428</span><span id="line-428">                        SubstitutionMatrix&lt;AminoAcidCompound&gt; substitutionMatrix) {</span>
<span class="source-line-no">429</span><span id="line-429">                this.substitutionMatrix = substitutionMatrix;</span>
<span class="source-line-no">430</span><span id="line-430">        }</span>
<span class="source-line-no">431</span><span id="line-431"></span>
<span class="source-line-no">432</span><span id="line-432"></span>
<span class="source-line-no">433</span><span id="line-433">        /**</span>
<span class="source-line-no">434</span><span id="line-434">         * Whether the CE algorithm should extend the best found trace with dynamic programming,</span>
<span class="source-line-no">435</span><span id="line-435">         * while keeping RMSD at about the same level. This is useful for edge cases with remote homology,</span>
<span class="source-line-no">436</span><span id="line-436">         * but can be slow for large structures.</span>
<span class="source-line-no">437</span><span id="line-437">         *</span>
<span class="source-line-no">438</span><span id="line-438">         * @return optimizeAlignment</span>
<span class="source-line-no">439</span><span id="line-439">         */</span>
<span class="source-line-no">440</span><span id="line-440">        public boolean isOptimizeAlignment() {</span>
<span class="source-line-no">441</span><span id="line-441">                return optimizeAlignment;</span>
<span class="source-line-no">442</span><span id="line-442">        }</span>
<span class="source-line-no">443</span><span id="line-443"></span>
<span class="source-line-no">444</span><span id="line-444">        /**</span>
<span class="source-line-no">445</span><span id="line-445">         * Whether the CE algorithm should extend the best found trace with dynamic programming,</span>
<span class="source-line-no">446</span><span id="line-446">         * while keeping RMSD at about the same level. This is useful for edge cases with remote homology,</span>
<span class="source-line-no">447</span><span id="line-447">         * but can be slow for large structures.</span>
<span class="source-line-no">448</span><span id="line-448">         *</span>
<span class="source-line-no">449</span><span id="line-449">         * @param optimizeAlignment</span>
<span class="source-line-no">450</span><span id="line-450">         */</span>
<span class="source-line-no">451</span><span id="line-451">        public void setOptimizeAlignment(boolean optimizeAlignment) {</span>
<span class="source-line-no">452</span><span id="line-452">                this.optimizeAlignment = optimizeAlignment;</span>
<span class="source-line-no">453</span><span id="line-453">        }</span>
<span class="source-line-no">454</span><span id="line-454"></span>
<span class="source-line-no">455</span><span id="line-455">}</span>




























































</pre>
</div>
</main>
</body>
</html>
