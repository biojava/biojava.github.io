<!DOCTYPE HTML>
<html lang="en">
<head>
<title>Source code</title>
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body>
<main role="main">
<div class="sourceContainer">
<pre><span class="sourceLineNo">001</span><a id="line.1">/*</a>
<span class="sourceLineNo">002</span><a id="line.2"> *                    BioJava development code</a>
<span class="sourceLineNo">003</span><a id="line.3"> *</a>
<span class="sourceLineNo">004</span><a id="line.4"> * This code may be freely distributed and modified under the</a>
<span class="sourceLineNo">005</span><a id="line.5"> * terms of the GNU Lesser General Public Licence.  This should</a>
<span class="sourceLineNo">006</span><a id="line.6"> * be distributed with the code.  If you do not have a copy,</a>
<span class="sourceLineNo">007</span><a id="line.7"> * see:</a>
<span class="sourceLineNo">008</span><a id="line.8"> *</a>
<span class="sourceLineNo">009</span><a id="line.9"> *      http://www.gnu.org/copyleft/lesser.html</a>
<span class="sourceLineNo">010</span><a id="line.10"> *</a>
<span class="sourceLineNo">011</span><a id="line.11"> * Copyright for this code is held jointly by the individual</a>
<span class="sourceLineNo">012</span><a id="line.12"> * authors.  These should be listed in @author doc comments.</a>
<span class="sourceLineNo">013</span><a id="line.13"> *</a>
<span class="sourceLineNo">014</span><a id="line.14"> * For more information on the BioJava project and its aims,</a>
<span class="sourceLineNo">015</span><a id="line.15"> * or to join the biojava-l mailing list, visit the home page</a>
<span class="sourceLineNo">016</span><a id="line.16"> * at:</a>
<span class="sourceLineNo">017</span><a id="line.17"> *</a>
<span class="sourceLineNo">018</span><a id="line.18"> *      http://www.biojava.org/</a>
<span class="sourceLineNo">019</span><a id="line.19"> *</a>
<span class="sourceLineNo">020</span><a id="line.20"> */</a>
<span class="sourceLineNo">021</span><a id="line.21"></a>
<span class="sourceLineNo">022</span><a id="line.22">package org.biojava.bio.seq.io;</a>
<span class="sourceLineNo">023</span><a id="line.23"></a>
<span class="sourceLineNo">024</span><a id="line.24">import java.io.BufferedReader;</a>
<span class="sourceLineNo">025</span><a id="line.25">import java.io.IOException;</a>
<span class="sourceLineNo">026</span><a id="line.26">import java.util.ArrayList;</a>
<span class="sourceLineNo">027</span><a id="line.27">import java.util.ListIterator;</a>
<span class="sourceLineNo">028</span><a id="line.28"></a>
<span class="sourceLineNo">029</span><a id="line.29">import javax.xml.parsers.ParserConfigurationException;</a>
<span class="sourceLineNo">030</span><a id="line.30">import javax.xml.parsers.SAXParser;</a>
<span class="sourceLineNo">031</span><a id="line.31">import javax.xml.parsers.SAXParserFactory;</a>
<span class="sourceLineNo">032</span><a id="line.32"></a>
<span class="sourceLineNo">033</span><a id="line.33">import org.biojava.bio.symbol.IllegalSymbolException;</a>
<span class="sourceLineNo">034</span><a id="line.34">import org.xml.sax.Attributes;</a>
<span class="sourceLineNo">035</span><a id="line.35">import org.xml.sax.InputSource;</a>
<span class="sourceLineNo">036</span><a id="line.36">import org.xml.sax.SAXException;</a>
<span class="sourceLineNo">037</span><a id="line.37">import org.xml.sax.helpers.DefaultHandler;</a>
<span class="sourceLineNo">038</span><a id="line.38"></a>
<span class="sourceLineNo">039</span><a id="line.39">/**</a>
<span class="sourceLineNo">040</span><a id="line.40"> * Format reader for GenBank XML files.</a>
<span class="sourceLineNo">041</span><a id="line.41"> * </a>
<span class="sourceLineNo">042</span><a id="line.42"> * @author Alan Li - alanli[at]xyworks.com</a>
<span class="sourceLineNo">043</span><a id="line.43"> * @deprecated Use org.biojavax.bio.seq.io.INSDseqFormat</a>
<span class="sourceLineNo">044</span><a id="line.44"> */</a>
<span class="sourceLineNo">045</span><a id="line.45"></a>
<span class="sourceLineNo">046</span><a id="line.46">public class GenbankXmlFormat extends GenbankFormat</a>
<span class="sourceLineNo">047</span><a id="line.47">{</a>
<span class="sourceLineNo">048</span><a id="line.48">    private SAXParser m_xmlParser;</a>
<span class="sourceLineNo">049</span><a id="line.49">    private GenbankXmlHandler m_handler;</a>
<span class="sourceLineNo">050</span><a id="line.50">    private boolean m_parsed;</a>
<span class="sourceLineNo">051</span><a id="line.51">    private int m_sequenceIndex;</a>
<span class="sourceLineNo">052</span><a id="line.52">    </a>
<span class="sourceLineNo">053</span><a id="line.53">    public GenbankXmlFormat()</a>
<span class="sourceLineNo">054</span><a id="line.54">    {</a>
<span class="sourceLineNo">055</span><a id="line.55">        m_parsed = false;</a>
<span class="sourceLineNo">056</span><a id="line.56">    }</a>
<span class="sourceLineNo">057</span><a id="line.57">    </a>
<span class="sourceLineNo">058</span><a id="line.58">    public boolean readSequence( BufferedReader reader,</a>
<span class="sourceLineNo">059</span><a id="line.59">                                 SymbolTokenization symParser,</a>
<span class="sourceLineNo">060</span><a id="line.60">                                 SeqIOListener listener)</a>
<span class="sourceLineNo">061</span><a id="line.61">    throws IllegalSymbolException, IOException, ParseException</a>
<span class="sourceLineNo">062</span><a id="line.62">    {</a>
<span class="sourceLineNo">063</span><a id="line.63">        // only parse the sequence only once</a>
<span class="sourceLineNo">064</span><a id="line.64">        if( ! m_parsed )</a>
<span class="sourceLineNo">065</span><a id="line.65">        {</a>
<span class="sourceLineNo">066</span><a id="line.66">            SAXParserFactory factory = SAXParserFactory.newInstance();</a>
<span class="sourceLineNo">067</span><a id="line.67">            factory.setValidating( true );</a>
<span class="sourceLineNo">068</span><a id="line.68">            try</a>
<span class="sourceLineNo">069</span><a id="line.69">            {</a>
<span class="sourceLineNo">070</span><a id="line.70">                m_xmlParser = factory.newSAXParser();</a>
<span class="sourceLineNo">071</span><a id="line.71">            }</a>
<span class="sourceLineNo">072</span><a id="line.72">            catch( ParserConfigurationException ex )</a>
<span class="sourceLineNo">073</span><a id="line.73">            {</a>
<span class="sourceLineNo">074</span><a id="line.74">                throw new ParseException( ex );</a>
<span class="sourceLineNo">075</span><a id="line.75">            }</a>
<span class="sourceLineNo">076</span><a id="line.76">            catch( SAXException ex )</a>
<span class="sourceLineNo">077</span><a id="line.77">            {</a>
<span class="sourceLineNo">078</span><a id="line.78">                throw new ParseException( ex );</a>
<span class="sourceLineNo">079</span><a id="line.79">            }</a>
<span class="sourceLineNo">080</span><a id="line.80">            </a>
<span class="sourceLineNo">081</span><a id="line.81">            InputSource source = new InputSource( reader );</a>
<span class="sourceLineNo">082</span><a id="line.82">            m_handler = new GenbankXmlHandler();</a>
<span class="sourceLineNo">083</span><a id="line.83">                    </a>
<span class="sourceLineNo">084</span><a id="line.84">            try</a>
<span class="sourceLineNo">085</span><a id="line.85">            {</a>
<span class="sourceLineNo">086</span><a id="line.86">                m_xmlParser.parse( source, m_handler );</a>
<span class="sourceLineNo">087</span><a id="line.87">            }</a>
<span class="sourceLineNo">088</span><a id="line.88">            catch( SAXException ex )</a>
<span class="sourceLineNo">089</span><a id="line.89">            {</a>
<span class="sourceLineNo">090</span><a id="line.90">                throw new ParseException( ex );</a>
<span class="sourceLineNo">091</span><a id="line.91">            }</a>
<span class="sourceLineNo">092</span><a id="line.92">            </a>
<span class="sourceLineNo">093</span><a id="line.93">            m_parsed = true;</a>
<span class="sourceLineNo">094</span><a id="line.94">        }</a>
<span class="sourceLineNo">095</span><a id="line.95">        </a>
<span class="sourceLineNo">096</span><a id="line.96">        // after parsing the input into one or more sequences, pass only </a>
<span class="sourceLineNo">097</span><a id="line.97">        // one sequence per readSequence()</a>
<span class="sourceLineNo">098</span><a id="line.98">        ArrayList sequences = m_handler.getSequences();     </a>
<span class="sourceLineNo">099</span><a id="line.99">        listener.startSequence();</a>
<span class="sourceLineNo">100</span><a id="line.100">        GenbankXmlSequence sequence = </a>
<span class="sourceLineNo">101</span><a id="line.101">            (GenbankXmlSequence) sequences.get( m_sequenceIndex++ );</a>
<span class="sourceLineNo">102</span><a id="line.102">        generateSequenceForListener( sequence, listener, symParser );</a>
<span class="sourceLineNo">103</span><a id="line.103">        listener.endSequence();</a>
<span class="sourceLineNo">104</span><a id="line.104">        </a>
<span class="sourceLineNo">105</span><a id="line.105">        return ( m_sequenceIndex &lt; sequences.size() );</a>
<span class="sourceLineNo">106</span><a id="line.106">    }</a>
<span class="sourceLineNo">107</span><a id="line.107">   </a>
<span class="sourceLineNo">108</span><a id="line.108">    // helper method to handle the genbank xml objects to the SeqIOListener</a>
<span class="sourceLineNo">109</span><a id="line.109">    private void generateSequenceForListener( GenbankXmlSequence sequence, SeqIOListener listener,</a>
<span class="sourceLineNo">110</span><a id="line.110">                                              SymbolTokenization symParser )</a>
<span class="sourceLineNo">111</span><a id="line.111">        throws ParseException, IllegalSymbolException</a>
<span class="sourceLineNo">112</span><a id="line.112">    {</a>
<span class="sourceLineNo">113</span><a id="line.113">        listener.addSequenceProperty( LOCUS_TAG, sequence.getLocus() );</a>
<span class="sourceLineNo">114</span><a id="line.114">        listener.addSequenceProperty( SIZE_TAG, sequence.getLength() );</a>
<span class="sourceLineNo">115</span><a id="line.115">        </a>
<span class="sourceLineNo">116</span><a id="line.116">        String strandedness = sequence.getStrandedness();</a>
<span class="sourceLineNo">117</span><a id="line.117">        if( strandedness != null )</a>
<span class="sourceLineNo">118</span><a id="line.118">            listener.addSequenceProperty( STRAND_NUMBER_TAG, </a>
<span class="sourceLineNo">119</span><a id="line.119">                                          convertToStrandednessName( strandedness ) );</a>
<span class="sourceLineNo">120</span><a id="line.120">        </a>
<span class="sourceLineNo">121</span><a id="line.121">        String moltype = sequence.getMolType();</a>
<span class="sourceLineNo">122</span><a id="line.122">        if( moltype != null )</a>
<span class="sourceLineNo">123</span><a id="line.123">            listener.addSequenceProperty( TYPE_TAG, </a>
<span class="sourceLineNo">124</span><a id="line.124">                                          convertToMolTypeName( moltype ) );</a>
<span class="sourceLineNo">125</span><a id="line.125">        String topology = sequence.getTopology();</a>
<span class="sourceLineNo">126</span><a id="line.126">        if( topology != null )</a>
<span class="sourceLineNo">127</span><a id="line.127">            listener.addSequenceProperty( CIRCULAR_TAG,</a>
<span class="sourceLineNo">128</span><a id="line.128">                                          convertToTopologyName( topology ) );</a>
<span class="sourceLineNo">129</span><a id="line.129">        </a>
<span class="sourceLineNo">130</span><a id="line.130">        listener.addSequenceProperty( DIVISION_TAG, sequence.getDivision() );</a>
<span class="sourceLineNo">131</span><a id="line.131">        listener.addSequenceProperty( DATE_TAG, sequence.getUpdateDate() );</a>
<span class="sourceLineNo">132</span><a id="line.132">        listener.addSequenceProperty( DEFINITION_TAG, sequence.getDefinition() );</a>
<span class="sourceLineNo">133</span><a id="line.133">        </a>
<span class="sourceLineNo">134</span><a id="line.134">        String primaryAccession = sequence.getPrimaryAccession();</a>
<span class="sourceLineNo">135</span><a id="line.135">        if( primaryAccession != null )</a>
<span class="sourceLineNo">136</span><a id="line.136">            listener.addSequenceProperty( ACCESSION_TAG, primaryAccession );</a>
<span class="sourceLineNo">137</span><a id="line.137">        </a>
<span class="sourceLineNo">138</span><a id="line.138">        String accessionVersion = sequence.getAccessionVersion();</a>
<span class="sourceLineNo">139</span><a id="line.139">        if( accessionVersion != null )</a>
<span class="sourceLineNo">140</span><a id="line.140">            listener.addSequenceProperty( VERSION_TAG, accessionVersion );</a>
<span class="sourceLineNo">141</span><a id="line.141">        </a>
<span class="sourceLineNo">142</span><a id="line.142">        handleOtherSequenceIds( sequence, listener );  </a>
<span class="sourceLineNo">143</span><a id="line.143">        handleKeywords( sequence, listener );</a>
<span class="sourceLineNo">144</span><a id="line.144">        </a>
<span class="sourceLineNo">145</span><a id="line.145">        listener.addSequenceProperty( SOURCE_TAG, sequence.getSource() );</a>
<span class="sourceLineNo">146</span><a id="line.146">        listener.addSequenceProperty( ORGANISM_TAG, sequence.getOrganism() + sequence.getTaxonomy() );</a>
<span class="sourceLineNo">147</span><a id="line.147">        </a>
<span class="sourceLineNo">148</span><a id="line.148">        handleReferences( sequence, listener );</a>
<span class="sourceLineNo">149</span><a id="line.149">        </a>
<span class="sourceLineNo">150</span><a id="line.150">        String comment = sequence.getComment();</a>
<span class="sourceLineNo">151</span><a id="line.151">        if( comment != null )</a>
<span class="sourceLineNo">152</span><a id="line.152">            listener.addSequenceProperty( COMMENT_TAG, comment );</a>
<span class="sourceLineNo">153</span><a id="line.153">        </a>
<span class="sourceLineNo">154</span><a id="line.154">        handleFeatures( sequence, listener );</a>
<span class="sourceLineNo">155</span><a id="line.155">        </a>
<span class="sourceLineNo">156</span><a id="line.156">        String seq = sequence.getSequence();</a>
<span class="sourceLineNo">157</span><a id="line.157">        if( seq != null &amp;&amp; ! getElideSymbols() )</a>
<span class="sourceLineNo">158</span><a id="line.158">        {</a>
<span class="sourceLineNo">159</span><a id="line.159">            StreamParser streamParser = symParser.parseStream( listener );</a>
<span class="sourceLineNo">160</span><a id="line.160">            streamParser.characters( seq.toCharArray(), 0, seq.length() );</a>
<span class="sourceLineNo">161</span><a id="line.161">        }</a>
<span class="sourceLineNo">162</span><a id="line.162">    }</a>
<span class="sourceLineNo">163</span><a id="line.163"></a>
<span class="sourceLineNo">164</span><a id="line.164">    private void handleOtherSequenceIds( GenbankXmlSequence sequence, SeqIOListener listener ) </a>
<span class="sourceLineNo">165</span><a id="line.165">        throws ParseException</a>
<span class="sourceLineNo">166</span><a id="line.166">    {</a>
<span class="sourceLineNo">167</span><a id="line.167">        ArrayList otherSeqIds = sequence.getOtherSequencesIds();</a>
<span class="sourceLineNo">168</span><a id="line.168">        ListIterator iter = otherSeqIds.listIterator();</a>
<span class="sourceLineNo">169</span><a id="line.169">        while( iter.hasNext() )</a>
<span class="sourceLineNo">170</span><a id="line.170">        {</a>
<span class="sourceLineNo">171</span><a id="line.171">            String seqId = (String) iter.next();</a>
<span class="sourceLineNo">172</span><a id="line.172">            if( seqId.startsWith( "gi|" ) )</a>
<span class="sourceLineNo">173</span><a id="line.173">                listener.addSequenceProperty( GI_TAG, seqId.substring( 3 ) );</a>
<span class="sourceLineNo">174</span><a id="line.174">        }</a>
<span class="sourceLineNo">175</span><a id="line.175">    }</a>
<span class="sourceLineNo">176</span><a id="line.176"></a>
<span class="sourceLineNo">177</span><a id="line.177">    private void handleKeywords( GenbankXmlSequence sequence, SeqIOListener listener ) </a>
<span class="sourceLineNo">178</span><a id="line.178">        throws ParseException</a>
<span class="sourceLineNo">179</span><a id="line.179">    {</a>
<span class="sourceLineNo">180</span><a id="line.180">        ArrayList keywords = sequence.getKeywords();</a>
<span class="sourceLineNo">181</span><a id="line.181">        ListIterator iter = keywords.listIterator();</a>
<span class="sourceLineNo">182</span><a id="line.182">        while( iter.hasNext() )</a>
<span class="sourceLineNo">183</span><a id="line.183">        {</a>
<span class="sourceLineNo">184</span><a id="line.184">            String keyword = (String) iter.next();</a>
<span class="sourceLineNo">185</span><a id="line.185">            listener.addSequenceProperty( "KEYWORDS", keyword );</a>
<span class="sourceLineNo">186</span><a id="line.186">        }</a>
<span class="sourceLineNo">187</span><a id="line.187">    }</a>
<span class="sourceLineNo">188</span><a id="line.188"></a>
<span class="sourceLineNo">189</span><a id="line.189">    private void handleReferences( GenbankXmlSequence sequence, SeqIOListener listener ) throws ParseException</a>
<span class="sourceLineNo">190</span><a id="line.190">    {</a>
<span class="sourceLineNo">191</span><a id="line.191">        ArrayList references = sequence.getReferences();</a>
<span class="sourceLineNo">192</span><a id="line.192">        ListIterator iter = references.listIterator();</a>
<span class="sourceLineNo">193</span><a id="line.193">        while( iter.hasNext() )</a>
<span class="sourceLineNo">194</span><a id="line.194">        {</a>
<span class="sourceLineNo">195</span><a id="line.195">            GenbankXmlReference reference = (GenbankXmlReference) iter.next();</a>
<span class="sourceLineNo">196</span><a id="line.196">            </a>
<span class="sourceLineNo">197</span><a id="line.197">            listener.addSequenceProperty( REFERENCE_TAG, reference.getReference() );</a>
<span class="sourceLineNo">198</span><a id="line.198">            </a>
<span class="sourceLineNo">199</span><a id="line.199">            ArrayList authors = reference.getAuthors();</a>
<span class="sourceLineNo">200</span><a id="line.200">            ListIterator authorIter = authors.listIterator();</a>
<span class="sourceLineNo">201</span><a id="line.201">            StringBuffer theAuthors = new StringBuffer( "" );</a>
<span class="sourceLineNo">202</span><a id="line.202">            while( authorIter.hasNext() )</a>
<span class="sourceLineNo">203</span><a id="line.203">            {</a>
<span class="sourceLineNo">204</span><a id="line.204">                String author = (String) authorIter.next();</a>
<span class="sourceLineNo">205</span><a id="line.205">                theAuthors.append( author );</a>
<span class="sourceLineNo">206</span><a id="line.206">                if( authorIter.hasNext() )</a>
<span class="sourceLineNo">207</span><a id="line.207">                    theAuthors.append( ", " );</a>
<span class="sourceLineNo">208</span><a id="line.208">            }</a>
<span class="sourceLineNo">209</span><a id="line.209">            listener.addSequenceProperty( AUTHORS_TAG, theAuthors.toString() );</a>
<span class="sourceLineNo">210</span><a id="line.210">            </a>
<span class="sourceLineNo">211</span><a id="line.211">            String title = reference.getTitle();</a>
<span class="sourceLineNo">212</span><a id="line.212">            if( title != null )</a>
<span class="sourceLineNo">213</span><a id="line.213">                listener.addSequenceProperty( TITLE_TAG, title );</a>
<span class="sourceLineNo">214</span><a id="line.214">            </a>
<span class="sourceLineNo">215</span><a id="line.215">            listener.addSequenceProperty( JOURNAL_TAG, reference.getJournal() );</a>
<span class="sourceLineNo">216</span><a id="line.216">            </a>
<span class="sourceLineNo">217</span><a id="line.217">            // Added by RichardH to include Medline/Pubmed refs.</a>
<span class="sourceLineNo">218</span><a id="line.218">            String pubmed = reference.getPubmed();</a>
<span class="sourceLineNo">219</span><a id="line.219">            if (pubmed!=null) listener.addSequenceProperty(PUBMED_TAG, pubmed);</a>
<span class="sourceLineNo">220</span><a id="line.220">            String medline = reference.getMedline();</a>
<span class="sourceLineNo">221</span><a id="line.221">            if (medline!=null) listener.addSequenceProperty(MEDLINE_TAG, medline);</a>
<span class="sourceLineNo">222</span><a id="line.222">        }</a>
<span class="sourceLineNo">223</span><a id="line.223">    }</a>
<span class="sourceLineNo">224</span><a id="line.224">    </a>
<span class="sourceLineNo">225</span><a id="line.225">    private void handleFeatures( GenbankXmlSequence sequence, SeqIOListener listener ) throws ParseException</a>
<span class="sourceLineNo">226</span><a id="line.226">    {</a>
<span class="sourceLineNo">227</span><a id="line.227">        ArrayList features = sequence.getFeatures();</a>
<span class="sourceLineNo">228</span><a id="line.228">        ListIterator iter = features.listIterator();</a>
<span class="sourceLineNo">229</span><a id="line.229">        while( iter.hasNext() )</a>
<span class="sourceLineNo">230</span><a id="line.230">        {</a>
<span class="sourceLineNo">231</span><a id="line.231">            GenbankXmlFeature feature = (GenbankXmlFeature) iter.next();</a>
<span class="sourceLineNo">232</span><a id="line.232">            String key = feature.getKey();</a>
<span class="sourceLineNo">233</span><a id="line.233">            int keyLength = key.length();</a>
<span class="sourceLineNo">234</span><a id="line.234">            String featureString = feature.getKey() + createBlankString( 16 - keyLength ) + </a>
<span class="sourceLineNo">235</span><a id="line.235">                                   feature.getLocation();</a>
<span class="sourceLineNo">236</span><a id="line.236">            listener.addSequenceProperty( FEATURE_FLAG, featureString );</a>
<span class="sourceLineNo">237</span><a id="line.237">            </a>
<span class="sourceLineNo">238</span><a id="line.238">            ArrayList qualifiers = feature.getQualifiers();</a>
<span class="sourceLineNo">239</span><a id="line.239">            ListIterator qualifiersIter = qualifiers.listIterator();</a>
<span class="sourceLineNo">240</span><a id="line.240">            while( qualifiersIter.hasNext() )</a>
<span class="sourceLineNo">241</span><a id="line.241">            {</a>
<span class="sourceLineNo">242</span><a id="line.242">                GenbankXmlQualifier qualifier = (GenbankXmlQualifier) qualifiersIter.next();</a>
<span class="sourceLineNo">243</span><a id="line.243">                String qualifierString = "                /" + qualifier.getName() + "=" +</a>
<span class="sourceLineNo">244</span><a id="line.244">                                         "\"" + qualifier.getValue() + "\"";</a>
<span class="sourceLineNo">245</span><a id="line.245">                listener.addSequenceProperty( FEATURE_FLAG, qualifierString );</a>
<span class="sourceLineNo">246</span><a id="line.246">            }</a>
<span class="sourceLineNo">247</span><a id="line.247">        }</a>
<span class="sourceLineNo">248</span><a id="line.248">    }</a>
<span class="sourceLineNo">249</span><a id="line.249">    </a>
<span class="sourceLineNo">250</span><a id="line.250">    public String getDefaultFormat()</a>
<span class="sourceLineNo">251</span><a id="line.251">    {</a>
<span class="sourceLineNo">252</span><a id="line.252">        return "GenbankXml";</a>
<span class="sourceLineNo">253</span><a id="line.253">    }</a>
<span class="sourceLineNo">254</span><a id="line.254"> </a>
<span class="sourceLineNo">255</span><a id="line.255">    private String createBlankString( int size )</a>
<span class="sourceLineNo">256</span><a id="line.256">    {</a>
<span class="sourceLineNo">257</span><a id="line.257">        StringBuffer sb = new StringBuffer();</a>
<span class="sourceLineNo">258</span><a id="line.258">        for( int i = 0; i &lt; size; i++ )</a>
<span class="sourceLineNo">259</span><a id="line.259">            sb.append( ' ' );</a>
<span class="sourceLineNo">260</span><a id="line.260">        return sb.toString();</a>
<span class="sourceLineNo">261</span><a id="line.261">    }</a>
<span class="sourceLineNo">262</span><a id="line.262">   </a>
<span class="sourceLineNo">263</span><a id="line.263">    private String convertToStrandednessName( String strandednessIndex ) throws ParseException</a>
<span class="sourceLineNo">264</span><a id="line.264">    {</a>
<span class="sourceLineNo">265</span><a id="line.265">        int i = Integer.parseInt( strandednessIndex );</a>
<span class="sourceLineNo">266</span><a id="line.266">        switch( i )</a>
<span class="sourceLineNo">267</span><a id="line.267">        {</a>
<span class="sourceLineNo">268</span><a id="line.268">            case 0:</a>
<span class="sourceLineNo">269</span><a id="line.269">                return "not-set";</a>
<span class="sourceLineNo">270</span><a id="line.270">            case 1:</a>
<span class="sourceLineNo">271</span><a id="line.271">                return "single-stranded";</a>
<span class="sourceLineNo">272</span><a id="line.272">            case 2:</a>
<span class="sourceLineNo">273</span><a id="line.273">                return "double-stranded";</a>
<span class="sourceLineNo">274</span><a id="line.274">            case 3:</a>
<span class="sourceLineNo">275</span><a id="line.275">                return "mixed-stranded";</a>
<span class="sourceLineNo">276</span><a id="line.276">            default:</a>
<span class="sourceLineNo">277</span><a id="line.277">                throw new ParseException( "Unknown strandedness: " + strandednessIndex );</a>
<span class="sourceLineNo">278</span><a id="line.278">        }</a>
<span class="sourceLineNo">279</span><a id="line.279">    }</a>
<span class="sourceLineNo">280</span><a id="line.280">    </a>
<span class="sourceLineNo">281</span><a id="line.281">    private String convertToMolTypeName( String moltypeIndex ) throws ParseException</a>
<span class="sourceLineNo">282</span><a id="line.282">    {</a>
<span class="sourceLineNo">283</span><a id="line.283">        int i = Integer.parseInt( moltypeIndex );</a>
<span class="sourceLineNo">284</span><a id="line.284">        switch( i )</a>
<span class="sourceLineNo">285</span><a id="line.285">        {</a>
<span class="sourceLineNo">286</span><a id="line.286">            case 0:</a>
<span class="sourceLineNo">287</span><a id="line.287">                return "nucleic-acid";</a>
<span class="sourceLineNo">288</span><a id="line.288">            case 1:</a>
<span class="sourceLineNo">289</span><a id="line.289">                return "dna";</a>
<span class="sourceLineNo">290</span><a id="line.290">            case 2:</a>
<span class="sourceLineNo">291</span><a id="line.291">                return "rna";</a>
<span class="sourceLineNo">292</span><a id="line.292">            case 3:</a>
<span class="sourceLineNo">293</span><a id="line.293">                return "trna";</a>
<span class="sourceLineNo">294</span><a id="line.294">            case 4:</a>
<span class="sourceLineNo">295</span><a id="line.295">                return "rrna";</a>
<span class="sourceLineNo">296</span><a id="line.296">            case 5:</a>
<span class="sourceLineNo">297</span><a id="line.297">                return "mrna";</a>
<span class="sourceLineNo">298</span><a id="line.298">            case 6:</a>
<span class="sourceLineNo">299</span><a id="line.299">                return "urna";</a>
<span class="sourceLineNo">300</span><a id="line.300">            case 7:</a>
<span class="sourceLineNo">301</span><a id="line.301">                return "snrna";</a>
<span class="sourceLineNo">302</span><a id="line.302">            case 8:</a>
<span class="sourceLineNo">303</span><a id="line.303">                return "snorna";</a>
<span class="sourceLineNo">304</span><a id="line.304">            case 9:</a>
<span class="sourceLineNo">305</span><a id="line.305">                return "peptide";</a>
<span class="sourceLineNo">306</span><a id="line.306">            default:</a>
<span class="sourceLineNo">307</span><a id="line.307">                throw new ParseException( "Unknown molecule type: " + i );</a>
<span class="sourceLineNo">308</span><a id="line.308">        }</a>
<span class="sourceLineNo">309</span><a id="line.309">    }</a>
<span class="sourceLineNo">310</span><a id="line.310">    </a>
<span class="sourceLineNo">311</span><a id="line.311">    private String convertToTopologyName( String topologyIndex ) throws ParseException</a>
<span class="sourceLineNo">312</span><a id="line.312">    {</a>
<span class="sourceLineNo">313</span><a id="line.313">        int i = Integer.parseInt( topologyIndex );</a>
<span class="sourceLineNo">314</span><a id="line.314">        switch( i )</a>
<span class="sourceLineNo">315</span><a id="line.315">        {</a>
<span class="sourceLineNo">316</span><a id="line.316">            case 1:</a>
<span class="sourceLineNo">317</span><a id="line.317">                return "linear";</a>
<span class="sourceLineNo">318</span><a id="line.318">            case 2:</a>
<span class="sourceLineNo">319</span><a id="line.319">                return "circular";</a>
<span class="sourceLineNo">320</span><a id="line.320">            default:</a>
<span class="sourceLineNo">321</span><a id="line.321">                throw new ParseException( "Unknown topology: " + i );</a>
<span class="sourceLineNo">322</span><a id="line.322">        }</a>
<span class="sourceLineNo">323</span><a id="line.323">    }</a>
<span class="sourceLineNo">324</span><a id="line.324">     </a>
<span class="sourceLineNo">325</span><a id="line.325">    // SAX event handler extended to parse the Genbank XML format</a>
<span class="sourceLineNo">326</span><a id="line.326">    // see details about GenbankXML format at http://www.ncbi.nlm.nih.gov/dtd/NCBI_GBSeq.mod</a>
<span class="sourceLineNo">327</span><a id="line.327">    private static class GenbankXmlHandler extends DefaultHandler</a>
<span class="sourceLineNo">328</span><a id="line.328">    {</a>
<span class="sourceLineNo">329</span><a id="line.329">        private GenbankXmlSequence m_currentSequence;</a>
<span class="sourceLineNo">330</span><a id="line.330">        private ArrayList m_sequences;</a>
<span class="sourceLineNo">331</span><a id="line.331">        private StringBuffer m_currentString;</a>
<span class="sourceLineNo">332</span><a id="line.332">        </a>
<span class="sourceLineNo">333</span><a id="line.333">        private GenbankXmlHandler()</a>
<span class="sourceLineNo">334</span><a id="line.334">        {</a>
<span class="sourceLineNo">335</span><a id="line.335">            m_sequences = new ArrayList();</a>
<span class="sourceLineNo">336</span><a id="line.336">            m_currentString = new StringBuffer();</a>
<span class="sourceLineNo">337</span><a id="line.337">        }</a>
<span class="sourceLineNo">338</span><a id="line.338">        </a>
<span class="sourceLineNo">339</span><a id="line.339">        public void startElement( String uri, String localName, String qName, </a>
<span class="sourceLineNo">340</span><a id="line.340">                                  Attributes attributes )</a>
<span class="sourceLineNo">341</span><a id="line.341">        {</a>
<span class="sourceLineNo">342</span><a id="line.342">            if( qName.equals( "GBSeq" ) )</a>
<span class="sourceLineNo">343</span><a id="line.343">                m_currentSequence = new GenbankXmlSequence();</a>
<span class="sourceLineNo">344</span><a id="line.344">            else if( qName.equals( "GBReference" ) )</a>
<span class="sourceLineNo">345</span><a id="line.345">                m_currentSequence.addNewReference();</a>
<span class="sourceLineNo">346</span><a id="line.346">            else if( qName.equals( "GBFeature" ) )</a>
<span class="sourceLineNo">347</span><a id="line.347">                m_currentSequence.addNewFeature();</a>
<span class="sourceLineNo">348</span><a id="line.348">            else if( qName.equals( "GBQualifier" ) )</a>
<span class="sourceLineNo">349</span><a id="line.349">                m_currentSequence.getCurrentFeature().addNewQualifier();</a>
<span class="sourceLineNo">350</span><a id="line.350">            else if( qName.equals( "GBInterval" ) )</a>
<span class="sourceLineNo">351</span><a id="line.351">                m_currentSequence.getCurrentFeature().addNewInterval();</a>
<span class="sourceLineNo">352</span><a id="line.352">        }</a>
<span class="sourceLineNo">353</span><a id="line.353">        </a>
<span class="sourceLineNo">354</span><a id="line.354">        public void endElement( String uri, String localName, String qName ) throws SAXException</a>
<span class="sourceLineNo">355</span><a id="line.355">        {</a>
<span class="sourceLineNo">356</span><a id="line.356">            if( qName.equals( "GBSet" ) )</a>
<span class="sourceLineNo">357</span><a id="line.357">                return;     // do nothing</a>
<span class="sourceLineNo">358</span><a id="line.358">            else if( qName.equals( "GBSeq" ) )</a>
<span class="sourceLineNo">359</span><a id="line.359">                m_sequences.add( m_currentSequence );</a>
<span class="sourceLineNo">360</span><a id="line.360">            else if( qName.equals( "GBSeq_locus" ) )</a>
<span class="sourceLineNo">361</span><a id="line.361">                m_currentSequence.setLocus( m_currentString.toString() );</a>
<span class="sourceLineNo">362</span><a id="line.362">            else if( qName.equals( "GBSeq_length" ) )</a>
<span class="sourceLineNo">363</span><a id="line.363">                m_currentSequence.setLength( m_currentString.toString() );</a>
<span class="sourceLineNo">364</span><a id="line.364">            else if( qName.equals( "GBSeq_strandedness" ) )</a>
<span class="sourceLineNo">365</span><a id="line.365">                m_currentSequence.setStrandedness( m_currentString.toString() );</a>
<span class="sourceLineNo">366</span><a id="line.366">            else if( qName.equals( "GBSeq_moltype" ) )</a>
<span class="sourceLineNo">367</span><a id="line.367">                m_currentSequence.setMolType( m_currentString.toString() );</a>
<span class="sourceLineNo">368</span><a id="line.368">            else if( qName.equals( "GBSeq_topology" ) )</a>
<span class="sourceLineNo">369</span><a id="line.369">                m_currentSequence.setTopology( m_currentString.toString() );</a>
<span class="sourceLineNo">370</span><a id="line.370">            else if( qName.equals( "GBSeq_division" ) )</a>
<span class="sourceLineNo">371</span><a id="line.371">                m_currentSequence.setDivision( m_currentString.toString() );</a>
<span class="sourceLineNo">372</span><a id="line.372">            else if( qName.equals( "GBSeq_update-date" ) )</a>
<span class="sourceLineNo">373</span><a id="line.373">                m_currentSequence.setUpdateDate( m_currentString.toString() );</a>
<span class="sourceLineNo">374</span><a id="line.374">            else if( qName.equals( "GBSeq_create-date") )</a>
<span class="sourceLineNo">375</span><a id="line.375">                m_currentSequence.setCreateDate( m_currentString.toString() );</a>
<span class="sourceLineNo">376</span><a id="line.376">            else if( qName.equals( "GBSeq_update-release" ) )</a>
<span class="sourceLineNo">377</span><a id="line.377">                m_currentSequence.setUpdateRelease( m_currentString.toString() );</a>
<span class="sourceLineNo">378</span><a id="line.378">            else if( qName.equals( "GBSeq_create-release") )</a>
<span class="sourceLineNo">379</span><a id="line.379">                m_currentSequence.setCreateRelease( m_currentString.toString() );</a>
<span class="sourceLineNo">380</span><a id="line.380">            else if( qName.equals( "GBSeq_definition" ) )</a>
<span class="sourceLineNo">381</span><a id="line.381">                m_currentSequence.setDefinition( m_currentString.toString() );</a>
<span class="sourceLineNo">382</span><a id="line.382">            else if( qName.equals( "GBSeq_primary-accession" ) )</a>
<span class="sourceLineNo">383</span><a id="line.383">                m_currentSequence.setPrimaryAccession( m_currentString.toString() );</a>
<span class="sourceLineNo">384</span><a id="line.384">            else if( qName.equals( "GBSeq_entry-version" ) )</a>
<span class="sourceLineNo">385</span><a id="line.385">                m_currentSequence.setEntryVersion( m_currentString.toString() );</a>
<span class="sourceLineNo">386</span><a id="line.386">            else if( qName.equals( "GBSeq_accession-version" ) )</a>
<span class="sourceLineNo">387</span><a id="line.387">                m_currentSequence.setAccessionVersion( m_currentString.toString() );</a>
<span class="sourceLineNo">388</span><a id="line.388">            else if( qName.equals( "GBSeq_other-seqids" ) )</a>
<span class="sourceLineNo">389</span><a id="line.389">                return;     // nothing to do</a>
<span class="sourceLineNo">390</span><a id="line.390">            else if( qName.equals( "GBSeqid" ) )</a>
<span class="sourceLineNo">391</span><a id="line.391">                m_currentSequence.addOtherSequenceId( m_currentString.toString() );</a>
<span class="sourceLineNo">392</span><a id="line.392">            else if( qName.equals( "GBSeq_secondary-accessions" ) )</a>
<span class="sourceLineNo">393</span><a id="line.393">                return;     // nothing to do</a>
<span class="sourceLineNo">394</span><a id="line.394">            else if( qName.equals( "GBSecondary-accn" ) )</a>
<span class="sourceLineNo">395</span><a id="line.395">                m_currentSequence.addSecondaryAccession( m_currentString.toString() );</a>
<span class="sourceLineNo">396</span><a id="line.396">            else if( qName.equals( "GBSeq_keywords" ) )</a>
<span class="sourceLineNo">397</span><a id="line.397">                return;     // nothing to do</a>
<span class="sourceLineNo">398</span><a id="line.398">            else if( qName.equals( "GBKeyword" ) )</a>
<span class="sourceLineNo">399</span><a id="line.399">                m_currentSequence.addKeyword( m_currentString.toString() );</a>
<span class="sourceLineNo">400</span><a id="line.400">            else if( qName.equals( "GBSeq_segment" ) )</a>
<span class="sourceLineNo">401</span><a id="line.401">                m_currentSequence.setSegment( m_currentString.toString() );</a>
<span class="sourceLineNo">402</span><a id="line.402">            else if( qName.equals( "GBSeq_source" ) )</a>
<span class="sourceLineNo">403</span><a id="line.403">                m_currentSequence.setSource( m_currentString.toString() );</a>
<span class="sourceLineNo">404</span><a id="line.404">            else if( qName.equals( "GBSeq_organism" ) )</a>
<span class="sourceLineNo">405</span><a id="line.405">                m_currentSequence.setOrganism( m_currentString.toString() );</a>
<span class="sourceLineNo">406</span><a id="line.406">            else if( qName.equals( "GBSeq_taxonomy" ) )</a>
<span class="sourceLineNo">407</span><a id="line.407">                m_currentSequence.setTaxonomy( m_currentString.toString() );</a>
<span class="sourceLineNo">408</span><a id="line.408">            else if( qName.equals( "GBSeq_references" ) )</a>
<span class="sourceLineNo">409</span><a id="line.409">                return;     // nothing to do</a>
<span class="sourceLineNo">410</span><a id="line.410">            else if( qName.equals( "GBReference" ) )</a>
<span class="sourceLineNo">411</span><a id="line.411">                return;     // nothing to do</a>
<span class="sourceLineNo">412</span><a id="line.412">            else if( qName.equals( "GBReference_reference" ) )</a>
<span class="sourceLineNo">413</span><a id="line.413">                m_currentSequence.getCurrentReference().setReference( m_currentString.toString() );</a>
<span class="sourceLineNo">414</span><a id="line.414">            else if( qName.equals( "GBReference_authors" ) )</a>
<span class="sourceLineNo">415</span><a id="line.415">                return;     //nothing to do</a>
<span class="sourceLineNo">416</span><a id="line.416">            else if( qName.equals( "GBAuthor" ) )</a>
<span class="sourceLineNo">417</span><a id="line.417">                m_currentSequence.getCurrentReference().addAuthor( m_currentString.toString() );</a>
<span class="sourceLineNo">418</span><a id="line.418">            else if( qName.equals( "GBReference_consortium" ) )</a>
<span class="sourceLineNo">419</span><a id="line.419">                m_currentSequence.getCurrentReference().setConsortium( m_currentString.toString() );</a>
<span class="sourceLineNo">420</span><a id="line.420">            else if( qName.equals( "GBReference_title" ) )</a>
<span class="sourceLineNo">421</span><a id="line.421">                m_currentSequence.getCurrentReference().setTitle( m_currentString.toString() );</a>
<span class="sourceLineNo">422</span><a id="line.422">            else if( qName.equals( "GBReference_journal" ) )</a>
<span class="sourceLineNo">423</span><a id="line.423">                m_currentSequence.getCurrentReference().setJournal( m_currentString.toString() );</a>
<span class="sourceLineNo">424</span><a id="line.424">            else if( qName.equals( "GBReference_medline" ) )</a>
<span class="sourceLineNo">425</span><a id="line.425">                m_currentSequence.getCurrentReference().setMedline( m_currentString.toString() );</a>
<span class="sourceLineNo">426</span><a id="line.426">            else if( qName.equals( "GBReference_pubmed" ) )</a>
<span class="sourceLineNo">427</span><a id="line.427">                m_currentSequence.getCurrentReference().setPubmed( m_currentString.toString() );</a>
<span class="sourceLineNo">428</span><a id="line.428">            else if( qName.equals( "GBReference_remark" ) )</a>
<span class="sourceLineNo">429</span><a id="line.429">                m_currentSequence.getCurrentReference().setRemark( m_currentString.toString() );</a>
<span class="sourceLineNo">430</span><a id="line.430">            else if( qName.equals( "GBSeq_comment" ) )</a>
<span class="sourceLineNo">431</span><a id="line.431">                m_currentSequence.setComment( m_currentString.toString() );</a>
<span class="sourceLineNo">432</span><a id="line.432">            else if( qName.equals( "GBSeq_primary" ) )</a>
<span class="sourceLineNo">433</span><a id="line.433">                m_currentSequence.setPrimary( m_currentString.toString() );</a>
<span class="sourceLineNo">434</span><a id="line.434">            else if( qName.equals( "GBSeq_source-db" ) )</a>
<span class="sourceLineNo">435</span><a id="line.435">                m_currentSequence.setSourceDb( m_currentString.toString() );</a>
<span class="sourceLineNo">436</span><a id="line.436">            else if( qName.equals( "GBSeq_database-reference" ) )</a>
<span class="sourceLineNo">437</span><a id="line.437">                m_currentSequence.setDatabaseReference( m_currentString.toString() );</a>
<span class="sourceLineNo">438</span><a id="line.438">            else if( qName.equals( "GBSeq_feature-table" ) )</a>
<span class="sourceLineNo">439</span><a id="line.439">                return;     // do nothing</a>
<span class="sourceLineNo">440</span><a id="line.440">            else if( qName.equals( "GBFeature" ) )</a>
<span class="sourceLineNo">441</span><a id="line.441">                return;     // do nothing</a>
<span class="sourceLineNo">442</span><a id="line.442">            else if( qName.equals( "GBFeature_key" ) )</a>
<span class="sourceLineNo">443</span><a id="line.443">                m_currentSequence.getCurrentFeature().setKey( m_currentString.toString() );</a>
<span class="sourceLineNo">444</span><a id="line.444">            else if( qName.equals( "GBFeature_location" ) )</a>
<span class="sourceLineNo">445</span><a id="line.445">                m_currentSequence.getCurrentFeature().setLocation( m_currentString.toString() );</a>
<span class="sourceLineNo">446</span><a id="line.446">            else if( qName.equals( "GBFeature_intervals" ) )</a>
<span class="sourceLineNo">447</span><a id="line.447">                return;     // do nothing</a>
<span class="sourceLineNo">448</span><a id="line.448">            else if( qName.equals( "GBInterval" ) )</a>
<span class="sourceLineNo">449</span><a id="line.449">                return;     // do nothing</a>
<span class="sourceLineNo">450</span><a id="line.450">            else if( qName.equals( "GBInterval_from" ) )</a>
<span class="sourceLineNo">451</span><a id="line.451">                m_currentSequence.getCurrentFeature().getCurrentInterval().setFrom( m_currentString.toString() );</a>
<span class="sourceLineNo">452</span><a id="line.452">            else if( qName.equals( "GBInterval_to" ) )</a>
<span class="sourceLineNo">453</span><a id="line.453">                m_currentSequence.getCurrentFeature().getCurrentInterval().setTo( m_currentString.toString() );</a>
<span class="sourceLineNo">454</span><a id="line.454">            else if( qName.equals( "GBInterval_point" ) )</a>
<span class="sourceLineNo">455</span><a id="line.455">                m_currentSequence.getCurrentFeature().getCurrentInterval().setPoint( m_currentString.toString() );</a>
<span class="sourceLineNo">456</span><a id="line.456">            else if( qName.equals( "GBInterval_accession" ) )</a>
<span class="sourceLineNo">457</span><a id="line.457">                m_currentSequence.getCurrentFeature().getCurrentInterval().setAccession( m_currentString.toString() );</a>
<span class="sourceLineNo">458</span><a id="line.458">            else if( qName.equals( "GBFeature_quals" ) )</a>
<span class="sourceLineNo">459</span><a id="line.459">                return;     // do nothing</a>
<span class="sourceLineNo">460</span><a id="line.460">            else if( qName.equals( "GBQualifier" ) )</a>
<span class="sourceLineNo">461</span><a id="line.461">                return;     // do nothing</a>
<span class="sourceLineNo">462</span><a id="line.462">            else if( qName.equals( "GBQualifier_name" ) )</a>
<span class="sourceLineNo">463</span><a id="line.463">                m_currentSequence.getCurrentFeature().getCurrentQualifier().setName( m_currentString.toString() );</a>
<span class="sourceLineNo">464</span><a id="line.464">            else if( qName.equals( "GBQualifier_value" ) )</a>
<span class="sourceLineNo">465</span><a id="line.465">                m_currentSequence.getCurrentFeature().getCurrentQualifier().setValue( m_currentString.toString() );</a>
<span class="sourceLineNo">466</span><a id="line.466">            else if( qName.equals( "GBSeq_sequence" ) )</a>
<span class="sourceLineNo">467</span><a id="line.467">                m_currentSequence.setSequence( m_currentString.toString() );</a>
<span class="sourceLineNo">468</span><a id="line.468">            else if( qName.equals( "GBSeq_contig" ) )</a>
<span class="sourceLineNo">469</span><a id="line.469">                m_currentSequence.setContig( m_currentString.toString() );</a>
<span class="sourceLineNo">470</span><a id="line.470">            else</a>
<span class="sourceLineNo">471</span><a id="line.471">                throw new SAXException( "Unrecognized tag: " + qName );</a>
<span class="sourceLineNo">472</span><a id="line.472">            </a>
<span class="sourceLineNo">473</span><a id="line.473">            m_currentString.delete( 0, m_currentString.length() );</a>
<span class="sourceLineNo">474</span><a id="line.474">        }</a>
<span class="sourceLineNo">475</span><a id="line.475">        </a>
<span class="sourceLineNo">476</span><a id="line.476">        public void characters( char[] ch, int start, int length )</a>
<span class="sourceLineNo">477</span><a id="line.477">        {</a>
<span class="sourceLineNo">478</span><a id="line.478">            m_currentString.append( ch, start, length );</a>
<span class="sourceLineNo">479</span><a id="line.479">        }</a>
<span class="sourceLineNo">480</span><a id="line.480">        </a>
<span class="sourceLineNo">481</span><a id="line.481">        private ArrayList getSequences()</a>
<span class="sourceLineNo">482</span><a id="line.482">        {</a>
<span class="sourceLineNo">483</span><a id="line.483">            return m_sequences;</a>
<span class="sourceLineNo">484</span><a id="line.484">        }</a>
<span class="sourceLineNo">485</span><a id="line.485">    }</a>
<span class="sourceLineNo">486</span><a id="line.486">    </a>
<span class="sourceLineNo">487</span><a id="line.487">    // see GBSeq at http://www.ncbi.nlm.nih.gov/dtd/NCBI_GBSeq.mod</a>
<span class="sourceLineNo">488</span><a id="line.488">    private static class GenbankXmlSequence</a>
<span class="sourceLineNo">489</span><a id="line.489">    {</a>
<span class="sourceLineNo">490</span><a id="line.490">        private String m_locus;</a>
<span class="sourceLineNo">491</span><a id="line.491">        private String m_length;</a>
<span class="sourceLineNo">492</span><a id="line.492">        private String m_strandedness;</a>
<span class="sourceLineNo">493</span><a id="line.493">        private String m_moltype;</a>
<span class="sourceLineNo">494</span><a id="line.494">        private String m_topology;</a>
<span class="sourceLineNo">495</span><a id="line.495">        private String m_division;</a>
<span class="sourceLineNo">496</span><a id="line.496">        private String m_updateDate;</a>
<span class="sourceLineNo">497</span><a id="line.497">        private String m_createDate;</a>
<span class="sourceLineNo">498</span><a id="line.498">        private String m_updateRelease;</a>
<span class="sourceLineNo">499</span><a id="line.499">        private String m_createRelease;</a>
<span class="sourceLineNo">500</span><a id="line.500">        private String m_definition;</a>
<span class="sourceLineNo">501</span><a id="line.501">        private String m_primaryAccession;</a>
<span class="sourceLineNo">502</span><a id="line.502">        private String m_entryVersion;</a>
<span class="sourceLineNo">503</span><a id="line.503">        private String m_accessionVersion;</a>
<span class="sourceLineNo">504</span><a id="line.504">        private ArrayList m_otherSeqIds;</a>
<span class="sourceLineNo">505</span><a id="line.505">        private ArrayList m_secondaryAccessions;</a>
<span class="sourceLineNo">506</span><a id="line.506">        private ArrayList m_keywords;</a>
<span class="sourceLineNo">507</span><a id="line.507">        private String m_segment;</a>
<span class="sourceLineNo">508</span><a id="line.508">        private String m_source;</a>
<span class="sourceLineNo">509</span><a id="line.509">        private String m_organism;</a>
<span class="sourceLineNo">510</span><a id="line.510">        private String m_taxonomy;</a>
<span class="sourceLineNo">511</span><a id="line.511">        private ArrayList m_references;</a>
<span class="sourceLineNo">512</span><a id="line.512">        private GenbankXmlReference m_currReference;</a>
<span class="sourceLineNo">513</span><a id="line.513">        private String m_comment;</a>
<span class="sourceLineNo">514</span><a id="line.514">        private String m_primary;</a>
<span class="sourceLineNo">515</span><a id="line.515">        private String m_sourceDb;</a>
<span class="sourceLineNo">516</span><a id="line.516">        private String m_databaseReference;</a>
<span class="sourceLineNo">517</span><a id="line.517">        private ArrayList m_features;</a>
<span class="sourceLineNo">518</span><a id="line.518">        private GenbankXmlFeature m_currFeature;</a>
<span class="sourceLineNo">519</span><a id="line.519">        private String m_sequence;</a>
<span class="sourceLineNo">520</span><a id="line.520">        private String m_contig;</a>
<span class="sourceLineNo">521</span><a id="line.521">        </a>
<span class="sourceLineNo">522</span><a id="line.522">        private GenbankXmlSequence()</a>
<span class="sourceLineNo">523</span><a id="line.523">        {</a>
<span class="sourceLineNo">524</span><a id="line.524">            m_otherSeqIds = new ArrayList();</a>
<span class="sourceLineNo">525</span><a id="line.525">            m_secondaryAccessions = new ArrayList();</a>
<span class="sourceLineNo">526</span><a id="line.526">            m_keywords = new ArrayList();</a>
<span class="sourceLineNo">527</span><a id="line.527">            m_references = new ArrayList();</a>
<span class="sourceLineNo">528</span><a id="line.528">            m_features = new ArrayList();</a>
<span class="sourceLineNo">529</span><a id="line.529">        }</a>
<span class="sourceLineNo">530</span><a id="line.530">        </a>
<span class="sourceLineNo">531</span><a id="line.531">        private void setLocus( String locus )</a>
<span class="sourceLineNo">532</span><a id="line.532">        {</a>
<span class="sourceLineNo">533</span><a id="line.533">            m_locus = locus;</a>
<span class="sourceLineNo">534</span><a id="line.534">        }</a>
<span class="sourceLineNo">535</span><a id="line.535">        </a>
<span class="sourceLineNo">536</span><a id="line.536">        private String getLocus()</a>
<span class="sourceLineNo">537</span><a id="line.537">        {</a>
<span class="sourceLineNo">538</span><a id="line.538">            return m_locus;</a>
<span class="sourceLineNo">539</span><a id="line.539">        }</a>
<span class="sourceLineNo">540</span><a id="line.540">        </a>
<span class="sourceLineNo">541</span><a id="line.541">        private void setLength( String length )</a>
<span class="sourceLineNo">542</span><a id="line.542">        {</a>
<span class="sourceLineNo">543</span><a id="line.543">            m_length = length;</a>
<span class="sourceLineNo">544</span><a id="line.544">        }</a>
<span class="sourceLineNo">545</span><a id="line.545">        </a>
<span class="sourceLineNo">546</span><a id="line.546">        private String getLength()</a>
<span class="sourceLineNo">547</span><a id="line.547">        {</a>
<span class="sourceLineNo">548</span><a id="line.548">            return m_length;</a>
<span class="sourceLineNo">549</span><a id="line.549">        }</a>
<span class="sourceLineNo">550</span><a id="line.550">        </a>
<span class="sourceLineNo">551</span><a id="line.551">        private void setStrandedness( String strandedness )</a>
<span class="sourceLineNo">552</span><a id="line.552">        {</a>
<span class="sourceLineNo">553</span><a id="line.553">            m_strandedness = strandedness;</a>
<span class="sourceLineNo">554</span><a id="line.554">        }</a>
<span class="sourceLineNo">555</span><a id="line.555">        </a>
<span class="sourceLineNo">556</span><a id="line.556">        private String getStrandedness()</a>
<span class="sourceLineNo">557</span><a id="line.557">        {</a>
<span class="sourceLineNo">558</span><a id="line.558">            return m_strandedness;</a>
<span class="sourceLineNo">559</span><a id="line.559">        }</a>
<span class="sourceLineNo">560</span><a id="line.560">        </a>
<span class="sourceLineNo">561</span><a id="line.561">        private void setMolType( String moltype )</a>
<span class="sourceLineNo">562</span><a id="line.562">        {</a>
<span class="sourceLineNo">563</span><a id="line.563">            m_moltype = moltype;</a>
<span class="sourceLineNo">564</span><a id="line.564">        }</a>
<span class="sourceLineNo">565</span><a id="line.565">        </a>
<span class="sourceLineNo">566</span><a id="line.566">        private String getMolType()</a>
<span class="sourceLineNo">567</span><a id="line.567">        {</a>
<span class="sourceLineNo">568</span><a id="line.568">            return m_moltype;</a>
<span class="sourceLineNo">569</span><a id="line.569">        }</a>
<span class="sourceLineNo">570</span><a id="line.570">        </a>
<span class="sourceLineNo">571</span><a id="line.571">        private void setTopology( String topology )</a>
<span class="sourceLineNo">572</span><a id="line.572">        {</a>
<span class="sourceLineNo">573</span><a id="line.573">            m_topology = topology;</a>
<span class="sourceLineNo">574</span><a id="line.574">        }</a>
<span class="sourceLineNo">575</span><a id="line.575">        </a>
<span class="sourceLineNo">576</span><a id="line.576">        private String getTopology()</a>
<span class="sourceLineNo">577</span><a id="line.577">        {</a>
<span class="sourceLineNo">578</span><a id="line.578">            return m_topology;</a>
<span class="sourceLineNo">579</span><a id="line.579">        }</a>
<span class="sourceLineNo">580</span><a id="line.580">        </a>
<span class="sourceLineNo">581</span><a id="line.581">        private void setDivision( String division )</a>
<span class="sourceLineNo">582</span><a id="line.582">        {</a>
<span class="sourceLineNo">583</span><a id="line.583">            m_division = division;</a>
<span class="sourceLineNo">584</span><a id="line.584">        }</a>
<span class="sourceLineNo">585</span><a id="line.585">        </a>
<span class="sourceLineNo">586</span><a id="line.586">        private String getDivision()</a>
<span class="sourceLineNo">587</span><a id="line.587">        {</a>
<span class="sourceLineNo">588</span><a id="line.588">            return m_division;</a>
<span class="sourceLineNo">589</span><a id="line.589">        }</a>
<span class="sourceLineNo">590</span><a id="line.590">        </a>
<span class="sourceLineNo">591</span><a id="line.591">        private void setUpdateDate( String updateDate )</a>
<span class="sourceLineNo">592</span><a id="line.592">        {</a>
<span class="sourceLineNo">593</span><a id="line.593">            m_updateDate = updateDate;</a>
<span class="sourceLineNo">594</span><a id="line.594">        }</a>
<span class="sourceLineNo">595</span><a id="line.595">        </a>
<span class="sourceLineNo">596</span><a id="line.596">        private String getUpdateDate()</a>
<span class="sourceLineNo">597</span><a id="line.597">        {</a>
<span class="sourceLineNo">598</span><a id="line.598">            return m_updateDate;</a>
<span class="sourceLineNo">599</span><a id="line.599">        }</a>
<span class="sourceLineNo">600</span><a id="line.600">        </a>
<span class="sourceLineNo">601</span><a id="line.601">        private void setCreateDate( String createDate )</a>
<span class="sourceLineNo">602</span><a id="line.602">        {</a>
<span class="sourceLineNo">603</span><a id="line.603">            m_createDate = createDate;</a>
<span class="sourceLineNo">604</span><a id="line.604">        }</a>
<span class="sourceLineNo">605</span><a id="line.605">        </a>
<span class="sourceLineNo">606</span><a id="line.606">        String getCreateDate()</a>
<span class="sourceLineNo">607</span><a id="line.607">        {</a>
<span class="sourceLineNo">608</span><a id="line.608">            return m_createDate;</a>
<span class="sourceLineNo">609</span><a id="line.609">        }</a>
<span class="sourceLineNo">610</span><a id="line.610">        </a>
<span class="sourceLineNo">611</span><a id="line.611">        private void setUpdateRelease( String updateRelease )</a>
<span class="sourceLineNo">612</span><a id="line.612">        {</a>
<span class="sourceLineNo">613</span><a id="line.613">            m_updateRelease = updateRelease;</a>
<span class="sourceLineNo">614</span><a id="line.614">        }</a>
<span class="sourceLineNo">615</span><a id="line.615">        </a>
<span class="sourceLineNo">616</span><a id="line.616">        String getUpdateRelease()</a>
<span class="sourceLineNo">617</span><a id="line.617">        {</a>
<span class="sourceLineNo">618</span><a id="line.618">            return m_updateRelease;</a>
<span class="sourceLineNo">619</span><a id="line.619">        }</a>
<span class="sourceLineNo">620</span><a id="line.620">        </a>
<span class="sourceLineNo">621</span><a id="line.621">        private void setCreateRelease( String createRelease )</a>
<span class="sourceLineNo">622</span><a id="line.622">        {</a>
<span class="sourceLineNo">623</span><a id="line.623">            m_createRelease = createRelease;</a>
<span class="sourceLineNo">624</span><a id="line.624">        }</a>
<span class="sourceLineNo">625</span><a id="line.625">        </a>
<span class="sourceLineNo">626</span><a id="line.626">        String getCreateRelease()</a>
<span class="sourceLineNo">627</span><a id="line.627">        {</a>
<span class="sourceLineNo">628</span><a id="line.628">            return m_createRelease;</a>
<span class="sourceLineNo">629</span><a id="line.629">        }</a>
<span class="sourceLineNo">630</span><a id="line.630">        </a>
<span class="sourceLineNo">631</span><a id="line.631">        private void setDefinition( String definition )</a>
<span class="sourceLineNo">632</span><a id="line.632">        {</a>
<span class="sourceLineNo">633</span><a id="line.633">            m_definition = definition;</a>
<span class="sourceLineNo">634</span><a id="line.634">        }</a>
<span class="sourceLineNo">635</span><a id="line.635">        </a>
<span class="sourceLineNo">636</span><a id="line.636">        private String getDefinition()</a>
<span class="sourceLineNo">637</span><a id="line.637">        {</a>
<span class="sourceLineNo">638</span><a id="line.638">            return m_definition;</a>
<span class="sourceLineNo">639</span><a id="line.639">        }</a>
<span class="sourceLineNo">640</span><a id="line.640">        </a>
<span class="sourceLineNo">641</span><a id="line.641">        private void setPrimaryAccession( String primaryAccession )</a>
<span class="sourceLineNo">642</span><a id="line.642">        {</a>
<span class="sourceLineNo">643</span><a id="line.643">            m_primaryAccession = primaryAccession;</a>
<span class="sourceLineNo">644</span><a id="line.644">        }</a>
<span class="sourceLineNo">645</span><a id="line.645">        </a>
<span class="sourceLineNo">646</span><a id="line.646">        private String getPrimaryAccession()</a>
<span class="sourceLineNo">647</span><a id="line.647">        {</a>
<span class="sourceLineNo">648</span><a id="line.648">            return m_primaryAccession;</a>
<span class="sourceLineNo">649</span><a id="line.649">        }</a>
<span class="sourceLineNo">650</span><a id="line.650">        </a>
<span class="sourceLineNo">651</span><a id="line.651">        private void setEntryVersion( String entryVersion )</a>
<span class="sourceLineNo">652</span><a id="line.652">        {</a>
<span class="sourceLineNo">653</span><a id="line.653">            m_entryVersion = entryVersion;</a>
<span class="sourceLineNo">654</span><a id="line.654">        }</a>
<span class="sourceLineNo">655</span><a id="line.655">        </a>
<span class="sourceLineNo">656</span><a id="line.656">        String getEntryVersion()</a>
<span class="sourceLineNo">657</span><a id="line.657">        {</a>
<span class="sourceLineNo">658</span><a id="line.658">            return m_entryVersion;</a>
<span class="sourceLineNo">659</span><a id="line.659">        }</a>
<span class="sourceLineNo">660</span><a id="line.660">        </a>
<span class="sourceLineNo">661</span><a id="line.661">        private void setAccessionVersion( String accessionVersion )</a>
<span class="sourceLineNo">662</span><a id="line.662">        {</a>
<span class="sourceLineNo">663</span><a id="line.663">            m_accessionVersion = accessionVersion;</a>
<span class="sourceLineNo">664</span><a id="line.664">        }</a>
<span class="sourceLineNo">665</span><a id="line.665">        </a>
<span class="sourceLineNo">666</span><a id="line.666">        private String getAccessionVersion()</a>
<span class="sourceLineNo">667</span><a id="line.667">        {</a>
<span class="sourceLineNo">668</span><a id="line.668">            return m_accessionVersion;</a>
<span class="sourceLineNo">669</span><a id="line.669">        }</a>
<span class="sourceLineNo">670</span><a id="line.670">        </a>
<span class="sourceLineNo">671</span><a id="line.671">        private void addOtherSequenceId( String seqId )</a>
<span class="sourceLineNo">672</span><a id="line.672">        {</a>
<span class="sourceLineNo">673</span><a id="line.673">            m_otherSeqIds.add( seqId );</a>
<span class="sourceLineNo">674</span><a id="line.674">        }</a>
<span class="sourceLineNo">675</span><a id="line.675">        </a>
<span class="sourceLineNo">676</span><a id="line.676">        private ArrayList getOtherSequencesIds()</a>
<span class="sourceLineNo">677</span><a id="line.677">        {</a>
<span class="sourceLineNo">678</span><a id="line.678">            return new ArrayList( m_otherSeqIds );</a>
<span class="sourceLineNo">679</span><a id="line.679">        }</a>
<span class="sourceLineNo">680</span><a id="line.680">        </a>
<span class="sourceLineNo">681</span><a id="line.681">        private void addSecondaryAccession( String secondaryAccession )</a>
<span class="sourceLineNo">682</span><a id="line.682">        {</a>
<span class="sourceLineNo">683</span><a id="line.683">            m_secondaryAccessions.add( secondaryAccession );</a>
<span class="sourceLineNo">684</span><a id="line.684">        }</a>
<span class="sourceLineNo">685</span><a id="line.685">        </a>
<span class="sourceLineNo">686</span><a id="line.686">        ArrayList getSecondaryAccessions()</a>
<span class="sourceLineNo">687</span><a id="line.687">        {</a>
<span class="sourceLineNo">688</span><a id="line.688">            return new ArrayList( m_secondaryAccessions );</a>
<span class="sourceLineNo">689</span><a id="line.689">        }</a>
<span class="sourceLineNo">690</span><a id="line.690">        </a>
<span class="sourceLineNo">691</span><a id="line.691">        private void addKeyword( String keyword )</a>
<span class="sourceLineNo">692</span><a id="line.692">        {</a>
<span class="sourceLineNo">693</span><a id="line.693">            m_keywords.add( keyword );</a>
<span class="sourceLineNo">694</span><a id="line.694">        }</a>
<span class="sourceLineNo">695</span><a id="line.695">        </a>
<span class="sourceLineNo">696</span><a id="line.696">        private ArrayList getKeywords()</a>
<span class="sourceLineNo">697</span><a id="line.697">        {</a>
<span class="sourceLineNo">698</span><a id="line.698">            return new ArrayList( m_keywords );</a>
<span class="sourceLineNo">699</span><a id="line.699">        }</a>
<span class="sourceLineNo">700</span><a id="line.700">        </a>
<span class="sourceLineNo">701</span><a id="line.701">        private void setSegment( String segment )</a>
<span class="sourceLineNo">702</span><a id="line.702">        {</a>
<span class="sourceLineNo">703</span><a id="line.703">            m_segment = segment;</a>
<span class="sourceLineNo">704</span><a id="line.704">        }</a>
<span class="sourceLineNo">705</span><a id="line.705">        </a>
<span class="sourceLineNo">706</span><a id="line.706">        String getSegment()</a>
<span class="sourceLineNo">707</span><a id="line.707">        {</a>
<span class="sourceLineNo">708</span><a id="line.708">            return m_segment;</a>
<span class="sourceLineNo">709</span><a id="line.709">        }</a>
<span class="sourceLineNo">710</span><a id="line.710">        </a>
<span class="sourceLineNo">711</span><a id="line.711">        private void setSource( String source )</a>
<span class="sourceLineNo">712</span><a id="line.712">        {</a>
<span class="sourceLineNo">713</span><a id="line.713">            m_source = source;</a>
<span class="sourceLineNo">714</span><a id="line.714">        }</a>
<span class="sourceLineNo">715</span><a id="line.715">        </a>
<span class="sourceLineNo">716</span><a id="line.716">        private String getSource()</a>
<span class="sourceLineNo">717</span><a id="line.717">        {</a>
<span class="sourceLineNo">718</span><a id="line.718">            return m_source;</a>
<span class="sourceLineNo">719</span><a id="line.719">        }</a>
<span class="sourceLineNo">720</span><a id="line.720">        </a>
<span class="sourceLineNo">721</span><a id="line.721">        private void setOrganism( String organism )</a>
<span class="sourceLineNo">722</span><a id="line.722">        {</a>
<span class="sourceLineNo">723</span><a id="line.723">            m_organism = organism;</a>
<span class="sourceLineNo">724</span><a id="line.724">        }</a>
<span class="sourceLineNo">725</span><a id="line.725">        </a>
<span class="sourceLineNo">726</span><a id="line.726">        private String getOrganism()</a>
<span class="sourceLineNo">727</span><a id="line.727">        {</a>
<span class="sourceLineNo">728</span><a id="line.728">            return m_organism;</a>
<span class="sourceLineNo">729</span><a id="line.729">        }</a>
<span class="sourceLineNo">730</span><a id="line.730">        </a>
<span class="sourceLineNo">731</span><a id="line.731">        private void setTaxonomy( String taxonomy )</a>
<span class="sourceLineNo">732</span><a id="line.732">        {</a>
<span class="sourceLineNo">733</span><a id="line.733">            m_taxonomy = taxonomy;</a>
<span class="sourceLineNo">734</span><a id="line.734">        }</a>
<span class="sourceLineNo">735</span><a id="line.735">        </a>
<span class="sourceLineNo">736</span><a id="line.736">        private String getTaxonomy()</a>
<span class="sourceLineNo">737</span><a id="line.737">        {</a>
<span class="sourceLineNo">738</span><a id="line.738">            return m_taxonomy;</a>
<span class="sourceLineNo">739</span><a id="line.739">        }</a>
<span class="sourceLineNo">740</span><a id="line.740">        </a>
<span class="sourceLineNo">741</span><a id="line.741">        private void addNewReference()</a>
<span class="sourceLineNo">742</span><a id="line.742">        {</a>
<span class="sourceLineNo">743</span><a id="line.743">            m_currReference = new GenbankXmlReference();</a>
<span class="sourceLineNo">744</span><a id="line.744">            m_references.add( m_currReference );</a>
<span class="sourceLineNo">745</span><a id="line.745">        }</a>
<span class="sourceLineNo">746</span><a id="line.746">        </a>
<span class="sourceLineNo">747</span><a id="line.747">        private GenbankXmlReference getCurrentReference()</a>
<span class="sourceLineNo">748</span><a id="line.748">        {</a>
<span class="sourceLineNo">749</span><a id="line.749">            return m_currReference;</a>
<span class="sourceLineNo">750</span><a id="line.750">        }</a>
<span class="sourceLineNo">751</span><a id="line.751">        </a>
<span class="sourceLineNo">752</span><a id="line.752">        private ArrayList getReferences()</a>
<span class="sourceLineNo">753</span><a id="line.753">        {</a>
<span class="sourceLineNo">754</span><a id="line.754">            return new ArrayList( m_references );</a>
<span class="sourceLineNo">755</span><a id="line.755">        }</a>
<span class="sourceLineNo">756</span><a id="line.756">        </a>
<span class="sourceLineNo">757</span><a id="line.757">        private void setComment( String comment )</a>
<span class="sourceLineNo">758</span><a id="line.758">        {</a>
<span class="sourceLineNo">759</span><a id="line.759">            m_comment = comment;</a>
<span class="sourceLineNo">760</span><a id="line.760">        }</a>
<span class="sourceLineNo">761</span><a id="line.761">        </a>
<span class="sourceLineNo">762</span><a id="line.762">        private String getComment()</a>
<span class="sourceLineNo">763</span><a id="line.763">        {</a>
<span class="sourceLineNo">764</span><a id="line.764">            return m_comment;</a>
<span class="sourceLineNo">765</span><a id="line.765">        }</a>
<span class="sourceLineNo">766</span><a id="line.766">        </a>
<span class="sourceLineNo">767</span><a id="line.767">        private void setPrimary( String primary )</a>
<span class="sourceLineNo">768</span><a id="line.768">        {</a>
<span class="sourceLineNo">769</span><a id="line.769">            m_primary = primary;</a>
<span class="sourceLineNo">770</span><a id="line.770">        }</a>
<span class="sourceLineNo">771</span><a id="line.771">        </a>
<span class="sourceLineNo">772</span><a id="line.772">        String getPrimary()</a>
<span class="sourceLineNo">773</span><a id="line.773">        {</a>
<span class="sourceLineNo">774</span><a id="line.774">            return m_primary;</a>
<span class="sourceLineNo">775</span><a id="line.775">        }</a>
<span class="sourceLineNo">776</span><a id="line.776">        </a>
<span class="sourceLineNo">777</span><a id="line.777">        private void setSourceDb( String sourceDb )</a>
<span class="sourceLineNo">778</span><a id="line.778">        {</a>
<span class="sourceLineNo">779</span><a id="line.779">            m_sourceDb = sourceDb;</a>
<span class="sourceLineNo">780</span><a id="line.780">        }</a>
<span class="sourceLineNo">781</span><a id="line.781">        </a>
<span class="sourceLineNo">782</span><a id="line.782">        String getSourceDb()</a>
<span class="sourceLineNo">783</span><a id="line.783">        {</a>
<span class="sourceLineNo">784</span><a id="line.784">            return m_sourceDb;</a>
<span class="sourceLineNo">785</span><a id="line.785">        }</a>
<span class="sourceLineNo">786</span><a id="line.786">        </a>
<span class="sourceLineNo">787</span><a id="line.787">        private void setDatabaseReference( String databaseReference )</a>
<span class="sourceLineNo">788</span><a id="line.788">        {</a>
<span class="sourceLineNo">789</span><a id="line.789">            m_databaseReference = databaseReference;</a>
<span class="sourceLineNo">790</span><a id="line.790">        }</a>
<span class="sourceLineNo">791</span><a id="line.791">        </a>
<span class="sourceLineNo">792</span><a id="line.792">        String getDatabaseReference()</a>
<span class="sourceLineNo">793</span><a id="line.793">        {</a>
<span class="sourceLineNo">794</span><a id="line.794">            return m_databaseReference;</a>
<span class="sourceLineNo">795</span><a id="line.795">        }</a>
<span class="sourceLineNo">796</span><a id="line.796">        </a>
<span class="sourceLineNo">797</span><a id="line.797">        private void addNewFeature()</a>
<span class="sourceLineNo">798</span><a id="line.798">        {</a>
<span class="sourceLineNo">799</span><a id="line.799">            m_currFeature = new GenbankXmlFeature();</a>
<span class="sourceLineNo">800</span><a id="line.800">            m_features.add( m_currFeature );</a>
<span class="sourceLineNo">801</span><a id="line.801">        }</a>
<span class="sourceLineNo">802</span><a id="line.802">        </a>
<span class="sourceLineNo">803</span><a id="line.803">        private GenbankXmlFeature getCurrentFeature()</a>
<span class="sourceLineNo">804</span><a id="line.804">        {</a>
<span class="sourceLineNo">805</span><a id="line.805">            return m_currFeature;</a>
<span class="sourceLineNo">806</span><a id="line.806">        }</a>
<span class="sourceLineNo">807</span><a id="line.807">        </a>
<span class="sourceLineNo">808</span><a id="line.808">        private ArrayList getFeatures()</a>
<span class="sourceLineNo">809</span><a id="line.809">        {</a>
<span class="sourceLineNo">810</span><a id="line.810">            return new ArrayList( m_features );</a>
<span class="sourceLineNo">811</span><a id="line.811">        }</a>
<span class="sourceLineNo">812</span><a id="line.812">        </a>
<span class="sourceLineNo">813</span><a id="line.813">        private void setSequence( String sequence )</a>
<span class="sourceLineNo">814</span><a id="line.814">        {</a>
<span class="sourceLineNo">815</span><a id="line.815">            m_sequence = sequence;</a>
<span class="sourceLineNo">816</span><a id="line.816">        }</a>
<span class="sourceLineNo">817</span><a id="line.817">        </a>
<span class="sourceLineNo">818</span><a id="line.818">        private String getSequence()</a>
<span class="sourceLineNo">819</span><a id="line.819">        {</a>
<span class="sourceLineNo">820</span><a id="line.820">            return m_sequence;</a>
<span class="sourceLineNo">821</span><a id="line.821">        }</a>
<span class="sourceLineNo">822</span><a id="line.822">        </a>
<span class="sourceLineNo">823</span><a id="line.823">        private void setContig( String contig )</a>
<span class="sourceLineNo">824</span><a id="line.824">        {</a>
<span class="sourceLineNo">825</span><a id="line.825">            m_contig = contig;</a>
<span class="sourceLineNo">826</span><a id="line.826">        }</a>
<span class="sourceLineNo">827</span><a id="line.827">        </a>
<span class="sourceLineNo">828</span><a id="line.828">        String getContig()</a>
<span class="sourceLineNo">829</span><a id="line.829">        {</a>
<span class="sourceLineNo">830</span><a id="line.830">            return m_contig;</a>
<span class="sourceLineNo">831</span><a id="line.831">        }</a>
<span class="sourceLineNo">832</span><a id="line.832">    }</a>
<span class="sourceLineNo">833</span><a id="line.833">    </a>
<span class="sourceLineNo">834</span><a id="line.834">    // see GBReference at http://www.ncbi.nlm.nih.gov/dtd/NCBI_GBSeq.mod</a>
<span class="sourceLineNo">835</span><a id="line.835">    private static class GenbankXmlReference</a>
<span class="sourceLineNo">836</span><a id="line.836">    {</a>
<span class="sourceLineNo">837</span><a id="line.837">        private String m_reference;</a>
<span class="sourceLineNo">838</span><a id="line.838">        private ArrayList m_authors;</a>
<span class="sourceLineNo">839</span><a id="line.839">        private String m_consortium;</a>
<span class="sourceLineNo">840</span><a id="line.840">        private String m_title;</a>
<span class="sourceLineNo">841</span><a id="line.841">        private String m_journal;</a>
<span class="sourceLineNo">842</span><a id="line.842">        private String m_medline;</a>
<span class="sourceLineNo">843</span><a id="line.843">        private String m_pubmed;</a>
<span class="sourceLineNo">844</span><a id="line.844">        private String m_remark;</a>
<span class="sourceLineNo">845</span><a id="line.845">        </a>
<span class="sourceLineNo">846</span><a id="line.846">        private GenbankXmlReference()</a>
<span class="sourceLineNo">847</span><a id="line.847">        {</a>
<span class="sourceLineNo">848</span><a id="line.848">            m_authors = new ArrayList();</a>
<span class="sourceLineNo">849</span><a id="line.849">        }</a>
<span class="sourceLineNo">850</span><a id="line.850">        </a>
<span class="sourceLineNo">851</span><a id="line.851">        private void setReference( String reference )</a>
<span class="sourceLineNo">852</span><a id="line.852">        {</a>
<span class="sourceLineNo">853</span><a id="line.853">            m_reference = reference;</a>
<span class="sourceLineNo">854</span><a id="line.854">        }</a>
<span class="sourceLineNo">855</span><a id="line.855">        </a>
<span class="sourceLineNo">856</span><a id="line.856">        private String getReference()</a>
<span class="sourceLineNo">857</span><a id="line.857">        {</a>
<span class="sourceLineNo">858</span><a id="line.858">            return m_reference;</a>
<span class="sourceLineNo">859</span><a id="line.859">        }</a>
<span class="sourceLineNo">860</span><a id="line.860">        </a>
<span class="sourceLineNo">861</span><a id="line.861">        private void addAuthor( String author )</a>
<span class="sourceLineNo">862</span><a id="line.862">        {</a>
<span class="sourceLineNo">863</span><a id="line.863">            m_authors.add( author );</a>
<span class="sourceLineNo">864</span><a id="line.864">        }</a>
<span class="sourceLineNo">865</span><a id="line.865">        </a>
<span class="sourceLineNo">866</span><a id="line.866">        private ArrayList getAuthors()</a>
<span class="sourceLineNo">867</span><a id="line.867">        {</a>
<span class="sourceLineNo">868</span><a id="line.868">            return new ArrayList( m_authors );</a>
<span class="sourceLineNo">869</span><a id="line.869">        }</a>
<span class="sourceLineNo">870</span><a id="line.870">        </a>
<span class="sourceLineNo">871</span><a id="line.871">        private void setConsortium( String consortium )</a>
<span class="sourceLineNo">872</span><a id="line.872">        {</a>
<span class="sourceLineNo">873</span><a id="line.873">            m_consortium = consortium;</a>
<span class="sourceLineNo">874</span><a id="line.874">        }</a>
<span class="sourceLineNo">875</span><a id="line.875">        </a>
<span class="sourceLineNo">876</span><a id="line.876">        String getConsortium()</a>
<span class="sourceLineNo">877</span><a id="line.877">        {</a>
<span class="sourceLineNo">878</span><a id="line.878">            return m_consortium;</a>
<span class="sourceLineNo">879</span><a id="line.879">        }</a>
<span class="sourceLineNo">880</span><a id="line.880">        </a>
<span class="sourceLineNo">881</span><a id="line.881">        private void setTitle( String title )</a>
<span class="sourceLineNo">882</span><a id="line.882">        {</a>
<span class="sourceLineNo">883</span><a id="line.883">            m_title = title;</a>
<span class="sourceLineNo">884</span><a id="line.884">        }</a>
<span class="sourceLineNo">885</span><a id="line.885">        </a>
<span class="sourceLineNo">886</span><a id="line.886">        private String getTitle()</a>
<span class="sourceLineNo">887</span><a id="line.887">        {</a>
<span class="sourceLineNo">888</span><a id="line.888">            return m_title;</a>
<span class="sourceLineNo">889</span><a id="line.889">        }</a>
<span class="sourceLineNo">890</span><a id="line.890">        </a>
<span class="sourceLineNo">891</span><a id="line.891">        private void setJournal( String journal )</a>
<span class="sourceLineNo">892</span><a id="line.892">        {</a>
<span class="sourceLineNo">893</span><a id="line.893">            m_journal = journal;</a>
<span class="sourceLineNo">894</span><a id="line.894">        }</a>
<span class="sourceLineNo">895</span><a id="line.895">        </a>
<span class="sourceLineNo">896</span><a id="line.896">        private String getJournal()</a>
<span class="sourceLineNo">897</span><a id="line.897">        {</a>
<span class="sourceLineNo">898</span><a id="line.898">            return m_journal;</a>
<span class="sourceLineNo">899</span><a id="line.899">        }</a>
<span class="sourceLineNo">900</span><a id="line.900">        </a>
<span class="sourceLineNo">901</span><a id="line.901">        private void setMedline( String medline )</a>
<span class="sourceLineNo">902</span><a id="line.902">        {</a>
<span class="sourceLineNo">903</span><a id="line.903">            m_medline = medline;</a>
<span class="sourceLineNo">904</span><a id="line.904">        }</a>
<span class="sourceLineNo">905</span><a id="line.905">        </a>
<span class="sourceLineNo">906</span><a id="line.906">        private String getMedline()</a>
<span class="sourceLineNo">907</span><a id="line.907">        {</a>
<span class="sourceLineNo">908</span><a id="line.908">            return m_medline;</a>
<span class="sourceLineNo">909</span><a id="line.909">        }</a>
<span class="sourceLineNo">910</span><a id="line.910">        </a>
<span class="sourceLineNo">911</span><a id="line.911">        private void setPubmed( String pubmed )</a>
<span class="sourceLineNo">912</span><a id="line.912">        {</a>
<span class="sourceLineNo">913</span><a id="line.913">            m_pubmed = pubmed;</a>
<span class="sourceLineNo">914</span><a id="line.914">        }</a>
<span class="sourceLineNo">915</span><a id="line.915">        </a>
<span class="sourceLineNo">916</span><a id="line.916">        private String getPubmed()</a>
<span class="sourceLineNo">917</span><a id="line.917">        {</a>
<span class="sourceLineNo">918</span><a id="line.918">            return m_pubmed;</a>
<span class="sourceLineNo">919</span><a id="line.919">        }</a>
<span class="sourceLineNo">920</span><a id="line.920">        </a>
<span class="sourceLineNo">921</span><a id="line.921">        private void setRemark( String remark )</a>
<span class="sourceLineNo">922</span><a id="line.922">        {</a>
<span class="sourceLineNo">923</span><a id="line.923">            m_remark = remark;</a>
<span class="sourceLineNo">924</span><a id="line.924">        }</a>
<span class="sourceLineNo">925</span><a id="line.925">        </a>
<span class="sourceLineNo">926</span><a id="line.926">        String getRemark()</a>
<span class="sourceLineNo">927</span><a id="line.927">        {</a>
<span class="sourceLineNo">928</span><a id="line.928">            return m_remark;</a>
<span class="sourceLineNo">929</span><a id="line.929">        }</a>
<span class="sourceLineNo">930</span><a id="line.930">    }</a>
<span class="sourceLineNo">931</span><a id="line.931">    </a>
<span class="sourceLineNo">932</span><a id="line.932">    // see GBFeature at http://www.ncbi.nlm.nih.gov/dtd/NCBI_GBSeq.mod</a>
<span class="sourceLineNo">933</span><a id="line.933">    private static class GenbankXmlFeature</a>
<span class="sourceLineNo">934</span><a id="line.934">    {</a>
<span class="sourceLineNo">935</span><a id="line.935">        private String m_key;</a>
<span class="sourceLineNo">936</span><a id="line.936">        private String m_location;</a>
<span class="sourceLineNo">937</span><a id="line.937">        private ArrayList m_intervals;</a>
<span class="sourceLineNo">938</span><a id="line.938">        private GenbankXmlInterval m_currInterval;</a>
<span class="sourceLineNo">939</span><a id="line.939">        private ArrayList m_qualifiers;</a>
<span class="sourceLineNo">940</span><a id="line.940">        private GenbankXmlQualifier m_currQualifier;</a>
<span class="sourceLineNo">941</span><a id="line.941">        </a>
<span class="sourceLineNo">942</span><a id="line.942">        private GenbankXmlFeature()</a>
<span class="sourceLineNo">943</span><a id="line.943">        {</a>
<span class="sourceLineNo">944</span><a id="line.944">            m_intervals = new ArrayList();</a>
<span class="sourceLineNo">945</span><a id="line.945">            m_qualifiers = new ArrayList();</a>
<span class="sourceLineNo">946</span><a id="line.946">        }</a>
<span class="sourceLineNo">947</span><a id="line.947">        </a>
<span class="sourceLineNo">948</span><a id="line.948">        private void setKey( String key )</a>
<span class="sourceLineNo">949</span><a id="line.949">        {</a>
<span class="sourceLineNo">950</span><a id="line.950">            m_key = key;</a>
<span class="sourceLineNo">951</span><a id="line.951">        }</a>
<span class="sourceLineNo">952</span><a id="line.952">        </a>
<span class="sourceLineNo">953</span><a id="line.953">        private String getKey()</a>
<span class="sourceLineNo">954</span><a id="line.954">        {</a>
<span class="sourceLineNo">955</span><a id="line.955">            return m_key;</a>
<span class="sourceLineNo">956</span><a id="line.956">        }</a>
<span class="sourceLineNo">957</span><a id="line.957">        </a>
<span class="sourceLineNo">958</span><a id="line.958">        private void setLocation( String location )</a>
<span class="sourceLineNo">959</span><a id="line.959">        {</a>
<span class="sourceLineNo">960</span><a id="line.960">            m_location = location;</a>
<span class="sourceLineNo">961</span><a id="line.961">        }</a>
<span class="sourceLineNo">962</span><a id="line.962">        </a>
<span class="sourceLineNo">963</span><a id="line.963">        private String getLocation()</a>
<span class="sourceLineNo">964</span><a id="line.964">        {</a>
<span class="sourceLineNo">965</span><a id="line.965">            return m_location;</a>
<span class="sourceLineNo">966</span><a id="line.966">        }</a>
<span class="sourceLineNo">967</span><a id="line.967">        </a>
<span class="sourceLineNo">968</span><a id="line.968">        private void addNewInterval()</a>
<span class="sourceLineNo">969</span><a id="line.969">        {</a>
<span class="sourceLineNo">970</span><a id="line.970">            m_currInterval = new GenbankXmlInterval();</a>
<span class="sourceLineNo">971</span><a id="line.971">            m_intervals.add( m_currInterval );</a>
<span class="sourceLineNo">972</span><a id="line.972">        }</a>
<span class="sourceLineNo">973</span><a id="line.973">        </a>
<span class="sourceLineNo">974</span><a id="line.974">        private GenbankXmlInterval getCurrentInterval()</a>
<span class="sourceLineNo">975</span><a id="line.975">        {</a>
<span class="sourceLineNo">976</span><a id="line.976">            return m_currInterval;</a>
<span class="sourceLineNo">977</span><a id="line.977">        }</a>
<span class="sourceLineNo">978</span><a id="line.978">        </a>
<span class="sourceLineNo">979</span><a id="line.979">        ArrayList getIntervals()</a>
<span class="sourceLineNo">980</span><a id="line.980">        {</a>
<span class="sourceLineNo">981</span><a id="line.981">            return new ArrayList( m_intervals );</a>
<span class="sourceLineNo">982</span><a id="line.982">        }</a>
<span class="sourceLineNo">983</span><a id="line.983">        </a>
<span class="sourceLineNo">984</span><a id="line.984">        private void addNewQualifier()</a>
<span class="sourceLineNo">985</span><a id="line.985">        {</a>
<span class="sourceLineNo">986</span><a id="line.986">            m_currQualifier = new GenbankXmlQualifier();</a>
<span class="sourceLineNo">987</span><a id="line.987">            m_qualifiers.add( m_currQualifier );</a>
<span class="sourceLineNo">988</span><a id="line.988">        }</a>
<span class="sourceLineNo">989</span><a id="line.989">        </a>
<span class="sourceLineNo">990</span><a id="line.990">        private GenbankXmlQualifier getCurrentQualifier()</a>
<span class="sourceLineNo">991</span><a id="line.991">        {</a>
<span class="sourceLineNo">992</span><a id="line.992">            return m_currQualifier;</a>
<span class="sourceLineNo">993</span><a id="line.993">        }</a>
<span class="sourceLineNo">994</span><a id="line.994">        </a>
<span class="sourceLineNo">995</span><a id="line.995">        private ArrayList getQualifiers()</a>
<span class="sourceLineNo">996</span><a id="line.996">        {</a>
<span class="sourceLineNo">997</span><a id="line.997">            return new ArrayList( m_qualifiers );</a>
<span class="sourceLineNo">998</span><a id="line.998">        }</a>
<span class="sourceLineNo">999</span><a id="line.999">    }</a>
<span class="sourceLineNo">1000</span><a id="line.1000">    </a>
<span class="sourceLineNo">1001</span><a id="line.1001">    // see GBQualifier at http://www.ncbi.nlm.nih.gov/dtd/NCBI_GBSeq.mod</a>
<span class="sourceLineNo">1002</span><a id="line.1002">    private static class GenbankXmlQualifier</a>
<span class="sourceLineNo">1003</span><a id="line.1003">    {</a>
<span class="sourceLineNo">1004</span><a id="line.1004">        private String m_name;</a>
<span class="sourceLineNo">1005</span><a id="line.1005">        private String m_value;</a>
<span class="sourceLineNo">1006</span><a id="line.1006">        </a>
<span class="sourceLineNo">1007</span><a id="line.1007">        private void setName( String name )</a>
<span class="sourceLineNo">1008</span><a id="line.1008">        {</a>
<span class="sourceLineNo">1009</span><a id="line.1009">            m_name = name;</a>
<span class="sourceLineNo">1010</span><a id="line.1010">        }</a>
<span class="sourceLineNo">1011</span><a id="line.1011">        </a>
<span class="sourceLineNo">1012</span><a id="line.1012">        private String getName()</a>
<span class="sourceLineNo">1013</span><a id="line.1013">        {</a>
<span class="sourceLineNo">1014</span><a id="line.1014">            return m_name;</a>
<span class="sourceLineNo">1015</span><a id="line.1015">        }</a>
<span class="sourceLineNo">1016</span><a id="line.1016">        </a>
<span class="sourceLineNo">1017</span><a id="line.1017">        private void setValue( String value )</a>
<span class="sourceLineNo">1018</span><a id="line.1018">        {</a>
<span class="sourceLineNo">1019</span><a id="line.1019">            m_value = value;</a>
<span class="sourceLineNo">1020</span><a id="line.1020">        }</a>
<span class="sourceLineNo">1021</span><a id="line.1021">        </a>
<span class="sourceLineNo">1022</span><a id="line.1022">        private String getValue()</a>
<span class="sourceLineNo">1023</span><a id="line.1023">        {</a>
<span class="sourceLineNo">1024</span><a id="line.1024">            return m_value;</a>
<span class="sourceLineNo">1025</span><a id="line.1025">        }</a>
<span class="sourceLineNo">1026</span><a id="line.1026">    }</a>
<span class="sourceLineNo">1027</span><a id="line.1027">    </a>
<span class="sourceLineNo">1028</span><a id="line.1028">    // see GBInterval at http://www.ncbi.nlm.nih.gov/dtd/NCBI_GBSeq.mod</a>
<span class="sourceLineNo">1029</span><a id="line.1029">    private static class GenbankXmlInterval</a>
<span class="sourceLineNo">1030</span><a id="line.1030">    {</a>
<span class="sourceLineNo">1031</span><a id="line.1031">        private String m_from;</a>
<span class="sourceLineNo">1032</span><a id="line.1032">        private String m_to;</a>
<span class="sourceLineNo">1033</span><a id="line.1033">        private String m_point;</a>
<span class="sourceLineNo">1034</span><a id="line.1034">        private String m_accession;</a>
<span class="sourceLineNo">1035</span><a id="line.1035">        </a>
<span class="sourceLineNo">1036</span><a id="line.1036">        private void setFrom( String from )</a>
<span class="sourceLineNo">1037</span><a id="line.1037">        {</a>
<span class="sourceLineNo">1038</span><a id="line.1038">            m_from = from;</a>
<span class="sourceLineNo">1039</span><a id="line.1039">        }</a>
<span class="sourceLineNo">1040</span><a id="line.1040">        </a>
<span class="sourceLineNo">1041</span><a id="line.1041">        String getFrom()</a>
<span class="sourceLineNo">1042</span><a id="line.1042">        {</a>
<span class="sourceLineNo">1043</span><a id="line.1043">            return m_from;</a>
<span class="sourceLineNo">1044</span><a id="line.1044">        }</a>
<span class="sourceLineNo">1045</span><a id="line.1045">        </a>
<span class="sourceLineNo">1046</span><a id="line.1046">        private void setTo( String to )</a>
<span class="sourceLineNo">1047</span><a id="line.1047">        {</a>
<span class="sourceLineNo">1048</span><a id="line.1048">            m_to = to;</a>
<span class="sourceLineNo">1049</span><a id="line.1049">        }</a>
<span class="sourceLineNo">1050</span><a id="line.1050">        </a>
<span class="sourceLineNo">1051</span><a id="line.1051">        String getTo()</a>
<span class="sourceLineNo">1052</span><a id="line.1052">        {</a>
<span class="sourceLineNo">1053</span><a id="line.1053">            return m_to;</a>
<span class="sourceLineNo">1054</span><a id="line.1054">        }</a>
<span class="sourceLineNo">1055</span><a id="line.1055">        </a>
<span class="sourceLineNo">1056</span><a id="line.1056">        private void setPoint( String point )</a>
<span class="sourceLineNo">1057</span><a id="line.1057">        {</a>
<span class="sourceLineNo">1058</span><a id="line.1058">            m_point = point;</a>
<span class="sourceLineNo">1059</span><a id="line.1059">        }</a>
<span class="sourceLineNo">1060</span><a id="line.1060">        </a>
<span class="sourceLineNo">1061</span><a id="line.1061">        String getPoint()</a>
<span class="sourceLineNo">1062</span><a id="line.1062">        {</a>
<span class="sourceLineNo">1063</span><a id="line.1063">            return m_point;</a>
<span class="sourceLineNo">1064</span><a id="line.1064">        }</a>
<span class="sourceLineNo">1065</span><a id="line.1065">        </a>
<span class="sourceLineNo">1066</span><a id="line.1066">        private void setAccession( String accession )</a>
<span class="sourceLineNo">1067</span><a id="line.1067">        {</a>
<span class="sourceLineNo">1068</span><a id="line.1068">            m_accession = accession;</a>
<span class="sourceLineNo">1069</span><a id="line.1069">        }</a>
<span class="sourceLineNo">1070</span><a id="line.1070">        </a>
<span class="sourceLineNo">1071</span><a id="line.1071">        String getAccession()</a>
<span class="sourceLineNo">1072</span><a id="line.1072">        {</a>
<span class="sourceLineNo">1073</span><a id="line.1073">            return m_accession;</a>
<span class="sourceLineNo">1074</span><a id="line.1074">        }</a>
<span class="sourceLineNo">1075</span><a id="line.1075">    }</a>
<span class="sourceLineNo">1076</span><a id="line.1076">}</a>




























































</pre>
</div>
</main>
</body>
</html>
