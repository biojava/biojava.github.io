<!DOCTYPE HTML>
<html lang="en">
<head>
<title>Source code</title>
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<main role="main">
<div class="sourceContainer">
<pre><span class="sourceLineNo">001</span><a id="line.1">package org.biojava.utils;</a>
<span class="sourceLineNo">002</span><a id="line.2"></a>
<span class="sourceLineNo">003</span><a id="line.3"></a>
<span class="sourceLineNo">004</span><a id="line.4">///////////////////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">005</span><a id="line.5">// Copyright (C) 2002  Scott McCrory</a>
<span class="sourceLineNo">006</span><a id="line.6">//</a>
<span class="sourceLineNo">007</span><a id="line.7">// This program is free software; you can redistribute it and/or</a>
<span class="sourceLineNo">008</span><a id="line.8">// modify it under the terms of the GNU Lesser General Public License</a>
<span class="sourceLineNo">009</span><a id="line.9">// as published by the Free Software Foundation; either version 2</a>
<span class="sourceLineNo">010</span><a id="line.10">// of the License, or (at your option) any later version.</a>
<span class="sourceLineNo">011</span><a id="line.11">//</a>
<span class="sourceLineNo">012</span><a id="line.12">// This program is distributed in the hope that it will be useful,</a>
<span class="sourceLineNo">013</span><a id="line.13">// but WITHOUT ANY WARRANTY; without even the implied warranty of</a>
<span class="sourceLineNo">014</span><a id="line.14">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</a>
<span class="sourceLineNo">015</span><a id="line.15">// GNU Lesser General Public License for more details.</a>
<span class="sourceLineNo">016</span><a id="line.16">//</a>
<span class="sourceLineNo">017</span><a id="line.17">// You should have received a copy of the GNU Lesser General Public License</a>
<span class="sourceLineNo">018</span><a id="line.18">// along with this program; if not, write to the Free Software</a>
<span class="sourceLineNo">019</span><a id="line.19">// Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.</a>
<span class="sourceLineNo">020</span><a id="line.20">///////////////////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">021</span><a id="line.21"></a>
<span class="sourceLineNo">022</span><a id="line.22">import java.io.BufferedReader;</a>
<span class="sourceLineNo">023</span><a id="line.23">import java.io.IOException;</a>
<span class="sourceLineNo">024</span><a id="line.24">import java.io.InputStream;</a>
<span class="sourceLineNo">025</span><a id="line.25">import java.io.InputStreamReader;</a>
<span class="sourceLineNo">026</span><a id="line.26">import java.io.ObjectInputStream;</a>
<span class="sourceLineNo">027</span><a id="line.27">import java.io.ObjectOutputStream;</a>
<span class="sourceLineNo">028</span><a id="line.28">import java.io.OutputStream;</a>
<span class="sourceLineNo">029</span><a id="line.29">import java.io.PrintWriter;</a>
<span class="sourceLineNo">030</span><a id="line.30">import java.io.StringWriter;</a>
<span class="sourceLineNo">031</span><a id="line.31">import java.util.Date;</a>
<span class="sourceLineNo">032</span><a id="line.32">import java.util.StringTokenizer;</a>
<span class="sourceLineNo">033</span><a id="line.33"></a>
<span class="sourceLineNo">034</span><a id="line.34">  /**</a>
<span class="sourceLineNo">035</span><a id="line.35">   * &lt;P&gt;Makes running external executables easier, optionally under a watched thread.</a>
<span class="sourceLineNo">036</span><a id="line.36">   *</a>
<span class="sourceLineNo">037</span><a id="line.37">   * In addition, probably the most useful feature of ExecRunner is using it to</a>
<span class="sourceLineNo">038</span><a id="line.38">   * run a command-line program and obtain its stdout and stderr results in two</a>
<span class="sourceLineNo">039</span><a id="line.39">   * strings.  This is done with exec(String) - see that method for an example.</a>
<span class="sourceLineNo">040</span><a id="line.40">   *</a>
<span class="sourceLineNo">041</span><a id="line.41">   * With acknowledgements to Michael C. Daconta, author of "Java Pitfalls,</a>
<span class="sourceLineNo">042</span><a id="line.42">   * Time Saving Solutions, and Workarounds to Improve Programs." and his</a>
<span class="sourceLineNo">043</span><a id="line.43">   * article in JavaWorld "When Runtime.exec() Won't".&lt;/P&gt;</a>
<span class="sourceLineNo">044</span><a id="line.44">   *</a>
<span class="sourceLineNo">045</span><a id="line.45">   * @author &lt;a href="mailto:smccrory@users.sourceforge.net"&gt;Scott McCrory&lt;/a&gt;.</a>
<span class="sourceLineNo">046</span><a id="line.46">   * @author Francois Pepin</a>
<span class="sourceLineNo">047</span><a id="line.47">   * @author Andreas Dr&amp;auml;ger </a>
<span class="sourceLineNo">048</span><a id="line.48">   * @version CVS $Id$</a>
<span class="sourceLineNo">049</span><a id="line.49">   */</a>
<span class="sourceLineNo">050</span><a id="line.50">  public class ExecRunner {</a>
<span class="sourceLineNo">051</span><a id="line.51"></a>
<span class="sourceLineNo">052</span><a id="line.52">      /** Win NT/2K/MEPro require cmd.exe to run programs **/</a>
<span class="sourceLineNo">053</span><a id="line.53">      private static final String WINDOWS_NT_2000_COMMAND_1 = "cmd.exe";</a>
<span class="sourceLineNo">054</span><a id="line.54"></a>
<span class="sourceLineNo">055</span><a id="line.55">      /** Win NT/2K/MEPro require the /C to specify what to run **/</a>
<span class="sourceLineNo">056</span><a id="line.56">      private static final String WINDOWS_NT_2000_COMMAND_2 = "/C";</a>
<span class="sourceLineNo">057</span><a id="line.57"></a>
<span class="sourceLineNo">058</span><a id="line.58">      /** Win 9X/MEHome require cmd.exe to run programs **/</a>
<span class="sourceLineNo">059</span><a id="line.59">      private static final String WINDOWS_9X_ME_COMMAND_1 = "command.exe";</a>
<span class="sourceLineNo">060</span><a id="line.60"></a>
<span class="sourceLineNo">061</span><a id="line.61">      /** Win 9X/MEHome require the /C to specify what to run **/</a>
<span class="sourceLineNo">062</span><a id="line.62">      private static final String WINDOWS_9X_ME_COMMAND_2 = "/C";</a>
<span class="sourceLineNo">063</span><a id="line.63"></a>
<span class="sourceLineNo">064</span><a id="line.64">      /** String to send to STDERR if program exceeds max run time **/</a>
<span class="sourceLineNo">065</span><a id="line.65">      private static final String MAX_RUN_TIME_EXCEEDED_STRING =</a>
<span class="sourceLineNo">066</span><a id="line.66">          "MAX_RUN_TIME_EXCEEDED";</a>
<span class="sourceLineNo">067</span><a id="line.67"></a>
<span class="sourceLineNo">068</span><a id="line.68">      /** String to capture STDOUT **/</a>
<span class="sourceLineNo">069</span><a id="line.69">      private String out = new String();</a>
<span class="sourceLineNo">070</span><a id="line.70"></a>
<span class="sourceLineNo">071</span><a id="line.71">      /** String to capture STDERR **/</a>
<span class="sourceLineNo">072</span><a id="line.72">      private String err = new String();</a>
<span class="sourceLineNo">073</span><a id="line.73"></a>
<span class="sourceLineNo">074</span><a id="line.74">      /** Default max run time (in seconds) **/</a>
<span class="sourceLineNo">075</span><a id="line.75">      private int maxRunTimeSecs = 0;</a>
<span class="sourceLineNo">076</span><a id="line.76"></a>
<span class="sourceLineNo">077</span><a id="line.77">      /** Flag to indicate if we've exceeded max run time **/</a>
<span class="sourceLineNo">078</span><a id="line.78">      private boolean maxRunTimeExceeded = false;</a>
<span class="sourceLineNo">079</span><a id="line.79"></a>
<span class="sourceLineNo">080</span><a id="line.80">      /**</a>
<span class="sourceLineNo">081</span><a id="line.81">       * Basic ExecRunner constructor.</a>
<span class="sourceLineNo">082</span><a id="line.82">       *</a>
<span class="sourceLineNo">083</span><a id="line.83">       */</a>
<span class="sourceLineNo">084</span><a id="line.84">      public ExecRunner() {</a>
<span class="sourceLineNo">085</span><a id="line.85">          super();</a>
<span class="sourceLineNo">086</span><a id="line.86">      }</a>
<span class="sourceLineNo">087</span><a id="line.87"></a>
<span class="sourceLineNo">088</span><a id="line.88">      /**</a>
<span class="sourceLineNo">089</span><a id="line.89">       * ExecRunner constructor which also conveniently runs exec(String).</a>
<span class="sourceLineNo">090</span><a id="line.90">       *</a>
<span class="sourceLineNo">091</span><a id="line.91">       * @param command The program or command to run</a>
<span class="sourceLineNo">092</span><a id="line.92">       * @throws ExceptionInInitializerError thrown if a problem occurs</a>
<span class="sourceLineNo">093</span><a id="line.93">       */</a>
<span class="sourceLineNo">094</span><a id="line.94">      public ExecRunner(String command) throws ExceptionInInitializerError {</a>
<span class="sourceLineNo">095</span><a id="line.95">          this();</a>
<span class="sourceLineNo">096</span><a id="line.96">          try {</a>
<span class="sourceLineNo">097</span><a id="line.97">              exec(command);</a>
<span class="sourceLineNo">098</span><a id="line.98">          }</a>
<span class="sourceLineNo">099</span><a id="line.99">          catch (IOException ioe) {</a>
<span class="sourceLineNo">100</span><a id="line.100">             throw new ExceptionInInitializerError(ioe.getMessage());</a>
<span class="sourceLineNo">101</span><a id="line.101">         }</a>
<span class="sourceLineNo">102</span><a id="line.102">         catch (InterruptedException inte) {</a>
<span class="sourceLineNo">103</span><a id="line.103">             throw new ExceptionInInitializerError(inte.getMessage());</a>
<span class="sourceLineNo">104</span><a id="line.104">         }</a>
<span class="sourceLineNo">105</span><a id="line.105"></a>
<span class="sourceLineNo">106</span><a id="line.106">     }</a>
<span class="sourceLineNo">107</span><a id="line.107">      </a>
<span class="sourceLineNo">108</span><a id="line.108">      /**</a>
<span class="sourceLineNo">109</span><a id="line.109">       * ExecRunner constructor which also conveniently runs exec(String).</a>
<span class="sourceLineNo">110</span><a id="line.110">       *</a>
<span class="sourceLineNo">111</span><a id="line.111">       * @param command The program or command to run</a>
<span class="sourceLineNo">112</span><a id="line.112">       * @param arguments An array of Strings in which every single String </a>
<span class="sourceLineNo">113</span><a id="line.113">       *   is exactly one of the program's arguments. So these arguments are</a>
<span class="sourceLineNo">114</span><a id="line.114">       *   allowed to contain white spaces and are marked as Strings by the</a>
<span class="sourceLineNo">115</span><a id="line.115">       *   system.</a>
<span class="sourceLineNo">116</span><a id="line.116">       * @throws ExceptionInInitializerError thrown if a problem occurs</a>
<span class="sourceLineNo">117</span><a id="line.117">       * @since 1.5</a>
<span class="sourceLineNo">118</span><a id="line.118">       */</a>
<span class="sourceLineNo">119</span><a id="line.119">      public ExecRunner(String command, String[] arguments) </a>
<span class="sourceLineNo">120</span><a id="line.120">        throws ExceptionInInitializerError {</a>
<span class="sourceLineNo">121</span><a id="line.121">        this();</a>
<span class="sourceLineNo">122</span><a id="line.122">        try {</a>
<span class="sourceLineNo">123</span><a id="line.123">          exec(command, arguments);</a>
<span class="sourceLineNo">124</span><a id="line.124">        } catch (IOException ioe) {</a>
<span class="sourceLineNo">125</span><a id="line.125">          throw new ExceptionInInitializerError(ioe.getMessage());</a>
<span class="sourceLineNo">126</span><a id="line.126">        } catch (InterruptedException inte) {</a>
<span class="sourceLineNo">127</span><a id="line.127">          throw new ExceptionInInitializerError(inte.getMessage());</a>
<span class="sourceLineNo">128</span><a id="line.128">        }</a>
<span class="sourceLineNo">129</span><a id="line.129">      }</a>
<span class="sourceLineNo">130</span><a id="line.130"></a>
<span class="sourceLineNo">131</span><a id="line.131">      </a>
<span class="sourceLineNo">132</span><a id="line.132">     /**</a>
<span class="sourceLineNo">133</span><a id="line.133">      * We override the &lt;code&gt;clone&lt;/code&gt; method here to prevent cloning of our class.</a>
<span class="sourceLineNo">134</span><a id="line.134">      *</a>
<span class="sourceLineNo">135</span><a id="line.135">      * @throws CloneNotSupportedException To indicate cloning is not allowed</a>
<span class="sourceLineNo">136</span><a id="line.136">      * @return Nothing ever really returned since we throw a CloneNotSupportedException</a>
<span class="sourceLineNo">137</span><a id="line.137">      **/</a>
<span class="sourceLineNo">138</span><a id="line.138">     public final Object clone() throws CloneNotSupportedException {</a>
<span class="sourceLineNo">139</span><a id="line.139"></a>
<span class="sourceLineNo">140</span><a id="line.140">         throw new java.lang.CloneNotSupportedException();</a>
<span class="sourceLineNo">141</span><a id="line.141"></a>
<span class="sourceLineNo">142</span><a id="line.142">     }</a>
<span class="sourceLineNo">143</span><a id="line.143"></a>
<span class="sourceLineNo">144</span><a id="line.144">     /**</a>
<span class="sourceLineNo">145</span><a id="line.145">      * The &lt;B&gt;exec(String)&lt;/B&gt; method runs a process inside of a watched thread.</a>
<span class="sourceLineNo">146</span><a id="line.146">      * It returns the client's exit code and feeds its STDOUT and STDERR to</a>
<span class="sourceLineNo">147</span><a id="line.147">      * ExecRunner's out and err strings, where you then use getOutString()</a>
<span class="sourceLineNo">148</span><a id="line.148">      * and getErrString() to obtain these values. </a>
<span class="sourceLineNo">149</span><a id="line.149">      * If the command String contains arguments which are Strings containing white </a>
<span class="sourceLineNo">150</span><a id="line.150">      * spaces, the method &lt;pre&gt;exec(program, arguments)&lt;/pre&gt; should be used </a>
<span class="sourceLineNo">151</span><a id="line.151">      * instead, where &lt;code&gt;arguments&lt;/code&gt; is a &lt;code&gt;String[]&lt;/code&gt; array </a>
<span class="sourceLineNo">152</span><a id="line.152">      * containing the arguments of the program.</a>
<span class="sourceLineNo">153</span><a id="line.153">      * </a>
<span class="sourceLineNo">154</span><a id="line.154">      * Example:</a>
<span class="sourceLineNo">155</span><a id="line.155">      *</a>
<span class="sourceLineNo">156</span><a id="line.156">      * &lt;pre&gt;</a>
<span class="sourceLineNo">157</span><a id="line.157">      * // Execute the program and grab the results</a>
<span class="sourceLineNo">158</span><a id="line.158">      * String out = "";</a>
<span class="sourceLineNo">159</span><a id="line.159">      * String err = "";</a>
<span class="sourceLineNo">160</span><a id="line.160">      * try {</a>
<span class="sourceLineNo">161</span><a id="line.161">      *</a>
<span class="sourceLineNo">162</span><a id="line.162">      *     ExecRunner er = new ExecRunner();</a>
<span class="sourceLineNo">163</span><a id="line.163">      *     er.setMaxRunTimeSecs(maxRunTime);</a>
<span class="sourceLineNo">164</span><a id="line.164">      *     er.exec(program);</a>
<span class="sourceLineNo">165</span><a id="line.165">      *     if (!er.getMaxRunTimeExceeded()) {</a>
<span class="sourceLineNo">166</span><a id="line.166">      *         out = er.getOutString();</a>
<span class="sourceLineNo">167</span><a id="line.167">      *         err = er.getErrString();</a>
<span class="sourceLineNo">168</span><a id="line.168">      *     }</a>
<span class="sourceLineNo">169</span><a id="line.169">      *     else {</a>
<span class="sourceLineNo">170</span><a id="line.170">      *         log.error("Maximum run time exceeded!");</a>
<span class="sourceLineNo">171</span><a id="line.171">      *         continue;</a>
<span class="sourceLineNo">172</span><a id="line.172">      *     }</a>
<span class="sourceLineNo">173</span><a id="line.173">      *</a>
<span class="sourceLineNo">174</span><a id="line.174">      * }</a>
<span class="sourceLineNo">175</span><a id="line.175">      * catch (Exception e) {</a>
<span class="sourceLineNo">176</span><a id="line.176">      *     log.error("Error executing " + program + ": " + e.getMessage());</a>
<span class="sourceLineNo">177</span><a id="line.177">      *     continue;</a>
<span class="sourceLineNo">178</span><a id="line.178">      * }</a>
<span class="sourceLineNo">179</span><a id="line.179">      * &lt;/pre&gt;</a>
<span class="sourceLineNo">180</span><a id="line.180">      *</a>
<span class="sourceLineNo">181</span><a id="line.181">      * @return The command's return code</a>
<span class="sourceLineNo">182</span><a id="line.182">      * @param command The program or command to run</a>
<span class="sourceLineNo">183</span><a id="line.183">      * @throws IOException thrown if a problem occurs</a>
<span class="sourceLineNo">184</span><a id="line.184">      * @throws InterruptedException thrown if a problem occurs</a>
<span class="sourceLineNo">185</span><a id="line.185">      */</a>
<span class="sourceLineNo">186</span><a id="line.186">     public int exec(String command) throws IOException, InterruptedException {</a>
<span class="sourceLineNo">187</span><a id="line.187"></a>
<span class="sourceLineNo">188</span><a id="line.188">         StringWriter swOut = new StringWriter();</a>
<span class="sourceLineNo">189</span><a id="line.189">         PrintWriter pwOut = new PrintWriter(swOut, true);</a>
<span class="sourceLineNo">190</span><a id="line.190"></a>
<span class="sourceLineNo">191</span><a id="line.191">         StringWriter swErr = new StringWriter();</a>
<span class="sourceLineNo">192</span><a id="line.192">         PrintWriter pwErr = new PrintWriter(swErr, true);</a>
<span class="sourceLineNo">193</span><a id="line.193"></a>
<span class="sourceLineNo">194</span><a id="line.194">         int rc = exec(command, pwOut, pwErr);</a>
<span class="sourceLineNo">195</span><a id="line.195"></a>
<span class="sourceLineNo">196</span><a id="line.196">         out = swOut.toString();</a>
<span class="sourceLineNo">197</span><a id="line.197">         err = swErr.toString();</a>
<span class="sourceLineNo">198</span><a id="line.198"></a>
<span class="sourceLineNo">199</span><a id="line.199">         return rc;</a>
<span class="sourceLineNo">200</span><a id="line.200"></a>
<span class="sourceLineNo">201</span><a id="line.201">     }</a>
<span class="sourceLineNo">202</span><a id="line.202">     </a>
<span class="sourceLineNo">203</span><a id="line.203">     </a>
<span class="sourceLineNo">204</span><a id="line.204">  /** Sometimes special cases may occur that the arguments of an external program </a>
<span class="sourceLineNo">205</span><a id="line.205">   * are Strings containing white spaces. Another example are external processes </a>
<span class="sourceLineNo">206</span><a id="line.206">   * needing the String arguments to be characterized in a special way. </a>
<span class="sourceLineNo">207</span><a id="line.207">   * In this cases it is sensefull to write every single argument in an String </a>
<span class="sourceLineNo">208</span><a id="line.208">   * array. The system itselfe will mark these arguments as Strings so that these </a>
<span class="sourceLineNo">209</span><a id="line.209">   * special encoding can be omitted. </a>
<span class="sourceLineNo">210</span><a id="line.210">   * @param command The external program to be executed.</a>
<span class="sourceLineNo">211</span><a id="line.211">   * @param arguments An array of Strings. Every entry of this array is an argument</a>
<span class="sourceLineNo">212</span><a id="line.212">   *   of the external program to be executed.</a>
<span class="sourceLineNo">213</span><a id="line.213">   * @return The command's return code</a>
<span class="sourceLineNo">214</span><a id="line.214">   * @throws IOException thrown if a problem occurs</a>
<span class="sourceLineNo">215</span><a id="line.215">   * @throws InterruptedException thrown if a problem occurs</a>
<span class="sourceLineNo">216</span><a id="line.216">   * @since 1.5</a>
<span class="sourceLineNo">217</span><a id="line.217">   */</a>
<span class="sourceLineNo">218</span><a id="line.218">  public int exec(String command, String[] arguments) </a>
<span class="sourceLineNo">219</span><a id="line.219">    throws IOException, InterruptedException {</a>
<span class="sourceLineNo">220</span><a id="line.220"></a>
<span class="sourceLineNo">221</span><a id="line.221">     StringWriter swOut = new StringWriter();</a>
<span class="sourceLineNo">222</span><a id="line.222">     PrintWriter pwOut = new PrintWriter(swOut, true);</a>
<span class="sourceLineNo">223</span><a id="line.223"></a>
<span class="sourceLineNo">224</span><a id="line.224">     StringWriter swErr = new StringWriter();</a>
<span class="sourceLineNo">225</span><a id="line.225">     PrintWriter pwErr = new PrintWriter(swErr, true);</a>
<span class="sourceLineNo">226</span><a id="line.226"></a>
<span class="sourceLineNo">227</span><a id="line.227">     int rc = exec(command, arguments, pwOut, pwErr);</a>
<span class="sourceLineNo">228</span><a id="line.228"></a>
<span class="sourceLineNo">229</span><a id="line.229">     out = swOut.toString();</a>
<span class="sourceLineNo">230</span><a id="line.230">     err = swErr.toString();</a>
<span class="sourceLineNo">231</span><a id="line.231"></a>
<span class="sourceLineNo">232</span><a id="line.232">     return rc;</a>
<span class="sourceLineNo">233</span><a id="line.233">   }</a>
<span class="sourceLineNo">234</span><a id="line.234"></a>
<span class="sourceLineNo">235</span><a id="line.235">     /**</a>
<span class="sourceLineNo">236</span><a id="line.236">      * Convenience method for calling exec with OutputStreams.</a>
<span class="sourceLineNo">237</span><a id="line.237">      *</a>
<span class="sourceLineNo">238</span><a id="line.238">      * @return The command's return code</a>
<span class="sourceLineNo">239</span><a id="line.239">      * @param command The program or command to run</a>
<span class="sourceLineNo">240</span><a id="line.240">      * @param stdoutStream java.io.OutputStream</a>
<span class="sourceLineNo">241</span><a id="line.241">      * @param stderrStream java.io.OutputStream</a>
<span class="sourceLineNo">242</span><a id="line.242">      * @throws IOException thrown if a problem occurs</a>
<span class="sourceLineNo">243</span><a id="line.243">      * @throws InterruptedException thrown if a problem occurs</a>
<span class="sourceLineNo">244</span><a id="line.244">      **/</a>
<span class="sourceLineNo">245</span><a id="line.245">     public int exec(</a>
<span class="sourceLineNo">246</span><a id="line.246">         String command,</a>
<span class="sourceLineNo">247</span><a id="line.247">         OutputStream stdoutStream,</a>
<span class="sourceLineNo">248</span><a id="line.248">         OutputStream stderrStream)</a>
<span class="sourceLineNo">249</span><a id="line.249">         throws IOException, InterruptedException {</a>
<span class="sourceLineNo">250</span><a id="line.250"></a>
<span class="sourceLineNo">251</span><a id="line.251">         PrintWriter pwOut = new PrintWriter(stdoutStream, true);</a>
<span class="sourceLineNo">252</span><a id="line.252">         PrintWriter pwErr = new PrintWriter(stderrStream, true);</a>
<span class="sourceLineNo">253</span><a id="line.253"></a>
<span class="sourceLineNo">254</span><a id="line.254">         return exec(command, pwOut, pwErr);</a>
<span class="sourceLineNo">255</span><a id="line.255">     }</a>
<span class="sourceLineNo">256</span><a id="line.256">     </a>
<span class="sourceLineNo">257</span><a id="line.257">     </a>
<span class="sourceLineNo">258</span><a id="line.258">     /**</a>
<span class="sourceLineNo">259</span><a id="line.259">      * Convenience method for calling exec with OutputStreams.</a>
<span class="sourceLineNo">260</span><a id="line.260">      *</a>
<span class="sourceLineNo">261</span><a id="line.261">      * @return The command's return code</a>
<span class="sourceLineNo">262</span><a id="line.262">      * @param command The program or command to run</a>
<span class="sourceLineNo">263</span><a id="line.263">      * @param arguments An array of Strings containing the program's arguments.</a>
<span class="sourceLineNo">264</span><a id="line.264">      * @param stdoutStream java.io.OutputStream</a>
<span class="sourceLineNo">265</span><a id="line.265">      * @param stderrStream java.io.OutputStream</a>
<span class="sourceLineNo">266</span><a id="line.266">      * @throws IOException thrown if a problem occurs</a>
<span class="sourceLineNo">267</span><a id="line.267">      * @throws InterruptedException thrown if a problem occurs</a>
<span class="sourceLineNo">268</span><a id="line.268">      * @since 1.5</a>
<span class="sourceLineNo">269</span><a id="line.269">      **/</a>
<span class="sourceLineNo">270</span><a id="line.270">     public int exec(</a>
<span class="sourceLineNo">271</span><a id="line.271">       String command,</a>
<span class="sourceLineNo">272</span><a id="line.272">       String[] arguments,</a>
<span class="sourceLineNo">273</span><a id="line.273">       OutputStream stdoutStream,</a>
<span class="sourceLineNo">274</span><a id="line.274">       OutputStream stderrStream)</a>
<span class="sourceLineNo">275</span><a id="line.275">     throws IOException, InterruptedException {</a>
<span class="sourceLineNo">276</span><a id="line.276"></a>
<span class="sourceLineNo">277</span><a id="line.277">       PrintWriter pwOut = new PrintWriter(stdoutStream, true);</a>
<span class="sourceLineNo">278</span><a id="line.278">       PrintWriter pwErr = new PrintWriter(stderrStream, true);</a>
<span class="sourceLineNo">279</span><a id="line.279"></a>
<span class="sourceLineNo">280</span><a id="line.280">       return exec(command, arguments, pwOut, pwErr);</a>
<span class="sourceLineNo">281</span><a id="line.281">     }</a>
<span class="sourceLineNo">282</span><a id="line.282"></a>
<span class="sourceLineNo">283</span><a id="line.283">     /**</a>
<span class="sourceLineNo">284</span><a id="line.284">      * The &lt;code&gt;exec(String, PrintWriter, PrintWriter)&lt;/code&gt; method runs</a>
<span class="sourceLineNo">285</span><a id="line.285">      * a process inside of a watched thread.  It returns the client's exit code</a>
<span class="sourceLineNo">286</span><a id="line.286">      * and feeds its STDOUT and STDERR to the passed-in streams.</a>
<span class="sourceLineNo">287</span><a id="line.287">      *</a>
<span class="sourceLineNo">288</span><a id="line.288">      * @return The command's return code</a>
<span class="sourceLineNo">289</span><a id="line.289">      * @param command The program or command to run</a>
<span class="sourceLineNo">290</span><a id="line.290">      * @param stdoutWriter java.io.PrintWriter</a>
<span class="sourceLineNo">291</span><a id="line.291">      * @param stderrWriter java.io.PrintWriter</a>
<span class="sourceLineNo">292</span><a id="line.292">      * @throws IOException thrown if a problem occurs</a>
<span class="sourceLineNo">293</span><a id="line.293">      * @throws InterruptedException thrown if a problem occurs</a>
<span class="sourceLineNo">294</span><a id="line.294">      **/</a>
<span class="sourceLineNo">295</span><a id="line.295">     public int exec(</a>
<span class="sourceLineNo">296</span><a id="line.296">         String command,</a>
<span class="sourceLineNo">297</span><a id="line.297">         PrintWriter stdoutWriter,</a>
<span class="sourceLineNo">298</span><a id="line.298">         PrintWriter stderrWriter)</a>
<span class="sourceLineNo">299</span><a id="line.299">         throws IOException, InterruptedException {</a>
<span class="sourceLineNo">300</span><a id="line.300"></a>
<span class="sourceLineNo">301</span><a id="line.301">         // Default exit value is non-zero to indicate a problem.</a>
<span class="sourceLineNo">302</span><a id="line.302">         int exitVal = 1;</a>
<span class="sourceLineNo">303</span><a id="line.303"></a>
<span class="sourceLineNo">304</span><a id="line.304">         ////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">305</span><a id="line.305">         Runtime rt = Runtime.getRuntime();</a>
<span class="sourceLineNo">306</span><a id="line.306">         Process proc;</a>
<span class="sourceLineNo">307</span><a id="line.307">         String[] cmd = null;</a>
<span class="sourceLineNo">308</span><a id="line.308"></a>
<span class="sourceLineNo">309</span><a id="line.309">         // First get the start time &amp; calculate comparison numbers</a>
<span class="sourceLineNo">310</span><a id="line.310">         Date startTime = new Date();</a>
<span class="sourceLineNo">311</span><a id="line.311">         long startTimeMs = startTime.getTime();</a>
<span class="sourceLineNo">312</span><a id="line.312">         long maxTimeMs = startTimeMs + (maxRunTimeSecs * 1000);</a>
<span class="sourceLineNo">313</span><a id="line.313"></a>
<span class="sourceLineNo">314</span><a id="line.314">         ////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">315</span><a id="line.315">         // First determine the OS to build the right command string</a>
<span class="sourceLineNo">316</span><a id="line.316">         String osName = System.getProperty("os.name");</a>
<span class="sourceLineNo">317</span><a id="line.317">         if (osName.equals("Windows NT") || osName.equals("Windows 2000")) {</a>
<span class="sourceLineNo">318</span><a id="line.318">             cmd = new String[3];</a>
<span class="sourceLineNo">319</span><a id="line.319">             cmd[0] = WINDOWS_NT_2000_COMMAND_1;</a>
<span class="sourceLineNo">320</span><a id="line.320">             cmd[1] = WINDOWS_NT_2000_COMMAND_2;</a>
<span class="sourceLineNo">321</span><a id="line.321">             cmd[2] = command;</a>
<span class="sourceLineNo">322</span><a id="line.322">         }</a>
<span class="sourceLineNo">323</span><a id="line.323">         else if (</a>
<span class="sourceLineNo">324</span><a id="line.324">             osName.equals("Windows 95")</a>
<span class="sourceLineNo">325</span><a id="line.325">                 || osName.equals("Windows 98")</a>
<span class="sourceLineNo">326</span><a id="line.326">                 || osName.equals("Windows ME")) {</a>
<span class="sourceLineNo">327</span><a id="line.327">             cmd = new String[3];</a>
<span class="sourceLineNo">328</span><a id="line.328">             cmd[0] = WINDOWS_9X_ME_COMMAND_1;</a>
<span class="sourceLineNo">329</span><a id="line.329">             cmd[1] = WINDOWS_9X_ME_COMMAND_2;</a>
<span class="sourceLineNo">330</span><a id="line.330">             cmd[2] = command;</a>
<span class="sourceLineNo">331</span><a id="line.331">         }</a>
<span class="sourceLineNo">332</span><a id="line.332">         else {</a>
<span class="sourceLineNo">333</span><a id="line.333">             // Linux (and probably other *nixes) prefers to be called</a>
<span class="sourceLineNo">334</span><a id="line.334">             // with each argument supplied separately, so we first</a>
<span class="sourceLineNo">335</span><a id="line.335">             // Tokenize it across spaces as the boundary.</a>
<span class="sourceLineNo">336</span><a id="line.336">     StringTokenizer st = new StringTokenizer(command, " ");</a>
<span class="sourceLineNo">337</span><a id="line.337">     cmd = new String[st.countTokens()];</a>
<span class="sourceLineNo">338</span><a id="line.338">     int token = 0;</a>
<span class="sourceLineNo">339</span><a id="line.339">     while (st.hasMoreTokens()) {</a>
<span class="sourceLineNo">340</span><a id="line.340">   String tokenString = st.nextToken();</a>
<span class="sourceLineNo">341</span><a id="line.341">   //System.out.println(tokenString);</a>
<span class="sourceLineNo">342</span><a id="line.342">   cmd[token++] = tokenString;</a>
<span class="sourceLineNo">343</span><a id="line.343">     }</a>
<span class="sourceLineNo">344</span><a id="line.344">         }</a>
<span class="sourceLineNo">345</span><a id="line.345"></a>
<span class="sourceLineNo">346</span><a id="line.346">         // Execute the command and start the two output gobblers</a>
<span class="sourceLineNo">347</span><a id="line.347">         if (cmd != null &amp;&amp; cmd.length &gt; 0) {</a>
<span class="sourceLineNo">348</span><a id="line.348">             //System.out.println("**Checkpoint** :" + cmd.length);</a>
<span class="sourceLineNo">349</span><a id="line.349">             proc = rt.exec(cmd);</a>
<span class="sourceLineNo">350</span><a id="line.350">         }</a>
<span class="sourceLineNo">351</span><a id="line.351">         else throw new IOException("Insufficient commands!");</a>
<span class="sourceLineNo">352</span><a id="line.352"></a>
<span class="sourceLineNo">353</span><a id="line.353">         StreamGobbler outputGobbler =</a>
<span class="sourceLineNo">354</span><a id="line.354">             new StreamGobbler(proc.getInputStream(), stdoutWriter);</a>
<span class="sourceLineNo">355</span><a id="line.355">         StreamGobbler errorGobbler =</a>
<span class="sourceLineNo">356</span><a id="line.356">             new StreamGobbler(proc.getErrorStream(), stderrWriter);</a>
<span class="sourceLineNo">357</span><a id="line.357">         outputGobbler.start();</a>
<span class="sourceLineNo">358</span><a id="line.358">         errorGobbler.start();</a>
<span class="sourceLineNo">359</span><a id="line.359"></a>
<span class="sourceLineNo">360</span><a id="line.360">         // Wait for the program to finish running and return the</a>
<span class="sourceLineNo">361</span><a id="line.361">         // exit value obtained from the executable</a>
<span class="sourceLineNo">362</span><a id="line.362">   while (true) {</a>
<span class="sourceLineNo">363</span><a id="line.363">     try {</a>
<span class="sourceLineNo">364</span><a id="line.364">                 exitVal = proc.exitValue();</a>
<span class="sourceLineNo">365</span><a id="line.365">                   break;</a>
<span class="sourceLineNo">366</span><a id="line.366">           }</a>
<span class="sourceLineNo">367</span><a id="line.367">           catch (IllegalThreadStateException e) {</a>
<span class="sourceLineNo">368</span><a id="line.368">                   // If we get this exception, then the process isn't</a>
<span class="sourceLineNo">369</span><a id="line.369">                   // done executing and we determine if our time is up.</a>
<span class="sourceLineNo">370</span><a id="line.370">                   if (maxRunTimeSecs &gt; 0) {</a>
<span class="sourceLineNo">371</span><a id="line.371">              Date endTime = new Date();</a>
<span class="sourceLineNo">372</span><a id="line.372">               long endTimeMs = endTime.getTime();</a>
<span class="sourceLineNo">373</span><a id="line.373">               if (endTimeMs &gt; maxTimeMs) {</a>
<span class="sourceLineNo">374</span><a id="line.374">                             // Time's up - kill the process and the gobblers and return</a>
<span class="sourceLineNo">375</span><a id="line.375">                             proc.destroy();</a>
<span class="sourceLineNo">376</span><a id="line.376">                             maxRunTimeExceeded = true;</a>
<span class="sourceLineNo">377</span><a id="line.377">                             stderrWriter.println(MAX_RUN_TIME_EXCEEDED_STRING);</a>
<span class="sourceLineNo">378</span><a id="line.378">                             outputGobbler.quit();</a>
<span class="sourceLineNo">379</span><a id="line.379">                             errorGobbler.quit();</a>
<span class="sourceLineNo">380</span><a id="line.380">           stdoutWriter.close();</a>
<span class="sourceLineNo">381</span><a id="line.381">           stderrWriter.close();</a>
<span class="sourceLineNo">382</span><a id="line.382">           proc.getOutputStream().close();</a>
<span class="sourceLineNo">383</span><a id="line.383">                             return exitVal;</a>
<span class="sourceLineNo">384</span><a id="line.384">               } else {</a>
<span class="sourceLineNo">385</span><a id="line.385">                   // Time is not up yet so wait 100 ms before testing again</a>
<span class="sourceLineNo">386</span><a id="line.386">                           Thread.sleep(100);</a>
<span class="sourceLineNo">387</span><a id="line.387">                     }</a>
<span class="sourceLineNo">388</span><a id="line.388">                   }</a>
<span class="sourceLineNo">389</span><a id="line.389">     }</a>
<span class="sourceLineNo">390</span><a id="line.390">   }</a>
<span class="sourceLineNo">391</span><a id="line.391">   </a>
<span class="sourceLineNo">392</span><a id="line.392">   ////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">393</span><a id="line.393">   // Wait for output gobblers to finish forwarding the output</a>
<span class="sourceLineNo">394</span><a id="line.394">   while (outputGobbler.isAlive() || errorGobbler.isAlive()) {</a>
<span class="sourceLineNo">395</span><a id="line.395">   }</a>
<span class="sourceLineNo">396</span><a id="line.396"></a>
<span class="sourceLineNo">397</span><a id="line.397">   ////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">398</span><a id="line.398">   // All done, flush the streams and return the exit value</a>
<span class="sourceLineNo">399</span><a id="line.399">   stdoutWriter.flush();</a>
<span class="sourceLineNo">400</span><a id="line.400">   stderrWriter.flush();</a>
<span class="sourceLineNo">401</span><a id="line.401">   stdoutWriter.close();</a>
<span class="sourceLineNo">402</span><a id="line.402">   stderrWriter.close();</a>
<span class="sourceLineNo">403</span><a id="line.403">   proc.getOutputStream().close();</a>
<span class="sourceLineNo">404</span><a id="line.404">   return exitVal;</a>
<span class="sourceLineNo">405</span><a id="line.405"></a>
<span class="sourceLineNo">406</span><a id="line.406">         }</a>
<span class="sourceLineNo">407</span><a id="line.407">   </a>
<span class="sourceLineNo">408</span><a id="line.408">   </a>
<span class="sourceLineNo">409</span><a id="line.409">   /**</a>
<span class="sourceLineNo">410</span><a id="line.410">    * The &lt;code&gt;exec(String, PrintWriter, PrintWriter)&lt;/code&gt; method runs</a>
<span class="sourceLineNo">411</span><a id="line.411">    * a process inside of a watched thread.  It returns the client's exit code</a>
<span class="sourceLineNo">412</span><a id="line.412">    * and feeds its STDOUT and STDERR to the passed-in streams.</a>
<span class="sourceLineNo">413</span><a id="line.413">    * The arguments for the external program or command are passed as an array</a>
<span class="sourceLineNo">414</span><a id="line.414">    * of Strings. This has the advantage that the arguments are allowed to </a>
<span class="sourceLineNo">415</span><a id="line.415">    * contain white spaces and are marked to be Strings by the System itselfe, </a>
<span class="sourceLineNo">416</span><a id="line.416">    * which is sometimes important. Every single argument has to be exactly one</a>
<span class="sourceLineNo">417</span><a id="line.417">    * dimension of the arguments array.</a>
<span class="sourceLineNo">418</span><a id="line.418">    *</a>
<span class="sourceLineNo">419</span><a id="line.419">    * @return The command's return code</a>
<span class="sourceLineNo">420</span><a id="line.420">    * @param command The program or command to run</a>
<span class="sourceLineNo">421</span><a id="line.421">    * @param arguments An array of Strings containing the program's arguments/options.</a>
<span class="sourceLineNo">422</span><a id="line.422">    * @param stdoutWriter java.io.PrintWriter</a>
<span class="sourceLineNo">423</span><a id="line.423">    * @param stderrWriter java.io.PrintWriter</a>
<span class="sourceLineNo">424</span><a id="line.424">    * @throws IOException thrown if a problem occurs</a>
<span class="sourceLineNo">425</span><a id="line.425">    * @throws InterruptedException thrown if a problem occurs</a>
<span class="sourceLineNo">426</span><a id="line.426">    * @since 1.5</a>
<span class="sourceLineNo">427</span><a id="line.427">    **/</a>
<span class="sourceLineNo">428</span><a id="line.428">   public int exec(</a>
<span class="sourceLineNo">429</span><a id="line.429">     String command,</a>
<span class="sourceLineNo">430</span><a id="line.430">     String[] arguments,</a>
<span class="sourceLineNo">431</span><a id="line.431">     PrintWriter stdoutWriter,</a>
<span class="sourceLineNo">432</span><a id="line.432">     PrintWriter stderrWriter)</a>
<span class="sourceLineNo">433</span><a id="line.433">     throws IOException, InterruptedException {</a>
<span class="sourceLineNo">434</span><a id="line.434"></a>
<span class="sourceLineNo">435</span><a id="line.435">     // Default exit value is non-zero to indicate a problem.</a>
<span class="sourceLineNo">436</span><a id="line.436">     int exitVal = 1;</a>
<span class="sourceLineNo">437</span><a id="line.437"></a>
<span class="sourceLineNo">438</span><a id="line.438">     ////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">439</span><a id="line.439">     Runtime rt = Runtime.getRuntime();</a>
<span class="sourceLineNo">440</span><a id="line.440">     Process proc;</a>
<span class="sourceLineNo">441</span><a id="line.441">     String[] cmd = null;</a>
<span class="sourceLineNo">442</span><a id="line.442"></a>
<span class="sourceLineNo">443</span><a id="line.443">     // First get the start time &amp; calculate comparison numbers</a>
<span class="sourceLineNo">444</span><a id="line.444">     Date startTime = new Date();</a>
<span class="sourceLineNo">445</span><a id="line.445">     long startTimeMs = startTime.getTime();</a>
<span class="sourceLineNo">446</span><a id="line.446">     long maxTimeMs = startTimeMs + (maxRunTimeSecs * 1000);</a>
<span class="sourceLineNo">447</span><a id="line.447">     int i = 0;</a>
<span class="sourceLineNo">448</span><a id="line.448"></a>
<span class="sourceLineNo">449</span><a id="line.449">     ////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">450</span><a id="line.450">     // First determine the OS to build the right command string</a>
<span class="sourceLineNo">451</span><a id="line.451">     String osName = System.getProperty("os.name");</a>
<span class="sourceLineNo">452</span><a id="line.452">     if (osName.startsWith("Windows")) {</a>
<span class="sourceLineNo">453</span><a id="line.453">       cmd = new String[3+arguments.length];</a>
<span class="sourceLineNo">454</span><a id="line.454">       if (osName.endsWith("NT") || osName.endsWith("2000")) {</a>
<span class="sourceLineNo">455</span><a id="line.455">         cmd[0] = WINDOWS_NT_2000_COMMAND_1;</a>
<span class="sourceLineNo">456</span><a id="line.456">         cmd[1] = WINDOWS_NT_2000_COMMAND_2;  </a>
<span class="sourceLineNo">457</span><a id="line.457">       } else if (osName.endsWith("95") || osName.endsWith("98") || osName.endsWith("ME")) {</a>
<span class="sourceLineNo">458</span><a id="line.458">         cmd[0] = WINDOWS_9X_ME_COMMAND_1;</a>
<span class="sourceLineNo">459</span><a id="line.459">         cmd[1] = WINDOWS_9X_ME_COMMAND_2;  </a>
<span class="sourceLineNo">460</span><a id="line.460">       }</a>
<span class="sourceLineNo">461</span><a id="line.461">       cmd[2] = command;</a>
<span class="sourceLineNo">462</span><a id="line.462">       for (i = 3; i&lt;arguments.length; i++)</a>
<span class="sourceLineNo">463</span><a id="line.463">         cmd[i] = arguments[i-3];</a>
<span class="sourceLineNo">464</span><a id="line.464">     } else {</a>
<span class="sourceLineNo">465</span><a id="line.465">       // Linux (and probably other *nixes) prefers to be called</a>
<span class="sourceLineNo">466</span><a id="line.466">       // with each argument supplied separately.</a>
<span class="sourceLineNo">467</span><a id="line.467">       cmd = new String[arguments.length+1];</a>
<span class="sourceLineNo">468</span><a id="line.468">       cmd[0] = command;</a>
<span class="sourceLineNo">469</span><a id="line.469">       for (i=1; i&lt;cmd.length; i++) </a>
<span class="sourceLineNo">470</span><a id="line.470">         cmd[i] = arguments[i-1];</a>
<span class="sourceLineNo">471</span><a id="line.471">     }</a>
<span class="sourceLineNo">472</span><a id="line.472"></a>
<span class="sourceLineNo">473</span><a id="line.473">     // Execute the command and start the two output gobblers</a>
<span class="sourceLineNo">474</span><a id="line.474">     if (cmd != null &amp;&amp; cmd.length &gt; 0) {</a>
<span class="sourceLineNo">475</span><a id="line.475">       //System.out.println("**Checkpoint** :" + cmd.length);</a>
<span class="sourceLineNo">476</span><a id="line.476">       proc = rt.exec(cmd);</a>
<span class="sourceLineNo">477</span><a id="line.477">     } else {</a>
<span class="sourceLineNo">478</span><a id="line.478">       throw new IOException("Insufficient commands!");</a>
<span class="sourceLineNo">479</span><a id="line.479">     }</a>
<span class="sourceLineNo">480</span><a id="line.480"></a>
<span class="sourceLineNo">481</span><a id="line.481">     StreamGobbler outputGobbler =</a>
<span class="sourceLineNo">482</span><a id="line.482">       new StreamGobbler(proc.getInputStream(), stdoutWriter);</a>
<span class="sourceLineNo">483</span><a id="line.483">     StreamGobbler errorGobbler =</a>
<span class="sourceLineNo">484</span><a id="line.484">       new StreamGobbler(proc.getErrorStream(), stderrWriter);</a>
<span class="sourceLineNo">485</span><a id="line.485">     outputGobbler.start();</a>
<span class="sourceLineNo">486</span><a id="line.486">     errorGobbler.start();</a>
<span class="sourceLineNo">487</span><a id="line.487"></a>
<span class="sourceLineNo">488</span><a id="line.488">     // Wait for the program to finish running and return the</a>
<span class="sourceLineNo">489</span><a id="line.489">     // exit value obtained from the executable</a>
<span class="sourceLineNo">490</span><a id="line.490">     while (true) {</a>
<span class="sourceLineNo">491</span><a id="line.491">       try {</a>
<span class="sourceLineNo">492</span><a id="line.492">         exitVal = proc.exitValue();</a>
<span class="sourceLineNo">493</span><a id="line.493">         break;</a>
<span class="sourceLineNo">494</span><a id="line.494">       } catch (IllegalThreadStateException e) {</a>
<span class="sourceLineNo">495</span><a id="line.495">         // If we get this exception, then the process isn't</a>
<span class="sourceLineNo">496</span><a id="line.496">         // done executing and we determine if our time is up.</a>
<span class="sourceLineNo">497</span><a id="line.497">         if (maxRunTimeSecs &gt; 0) {</a>
<span class="sourceLineNo">498</span><a id="line.498">           Date endTime = new Date();</a>
<span class="sourceLineNo">499</span><a id="line.499">           long endTimeMs = endTime.getTime();</a>
<span class="sourceLineNo">500</span><a id="line.500">           if (endTimeMs &gt; maxTimeMs) {</a>
<span class="sourceLineNo">501</span><a id="line.501">             // Time's up - kill the process and the gobblers and return</a>
<span class="sourceLineNo">502</span><a id="line.502">             proc.destroy();</a>
<span class="sourceLineNo">503</span><a id="line.503">             maxRunTimeExceeded = true;</a>
<span class="sourceLineNo">504</span><a id="line.504">             stderrWriter.println(MAX_RUN_TIME_EXCEEDED_STRING);</a>
<span class="sourceLineNo">505</span><a id="line.505">             outputGobbler.quit();</a>
<span class="sourceLineNo">506</span><a id="line.506">             errorGobbler.quit();</a>
<span class="sourceLineNo">507</span><a id="line.507">             stdoutWriter.close();</a>
<span class="sourceLineNo">508</span><a id="line.508">             proc.getOutputStream().close();</a>
<span class="sourceLineNo">509</span><a id="line.509">             stderrWriter.close();</a>
<span class="sourceLineNo">510</span><a id="line.510">             return exitVal;</a>
<span class="sourceLineNo">511</span><a id="line.511">           } else {</a>
<span class="sourceLineNo">512</span><a id="line.512">             // Time is not up yet so wait 100 ms before testing again</a>
<span class="sourceLineNo">513</span><a id="line.513">             Thread.sleep(100);</a>
<span class="sourceLineNo">514</span><a id="line.514">           }</a>
<span class="sourceLineNo">515</span><a id="line.515">         }</a>
<span class="sourceLineNo">516</span><a id="line.516">       }</a>
<span class="sourceLineNo">517</span><a id="line.517">     }</a>
<span class="sourceLineNo">518</span><a id="line.518"></a>
<span class="sourceLineNo">519</span><a id="line.519">         ////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">520</span><a id="line.520">           // Wait for output gobblers to finish forwarding the output</a>
<span class="sourceLineNo">521</span><a id="line.521">           while (outputGobbler.isAlive() || errorGobbler.isAlive()) {</a>
<span class="sourceLineNo">522</span><a id="line.522">           }</a>
<span class="sourceLineNo">523</span><a id="line.523"></a>
<span class="sourceLineNo">524</span><a id="line.524">         ////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">525</span><a id="line.525">           // All done, flush the streams and return the exit value</a>
<span class="sourceLineNo">526</span><a id="line.526">           stdoutWriter.flush();</a>
<span class="sourceLineNo">527</span><a id="line.527">           stderrWriter.flush();</a>
<span class="sourceLineNo">528</span><a id="line.528">     stdoutWriter.close();</a>
<span class="sourceLineNo">529</span><a id="line.529">     stderrWriter.close();</a>
<span class="sourceLineNo">530</span><a id="line.530">     proc.getOutputStream().close();</a>
<span class="sourceLineNo">531</span><a id="line.531">           return exitVal;</a>
<span class="sourceLineNo">532</span><a id="line.532"></a>
<span class="sourceLineNo">533</span><a id="line.533">   }</a>
<span class="sourceLineNo">534</span><a id="line.534"></a>
<span class="sourceLineNo">535</span><a id="line.535">     /**</a>
<span class="sourceLineNo">536</span><a id="line.536">      * Returns the error string if exec(String) was invoked.</a>
<span class="sourceLineNo">537</span><a id="line.537">      *</a>
<span class="sourceLineNo">538</span><a id="line.538">      * @return The error string if exec(String) was invoked.</a>
<span class="sourceLineNo">539</span><a id="line.539">      */</a>
<span class="sourceLineNo">540</span><a id="line.540">     public String getErrString() {</a>
<span class="sourceLineNo">541</span><a id="line.541">         return err;</a>
<span class="sourceLineNo">542</span><a id="line.542">     }</a>
<span class="sourceLineNo">543</span><a id="line.543"></a>
<span class="sourceLineNo">544</span><a id="line.544">     /**</a>
<span class="sourceLineNo">545</span><a id="line.545">      * Returns whether the maximum runtime was exceeded or not.</a>
<span class="sourceLineNo">546</span><a id="line.546">      *</a>
<span class="sourceLineNo">547</span><a id="line.547">      * @return boolean indicating whether the maximum runtime was exceeded or not.</a>
<span class="sourceLineNo">548</span><a id="line.548">      */</a>
<span class="sourceLineNo">549</span><a id="line.549">     public boolean getMaxRunTimeExceeded() {</a>
<span class="sourceLineNo">550</span><a id="line.550">         return maxRunTimeExceeded;</a>
<span class="sourceLineNo">551</span><a id="line.551">     }</a>
<span class="sourceLineNo">552</span><a id="line.552"></a>
<span class="sourceLineNo">553</span><a id="line.553">     /**</a>
<span class="sourceLineNo">554</span><a id="line.554">      * Returns the maximum run time in seconds for this object.</a>
<span class="sourceLineNo">555</span><a id="line.555">      *</a>
<span class="sourceLineNo">556</span><a id="line.556">      * @return the maximum run time in seconds for this object.</a>
<span class="sourceLineNo">557</span><a id="line.557">      */</a>
<span class="sourceLineNo">558</span><a id="line.558">     public int getMaxRunTimeSecs() {</a>
<span class="sourceLineNo">559</span><a id="line.559">         return maxRunTimeSecs;</a>
<span class="sourceLineNo">560</span><a id="line.560">     }</a>
<span class="sourceLineNo">561</span><a id="line.561"></a>
<span class="sourceLineNo">562</span><a id="line.562">     /**</a>
<span class="sourceLineNo">563</span><a id="line.563">      * Returns the output string if exec(String) was invoked.</a>
<span class="sourceLineNo">564</span><a id="line.564">      *</a>
<span class="sourceLineNo">565</span><a id="line.565">      * @return The output string if exec(String) was invoked.</a>
<span class="sourceLineNo">566</span><a id="line.566">      */</a>
<span class="sourceLineNo">567</span><a id="line.567">     public String getOutString() {</a>
<span class="sourceLineNo">568</span><a id="line.568">         return out;</a>
<span class="sourceLineNo">569</span><a id="line.569">     }</a>
<span class="sourceLineNo">570</span><a id="line.570"></a>
<span class="sourceLineNo">571</span><a id="line.571">     /**</a>
<span class="sourceLineNo">572</span><a id="line.572">      * This is for unit testing of the class.</a>
<span class="sourceLineNo">573</span><a id="line.573">      *</a>
<span class="sourceLineNo">574</span><a id="line.574">      * @param args an array of command-line arguments</a>
<span class="sourceLineNo">575</span><a id="line.575">      * @throws IOException thrown if a problem occurs</a>
<span class="sourceLineNo">576</span><a id="line.576">      **/</a>
<span class="sourceLineNo">577</span><a id="line.577">     public static void main(String[] args) throws IOException {</a>
<span class="sourceLineNo">578</span><a id="line.578"></a>
<span class="sourceLineNo">579</span><a id="line.579">         try {</a>
<span class="sourceLineNo">580</span><a id="line.580"></a>
<span class="sourceLineNo">581</span><a id="line.581">             ExecRunner er = new ExecRunner();</a>
<span class="sourceLineNo">582</span><a id="line.582"></a>
<span class="sourceLineNo">583</span><a id="line.583">             /////////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">584</span><a id="line.584">             // Linux: Test the exec operation with just STDOUT and STDERR</a>
<span class="sourceLineNo">585</span><a id="line.585">             //System.out.println("Testing ExecRunner with STDOUT and STDERR...");</a>
<span class="sourceLineNo">586</span><a id="line.586">             //er.exec("ls -l", System.out, System.err);</a>
<span class="sourceLineNo">587</span><a id="line.587">             //System.out.println("Complete");</a>
<span class="sourceLineNo">588</span><a id="line.588"></a>
<span class="sourceLineNo">589</span><a id="line.589">             /////////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">590</span><a id="line.590">             // Windows: Test the exec operation with just STDOUT and STDERR</a>
<span class="sourceLineNo">591</span><a id="line.591">             System.out.println("Testing ExecRunner with StringWriter...");</a>
<span class="sourceLineNo">592</span><a id="line.592"></a>
<span class="sourceLineNo">593</span><a id="line.593">             er = new ExecRunner();</a>
<span class="sourceLineNo">594</span><a id="line.594">             er.setMaxRunTimeSecs(1);</a>
<span class="sourceLineNo">595</span><a id="line.595">             er.exec("dir /s c:\\");</a>
<span class="sourceLineNo">596</span><a id="line.596">             //er.exec("ls -l");</a>
<span class="sourceLineNo">597</span><a id="line.597"></a>
<span class="sourceLineNo">598</span><a id="line.598">             System.out.println("&lt;STDOUT&gt;\n" + er.getOutString() + "&lt;/STDOUT&gt;");</a>
<span class="sourceLineNo">599</span><a id="line.599">             System.out.println("&lt;STDERR&gt;\n" + er.getErrString() + "&lt;/STDERR&gt;");</a>
<span class="sourceLineNo">600</span><a id="line.600">             System.out.println("Testing Done");</a>
<span class="sourceLineNo">601</span><a id="line.601"></a>
<span class="sourceLineNo">602</span><a id="line.602">             /////////////////////////////////////////////////////////////////////</a>
<span class="sourceLineNo">603</span><a id="line.603">             // Exit nicely</a>
<span class="sourceLineNo">604</span><a id="line.604">             System.exit(0);</a>
<span class="sourceLineNo">605</span><a id="line.605"></a>
<span class="sourceLineNo">606</span><a id="line.606">         }</a>
<span class="sourceLineNo">607</span><a id="line.607">         catch (Exception e) {</a>
<span class="sourceLineNo">608</span><a id="line.608"></a>
<span class="sourceLineNo">609</span><a id="line.609">             e.printStackTrace();</a>
<span class="sourceLineNo">610</span><a id="line.610">             System.exit(1);</a>
<span class="sourceLineNo">611</span><a id="line.611"></a>
<span class="sourceLineNo">612</span><a id="line.612">         }</a>
<span class="sourceLineNo">613</span><a id="line.613">     }</a>
<span class="sourceLineNo">614</span><a id="line.614"></a>
<span class="sourceLineNo">615</span><a id="line.615">     /**</a>
<span class="sourceLineNo">616</span><a id="line.616">      * We override the &lt;code&gt;readObject&lt;/code&gt; method here to prevent</a>
<span class="sourceLineNo">617</span><a id="line.617">      * deserialization of our class for security reasons.</a>
<span class="sourceLineNo">618</span><a id="line.618">      *</a>
<span class="sourceLineNo">619</span><a id="line.619">      * @param in java.io.ObjectInputStream</a>
<span class="sourceLineNo">620</span><a id="line.620">      * @throws IOException thrown if a problem occurs</a>
<span class="sourceLineNo">621</span><a id="line.621">      **/</a>
<span class="sourceLineNo">622</span><a id="line.622">     private final void readObject(ObjectInputStream in) throws IOException {</a>
<span class="sourceLineNo">623</span><a id="line.623"></a>
<span class="sourceLineNo">624</span><a id="line.624">         throw new IOException("Object cannot be deserialized");</a>
<span class="sourceLineNo">625</span><a id="line.625"></a>
<span class="sourceLineNo">626</span><a id="line.626">     }</a>
<span class="sourceLineNo">627</span><a id="line.627"></a>
<span class="sourceLineNo">628</span><a id="line.628">     /**</a>
<span class="sourceLineNo">629</span><a id="line.629">      * Sets the maximum run time in seconds.</a>
<span class="sourceLineNo">630</span><a id="line.630">      * If you do not want to limit the executable's run time, simply pass in</a>
<span class="sourceLineNo">631</span><a id="line.631">      * a 0 (which is also the default).</a>
<span class="sourceLineNo">632</span><a id="line.632">      *</a>
<span class="sourceLineNo">633</span><a id="line.633">      * @param max Maximim number of seconds to let program run</a>
<span class="sourceLineNo">634</span><a id="line.634">      */</a>
<span class="sourceLineNo">635</span><a id="line.635">     public void setMaxRunTimeSecs(int max) {</a>
<span class="sourceLineNo">636</span><a id="line.636"></a>
<span class="sourceLineNo">637</span><a id="line.637">         maxRunTimeSecs = max;</a>
<span class="sourceLineNo">638</span><a id="line.638"></a>
<span class="sourceLineNo">639</span><a id="line.639">     }</a>
<span class="sourceLineNo">640</span><a id="line.640"></a>
<span class="sourceLineNo">641</span><a id="line.641">     /**</a>
<span class="sourceLineNo">642</span><a id="line.642">      * We override the &lt;code&gt;writeObject&lt;/code&gt; method here to prevent</a>
<span class="sourceLineNo">643</span><a id="line.643">      * serialization of our class for security reasons.</a>
<span class="sourceLineNo">644</span><a id="line.644">      *</a>
<span class="sourceLineNo">645</span><a id="line.645">      * @param out java.io.ObjectOutputStream</a>
<span class="sourceLineNo">646</span><a id="line.646">      * @throws IOException thrown if a problem occurs</a>
<span class="sourceLineNo">647</span><a id="line.647">      **/</a>
<span class="sourceLineNo">648</span><a id="line.648">     private final void writeObject(ObjectOutputStream out) throws IOException {</a>
<span class="sourceLineNo">649</span><a id="line.649"></a>
<span class="sourceLineNo">650</span><a id="line.650">         throw new IOException("Object cannot be serialized");</a>
<span class="sourceLineNo">651</span><a id="line.651"></a>
<span class="sourceLineNo">652</span><a id="line.652">     }</a>
<span class="sourceLineNo">653</span><a id="line.653"></a>
<span class="sourceLineNo">654</span><a id="line.654"> }</a>
<span class="sourceLineNo">655</span><a id="line.655"></a>
<span class="sourceLineNo">656</span><a id="line.656">  /**</a>
<span class="sourceLineNo">657</span><a id="line.657">   * &lt;P&gt;Captures the output of an InputStream.&lt;/P&gt;</a>
<span class="sourceLineNo">658</span><a id="line.658">   *</a>
<span class="sourceLineNo">659</span><a id="line.659">   * With acknowledgements to Michael C. Daconta, author of "Java Pitfalls,</a>
<span class="sourceLineNo">660</span><a id="line.660">   * Time Saving Solutions, and Workarounds to Improve Programs." and his</a>
<span class="sourceLineNo">661</span><a id="line.661">   * article in JavaWorld "When Runtime.exec() Won't".</a>
<span class="sourceLineNo">662</span><a id="line.662">   *</a>
<span class="sourceLineNo">663</span><a id="line.663">   * See the ExecRunner class for a reference implementation.</a>
<span class="sourceLineNo">664</span><a id="line.664">   *</a>
<span class="sourceLineNo">665</span><a id="line.665">   * @author &lt;a href="mailto:smccrory@users.sourceforge.net"&gt;Scott McCrory&lt;/a&gt;.</a>
<span class="sourceLineNo">666</span><a id="line.666">   * @version CVS $Id$</a>
<span class="sourceLineNo">667</span><a id="line.667">   */</a>
<span class="sourceLineNo">668</span><a id="line.668">  class StreamGobbler extends Thread {</a>
<span class="sourceLineNo">669</span><a id="line.669"></a>
<span class="sourceLineNo">670</span><a id="line.670">      /** The input stream we're gobbling **/</a>
<span class="sourceLineNo">671</span><a id="line.671">      private InputStream in = null;</a>
<span class="sourceLineNo">672</span><a id="line.672"></a>
<span class="sourceLineNo">673</span><a id="line.673">      /** The printwriter we'll send the gobbled characters to if asked**/</a>
<span class="sourceLineNo">674</span><a id="line.674">      private PrintWriter pwOut = null;</a>
<span class="sourceLineNo">675</span><a id="line.675"></a>
<span class="sourceLineNo">676</span><a id="line.676">      /** Our flag to allow us to safely terminate the monitoring thread **/</a>
<span class="sourceLineNo">677</span><a id="line.677">      private boolean quit = false;</a>
<span class="sourceLineNo">678</span><a id="line.678"></a>
<span class="sourceLineNo">679</span><a id="line.679"></a>
<span class="sourceLineNo">680</span><a id="line.680">      /**</a>
<span class="sourceLineNo">681</span><a id="line.681">       * A simpler constructor for StreamGobbler - defaults to stdout.</a>
<span class="sourceLineNo">682</span><a id="line.682">       *</a>
<span class="sourceLineNo">683</span><a id="line.683">       * @param in InputStream</a>
<span class="sourceLineNo">684</span><a id="line.684">       */</a>
<span class="sourceLineNo">685</span><a id="line.685">      public StreamGobbler(InputStream in) {</a>
<span class="sourceLineNo">686</span><a id="line.686"></a>
<span class="sourceLineNo">687</span><a id="line.687">          this.in = in;</a>
<span class="sourceLineNo">688</span><a id="line.688">          this.pwOut = new PrintWriter(System.out, true);</a>
<span class="sourceLineNo">689</span><a id="line.689"></a>
<span class="sourceLineNo">690</span><a id="line.690">      }</a>
<span class="sourceLineNo">691</span><a id="line.691"></a>
<span class="sourceLineNo">692</span><a id="line.692">      /**</a>
<span class="sourceLineNo">693</span><a id="line.693">       * A more explicit constructor for StreamGobbler where you can tell</a>
<span class="sourceLineNo">694</span><a id="line.694">       * it exactly where to relay the output to.</a>
<span class="sourceLineNo">695</span><a id="line.695">       * Creation date: (9/23/2001 8:48:01 PM)</a>
<span class="sourceLineNo">696</span><a id="line.696">       *</a>
<span class="sourceLineNo">697</span><a id="line.697">       * @param in InputStream</a>
<span class="sourceLineNo">698</span><a id="line.698">       * @param out OutputStream</a>
<span class="sourceLineNo">699</span><a id="line.699">       */</a>
<span class="sourceLineNo">700</span><a id="line.700">      public StreamGobbler(InputStream in, OutputStream out) {</a>
<span class="sourceLineNo">701</span><a id="line.701"></a>
<span class="sourceLineNo">702</span><a id="line.702">          this.in = in;</a>
<span class="sourceLineNo">703</span><a id="line.703">          this.pwOut = new PrintWriter(out, true);</a>
<span class="sourceLineNo">704</span><a id="line.704"></a>
<span class="sourceLineNo">705</span><a id="line.705">      }</a>
<span class="sourceLineNo">706</span><a id="line.706"></a>
<span class="sourceLineNo">707</span><a id="line.707">      /**</a>
<span class="sourceLineNo">708</span><a id="line.708">       * A more explicit constructor for StreamGobbler where you can tell</a>
<span class="sourceLineNo">709</span><a id="line.709">       * it exactly where to relay the output to.</a>
<span class="sourceLineNo">710</span><a id="line.710">       * Creation date: (9/23/2001 8:48:01 PM)</a>
<span class="sourceLineNo">711</span><a id="line.711">       *</a>
<span class="sourceLineNo">712</span><a id="line.712">       * @param in InputStream</a>
<span class="sourceLineNo">713</span><a id="line.713">       * @param pwOut PrintWriter</a>
<span class="sourceLineNo">714</span><a id="line.714">       */</a>
<span class="sourceLineNo">715</span><a id="line.715">      public StreamGobbler(InputStream in, PrintWriter pwOut) {</a>
<span class="sourceLineNo">716</span><a id="line.716"></a>
<span class="sourceLineNo">717</span><a id="line.717">          this.in = in;</a>
<span class="sourceLineNo">718</span><a id="line.718">          this.pwOut = pwOut;</a>
<span class="sourceLineNo">719</span><a id="line.719"></a>
<span class="sourceLineNo">720</span><a id="line.720">      }</a>
<span class="sourceLineNo">721</span><a id="line.721"></a>
<span class="sourceLineNo">722</span><a id="line.722">     /**</a>
<span class="sourceLineNo">723</span><a id="line.723">      * We override the &lt;code&gt;clone&lt;/code&gt; method here to prevent cloning of our class.</a>
<span class="sourceLineNo">724</span><a id="line.724">      *</a>
<span class="sourceLineNo">725</span><a id="line.725">      * @throws CloneNotSupportedException To indicate cloning is not allowed</a>
<span class="sourceLineNo">726</span><a id="line.726">      * @return Nothing ever really returned since we throw a CloneNotSupportedException</a>
<span class="sourceLineNo">727</span><a id="line.727">      **/</a>
<span class="sourceLineNo">728</span><a id="line.728">     public final Object clone() throws CloneNotSupportedException {</a>
<span class="sourceLineNo">729</span><a id="line.729"></a>
<span class="sourceLineNo">730</span><a id="line.730">         throw new CloneNotSupportedException();</a>
<span class="sourceLineNo">731</span><a id="line.731"></a>
<span class="sourceLineNo">732</span><a id="line.732">     }</a>
<span class="sourceLineNo">733</span><a id="line.733"></a>
<span class="sourceLineNo">734</span><a id="line.734">     /**</a>
<span class="sourceLineNo">735</span><a id="line.735">      * Tells the StreamGobbler to quit it's operation.</a>
<span class="sourceLineNo">736</span><a id="line.736">      * This is safer than using stop() since it uses a semophore checked in the</a>
<span class="sourceLineNo">737</span><a id="line.737">      * main wait loop instead of possibly forcing semaphores to untimely unlock.</a>
<span class="sourceLineNo">738</span><a id="line.738">      */</a>
<span class="sourceLineNo">739</span><a id="line.739">     public void quit() {</a>
<span class="sourceLineNo">740</span><a id="line.740"></a>
<span class="sourceLineNo">741</span><a id="line.741">         quit = true;</a>
<span class="sourceLineNo">742</span><a id="line.742"></a>
<span class="sourceLineNo">743</span><a id="line.743">     }</a>
<span class="sourceLineNo">744</span><a id="line.744"></a>
<span class="sourceLineNo">745</span><a id="line.745">     /**</a>
<span class="sourceLineNo">746</span><a id="line.746">      * We override the &lt;code&gt;readObject&lt;/code&gt; method here to prevent</a>
<span class="sourceLineNo">747</span><a id="line.747">      * deserialization of our class for security reasons.</a>
<span class="sourceLineNo">748</span><a id="line.748">      *</a>
<span class="sourceLineNo">749</span><a id="line.749">      * @param in java.io.ObjectInputStream</a>
<span class="sourceLineNo">750</span><a id="line.750">      * @throws IOException thrown if a problem occurs</a>
<span class="sourceLineNo">751</span><a id="line.751">      **/</a>
<span class="sourceLineNo">752</span><a id="line.752">     private final void readObject(ObjectInputStream in) throws IOException {</a>
<span class="sourceLineNo">753</span><a id="line.753"></a>
<span class="sourceLineNo">754</span><a id="line.754">         throw new IOException("Object cannot be deserialized");</a>
<span class="sourceLineNo">755</span><a id="line.755"></a>
<span class="sourceLineNo">756</span><a id="line.756">     }</a>
<span class="sourceLineNo">757</span><a id="line.757"></a>
<span class="sourceLineNo">758</span><a id="line.758">     /**</a>
<span class="sourceLineNo">759</span><a id="line.759">      * Gobbles up all the stuff coming from the InputStream and</a>
<span class="sourceLineNo">760</span><a id="line.760">      * sends it to the OutputStream specified during object construction.</a>
<span class="sourceLineNo">761</span><a id="line.761">      **/</a>
<span class="sourceLineNo">762</span><a id="line.762">     public void run() {</a>
<span class="sourceLineNo">763</span><a id="line.763"></a>
<span class="sourceLineNo">764</span><a id="line.764">         try {</a>
<span class="sourceLineNo">765</span><a id="line.765">             // Set up the input stream</a>
<span class="sourceLineNo">766</span><a id="line.766">             BufferedReader br = new BufferedReader(new InputStreamReader(in));</a>
<span class="sourceLineNo">767</span><a id="line.767"></a>
<span class="sourceLineNo">768</span><a id="line.768">             // Initialize the temporary results containers</a>
<span class="sourceLineNo">769</span><a id="line.769">             String line = null;</a>
<span class="sourceLineNo">770</span><a id="line.770"></a>
<span class="sourceLineNo">771</span><a id="line.771">             // Main processing loop which captures the output</a>
<span class="sourceLineNo">772</span><a id="line.772">             while ((line = br.readLine()) != null) {</a>
<span class="sourceLineNo">773</span><a id="line.773">                     if (quit) </a>
<span class="sourceLineNo">774</span><a id="line.774">                       break;</a>
<span class="sourceLineNo">775</span><a id="line.775">                   else </a>
<span class="sourceLineNo">776</span><a id="line.776">                       pwOut.println(line);</a>
<span class="sourceLineNo">777</span><a id="line.777">             }</a>
<span class="sourceLineNo">778</span><a id="line.778">       this.in.close();</a>
<span class="sourceLineNo">779</span><a id="line.779">         }</a>
<span class="sourceLineNo">780</span><a id="line.780">         catch (Exception e) {</a>
<span class="sourceLineNo">781</span><a id="line.781">             e.printStackTrace();</a>
<span class="sourceLineNo">782</span><a id="line.782">         }</a>
<span class="sourceLineNo">783</span><a id="line.783"></a>
<span class="sourceLineNo">784</span><a id="line.784">     }</a>
<span class="sourceLineNo">785</span><a id="line.785"></a>
<span class="sourceLineNo">786</span><a id="line.786">     /**</a>
<span class="sourceLineNo">787</span><a id="line.787">      * We override the &lt;code&gt;writeObject&lt;/code&gt; method here to prevent</a>
<span class="sourceLineNo">788</span><a id="line.788">      * serialization of our class for security reasons.</a>
<span class="sourceLineNo">789</span><a id="line.789">      *</a>
<span class="sourceLineNo">790</span><a id="line.790">      * @param out java.io.ObjectOutputStream</a>
<span class="sourceLineNo">791</span><a id="line.791">      * @throws IOException thrown if a problem occurs</a>
<span class="sourceLineNo">792</span><a id="line.792">      **/</a>
<span class="sourceLineNo">793</span><a id="line.793">     private final void writeObject(ObjectOutputStream out) throws IOException {</a>
<span class="sourceLineNo">794</span><a id="line.794"></a>
<span class="sourceLineNo">795</span><a id="line.795">         throw new IOException("Object cannot be serialized");</a>
<span class="sourceLineNo">796</span><a id="line.796"></a>
<span class="sourceLineNo">797</span><a id="line.797">     }</a>
<span class="sourceLineNo">798</span><a id="line.798"></a>
<span class="sourceLineNo">799</span><a id="line.799"> }</a>




























































</pre>
</div>
</main>
</body>
</html>
